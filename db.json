{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"source/favicon.ico","path":"favicon.ico","modified":0,"renderable":0},{"_id":"themes/landscape/source/css/css.css","path":"css/css.css","modified":0,"renderable":1},{"_id":"themes/landscape/source/css/style.styl","path":"css/style.styl","modified":0,"renderable":1},{"_id":"themes/landscape/source/js/script.js","path":"js/script.js","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/blank.gif","path":"fancybox/blank.gif","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/fancybox_loading@2x.gif","path":"fancybox/fancybox_loading@2x.gif","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/fancybox_loading.gif","path":"fancybox/fancybox_loading.gif","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/fancybox_sprite.png","path":"fancybox/fancybox_sprite.png","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/fancybox_overlay.png","path":"fancybox/fancybox_overlay.png","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/fancybox_sprite@2x.png","path":"fancybox/fancybox_sprite@2x.png","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/jquery.fancybox.css","path":"fancybox/jquery.fancybox.css","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/jquery.fancybox.js","path":"fancybox/jquery.fancybox.js","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/jquery.fancybox.pack.js","path":"fancybox/jquery.fancybox.pack.js","modified":0,"renderable":1},{"_id":"themes/landscape/source/js/jquery.min.js","path":"js/jquery.min.js","modified":0,"renderable":1},{"_id":"themes/landscape/source/css/fonts/FontAwesome.otf","path":"css/fonts/FontAwesome.otf","modified":0,"renderable":1},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.eot","path":"css/fonts/fontawesome-webfont.eot","modified":0,"renderable":1},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.woff","path":"css/fonts/fontawesome-webfont.woff","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/helpers/fancybox_buttons.png","path":"fancybox/helpers/fancybox_buttons.png","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-buttons.css","path":"fancybox/helpers/jquery.fancybox-buttons.css","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-buttons.js","path":"fancybox/helpers/jquery.fancybox-buttons.js","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-media.js","path":"fancybox/helpers/jquery.fancybox-media.js","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-thumbs.css","path":"fancybox/helpers/jquery.fancybox-thumbs.css","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-thumbs.js","path":"fancybox/helpers/jquery.fancybox-thumbs.js","modified":0,"renderable":1},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.ttf","path":"css/fonts/fontawesome-webfont.ttf","modified":0,"renderable":1},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.svg","path":"css/fonts/fontawesome-webfont.svg","modified":0,"renderable":1},{"_id":"themes/landscape/source/css/images/banner.jpg","path":"css/images/banner.jpg","modified":0,"renderable":1}],"Cache":[{"_id":"themes/landscape/.npmignore","hash":"58d26d4b5f2f94c2d02a4e4a448088e4a2527c77","modified":1462880652854},{"_id":"themes/landscape/LICENSE","hash":"c480fce396b23997ee23cc535518ffaaf7f458f8","modified":1462880652854},{"_id":"themes/landscape/Gruntfile.js","hash":"71adaeaac1f3cc56e36c49d549b8d8a72235c9b9","modified":1462880652854},{"_id":"themes/landscape/README.md","hash":"c7e83cfe8f2c724fc9cac32bd71bb5faf9ceeddb","modified":1462880652854},{"_id":"themes/landscape/_config.yml","hash":"ef739d58d14e2c221d32860e54a4f326193ace5e","modified":1462894072631},{"_id":"themes/landscape/package.json","hash":"85358dc34311c6662e841584e206a4679183943f","modified":1462880652856},{"_id":"source/favicon.ico","hash":"f50f1228739e790380a195144d715886ea1961e0","modified":1337753982000},{"_id":"source/_posts/JavaScript面向对象编程.md","hash":"ffd6f24a99d76b8c6d59de7ca7f1267e90495cfa","modified":1462967643518},{"_id":"source/_posts/Hadoop集群完全分布式部署.md","hash":"ca0992a7749f2da863cbbe4aa0a38aa12c8f32ec","modified":1462974224383},{"_id":"source/_posts/Linux常见问题解决方法.md","hash":"73c03e08109ffb3a1245a4387c31c47e86ce8a8b","modified":1462967643519},{"_id":"source/_posts/Java设计模式之观察者模式.md","hash":"07de8801d29fed50e52feca0865385222cf78a17","modified":1462970450499},{"_id":"source/_posts/System.setOut.md","hash":"3166c5c55586aeb268d1de251f83a45e4f72174a","modified":1462967643519},{"_id":"source/_posts/博客搭建.md","hash":"d3d5b75490c360e15a84a22bbe1b63fad9ba2444","modified":1462967643520},{"_id":"themes/landscape/languages/default.yml","hash":"3083f319b352d21d80fc5e20113ddf27889c9d11","modified":1462880652873},{"_id":"themes/landscape/languages/no.yml","hash":"965a171e70347215ec726952e63f5b47930931ef","modified":1462880652875},{"_id":"themes/landscape/languages/nl.yml","hash":"12ed59faba1fc4e8cdd1d42ab55ef518dde8039c","modified":1462880652875},{"_id":"themes/landscape/languages/ru.yml","hash":"4fda301bbd8b39f2c714e2c934eccc4b27c0a2b0","modified":1462880652875},{"_id":"themes/landscape/languages/zh-CN.yml","hash":"1ef52d096f074d88399ef1fa80d2f78a81d4b83c","modified":1462894393323},{"_id":"themes/landscape/languages/zh-TW.yml","hash":"53ce3000c5f767759c7d2c4efcaa9049788599c3","modified":1462880652876},{"_id":"themes/landscape/layout/archive.ejs","hash":"2703b07cc8ac64ae46d1d263f4653013c7e1666b","modified":1462880652876},{"_id":"themes/landscape/layout/index.ejs","hash":"aa1b4456907bdb43e629be3931547e2d29ac58c8","modified":1462880652876},{"_id":"themes/landscape/layout/category.ejs","hash":"765426a9c8236828dc34759e604cc2c52292835a","modified":1462880652876},{"_id":"themes/landscape/layout/layout.ejs","hash":"f155824ca6130080bb057fa3e868a743c69c4cf5","modified":1462880652876},{"_id":"themes/landscape/layout/page.ejs","hash":"7d80e4e36b14d30a7cd2ac1f61376d9ebf264e8b","modified":1462880652877},{"_id":"themes/landscape/layout/post.ejs","hash":"7d80e4e36b14d30a7cd2ac1f61376d9ebf264e8b","modified":1462880652877},{"_id":"themes/landscape/layout/tag.ejs","hash":"eaa7b4ccb2ca7befb90142e4e68995fb1ea68b2e","modified":1462880652878},{"_id":"themes/landscape/scripts/fancybox.js","hash":"aa411cd072399df1ddc8e2181a3204678a5177d9","modified":1462880652875},{"_id":"source/_posts/Hadoop集群完全分布式部署/003vMReezy6P1KHLwtFe7&690.png","hash":"7043bbc267e660a3a615e5818e92c357f1443521","modified":1462972857742},{"_id":"source/_posts/Hadoop集群完全分布式部署/003vMReezy6P1KnAQkx19&690.png","hash":"a735aa956f5d380c96e4175097904fc93a6fc91d","modified":1462972598533},{"_id":"source/_posts/Hadoop集群完全分布式部署/003vMReezy6P1MG9JTO50&690.png","hash":"521acf61bbe9221bb399203d90d3679362fd7344","modified":1462971310892},{"_id":"source/_posts/Hadoop集群完全分布式部署/003vMReezy6P1MlAy3H5d&690.jpg","hash":"be5eb12da6ea72e0cf7d88228c74a0879ebea51d","modified":1462974125225},{"_id":"source/_posts/Hadoop集群完全分布式部署/003vMReezy6P1Mzjamje7&690.jpg","hash":"a75887f218506a0689004b4a5b46ac528e287d57","modified":1462974157741},{"_id":"source/_posts/Java设计模式之观察者模式/003vMReezy6OWsC8Oogc8&690.jpg","hash":"3b2dab83187ba0e1975c7545c305ddf3f2bdd26b","modified":1462969737268},{"_id":"source/_posts/Java设计模式之观察者模式/class.jpg","hash":"79d8669aca398f54e6e49d3c0ee39c83903876f3","modified":1462969264623},{"_id":"themes/landscape/layout/_partial/after-footer.ejs","hash":"63bc4f8802967697a9a1096937384bafff0ecd62","modified":1462967643520},{"_id":"themes/landscape/layout/_partial/archive-post.ejs","hash":"c7a71425a946d05414c069ec91811b5c09a92c47","modified":1462880652906},{"_id":"themes/landscape/layout/_partial/archive.ejs","hash":"133e825b57ffb6ed1c5aa9602c7feacd38705539","modified":1463150609154},{"_id":"themes/landscape/layout/_partial/article.ejs","hash":"163544fba4d089b33254f36d7619431699ec01c9","modified":1462967643521},{"_id":"themes/landscape/layout/_partial/footer.ejs","hash":"93518893cf91287e797ebac543c560e2a63b8d0e","modified":1462880652906},{"_id":"themes/landscape/layout/_partial/google-analytics.ejs","hash":"f921e7f9223d7c95165e0f835f353b2938e40c45","modified":1462880652906},{"_id":"themes/landscape/layout/_partial/head.ejs","hash":"482cf2ab89581e8c08428862763b8ce034bf528f","modified":1462891266693},{"_id":"themes/landscape/layout/_partial/header.ejs","hash":"c21ca56f419d01a9f49c27b6be9f4a98402b2aa3","modified":1462880652906},{"_id":"themes/landscape/layout/_partial/mobile-nav.ejs","hash":"e952a532dfc583930a666b9d4479c32d4a84b44e","modified":1462880652907},{"_id":"themes/landscape/layout/_partial/sidebar.ejs","hash":"930da35cc2d447a92e5ee8f835735e6fd2232469","modified":1462880652907},{"_id":"themes/landscape/layout/_widget/archive.ejs","hash":"beb4a86fcc82a9bdda9289b59db5a1988918bec3","modified":1462880652905},{"_id":"themes/landscape/layout/_widget/category.ejs","hash":"dd1e5af3c6af3f5d6c85dfd5ca1766faed6a0b05","modified":1462880652908},{"_id":"themes/landscape/layout/_widget/recent_posts.ejs","hash":"0d4f064733f8b9e45c0ce131fe4a689d570c883a","modified":1462880652908},{"_id":"themes/landscape/layout/_widget/tag.ejs","hash":"2de380865df9ab5f577f7d3bcadf44261eb5faae","modified":1462880652908},{"_id":"themes/landscape/layout/_widget/tagcloud.ejs","hash":"b4a2079101643f63993dcdb32925c9b071763b46","modified":1462880652908},{"_id":"themes/landscape/source/css/_extend.styl","hash":"222fbe6d222531d61c1ef0f868c90f747b1c2ced","modified":1462880652918},{"_id":"themes/landscape/source/css/_variables.styl","hash":"5e37a6571caf87149af83ac1cc0cdef99f117350","modified":1462880652918},{"_id":"themes/landscape/source/css/css.css","hash":"9c4c9aae05ffd5a38082080efb3ddefbd8772cb2","modified":1462891041861},{"_id":"themes/landscape/source/css/style.styl","hash":"a70d9c44dac348d742702f6ba87e5bb3084d65db","modified":1462880652919},{"_id":"themes/landscape/source/js/script.js","hash":"2876e0b19ce557fca38d7c6f49ca55922ab666a1","modified":1462880652926},{"_id":"themes/landscape/source/fancybox/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1462880652926},{"_id":"themes/landscape/source/fancybox/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1462880652927},{"_id":"themes/landscape/source/fancybox/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1462880652927},{"_id":"themes/landscape/source/fancybox/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1462880652927},{"_id":"themes/landscape/source/fancybox/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1462880652927},{"_id":"themes/landscape/source/fancybox/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1462880652928},{"_id":"themes/landscape/source/fancybox/jquery.fancybox.css","hash":"aaa582fb9eb4b7092dc69fcb2d5b1c20cca58ab6","modified":1462880652929},{"_id":"themes/landscape/source/fancybox/jquery.fancybox.js","hash":"d08b03a42d5c4ba456ef8ba33116fdbb7a9cabed","modified":1462880652929},{"_id":"themes/landscape/source/fancybox/jquery.fancybox.pack.js","hash":"9e0d51ca1dbe66f6c0c7aefd552dc8122e694a6e","modified":1462880652929},{"_id":"source/_posts/Hadoop集群完全分布式部署/003vMReezy6P1LyH3gqae&690.jpg","hash":"ad604ae5be66bdcc06aaa1bf626f4303a05ac558","modified":1462974005188},{"_id":"source/_posts/Hadoop集群完全分布式部署/003vMReezy6P1O1zJBg32&690.jpg","hash":"a3a2c32631f0c7ab624041e591f17d760f910bcb","modified":1462974183242},{"_id":"source/_posts/Java设计模式之观察者模式/003vMReezy6OWsKgs3pa3&690.jpg","hash":"6616e5940a254b19bbe47b2967188cbf0ea6172e","modified":1462969606358},{"_id":"themes/landscape/source/js/jquery.min.js","hash":"a6eedf84389e1bc9f757bc2d19538f8c8d1cae9d","modified":1462891162286},{"_id":"themes/landscape/layout/_partial/post/category.ejs","hash":"c6bcd0e04271ffca81da25bcff5adf3d46f02fc0","modified":1462880652934},{"_id":"themes/landscape/layout/_partial/post/date.ejs","hash":"6197802873157656e3077c5099a7dda3d3b01c29","modified":1462880652938},{"_id":"themes/landscape/layout/_partial/post/gallery.ejs","hash":"3d9d81a3c693ff2378ef06ddb6810254e509de5b","modified":1462880652938},{"_id":"themes/landscape/layout/_partial/post/nav.ejs","hash":"16a904de7bceccbb36b4267565f2215704db2880","modified":1462880652938},{"_id":"themes/landscape/layout/_partial/post/tag.ejs","hash":"2fcb0bf9c8847a644167a27824c9bb19ac74dd14","modified":1462880652938},{"_id":"themes/landscape/layout/_partial/post/title.ejs","hash":"2f275739b6f1193c123646a5a31f37d48644c667","modified":1462880652938},{"_id":"themes/landscape/source/css/_partial/archive.styl","hash":"db15f5677dc68f1730e82190bab69c24611ca292","modified":1462880652942},{"_id":"themes/landscape/source/css/_partial/article.styl","hash":"77d2a41321a2734a8007548e582184fad4ff247e","modified":1462975166201},{"_id":"themes/landscape/source/css/_partial/comment.styl","hash":"79d280d8d203abb3bd933ca9b8e38c78ec684987","modified":1462880652942},{"_id":"themes/landscape/source/css/_partial/footer.styl","hash":"e35a060b8512031048919709a8e7b1ec0e40bc1b","modified":1462880652944},{"_id":"themes/landscape/source/css/_partial/header.styl","hash":"85ab11e082f4dd86dde72bed653d57ec5381f30c","modified":1462880652944},{"_id":"themes/landscape/source/css/_partial/highlight.styl","hash":"36eefe6332b86b66023a9884b754d305235846b4","modified":1462880652944},{"_id":"themes/landscape/source/css/_partial/mobile.styl","hash":"a399cf9e1e1cec3e4269066e2948d7ae5854d745","modified":1462880652944},{"_id":"themes/landscape/source/css/_partial/sidebar-aside.styl","hash":"890349df5145abf46ce7712010c89237900b3713","modified":1462880652944},{"_id":"themes/landscape/source/css/_partial/sidebar-bottom.styl","hash":"8fd4f30d319542babfd31f087ddbac550f000a8a","modified":1462880652944},{"_id":"themes/landscape/source/css/_partial/sidebar.styl","hash":"404ec059dc674a48b9ab89cd83f258dec4dcb24d","modified":1462880652944},{"_id":"themes/landscape/source/css/fonts/FontAwesome.otf","hash":"b5b4f9be85f91f10799e87a083da1d050f842734","modified":1462880652946},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.eot","hash":"7619748fe34c64fb157a57f6d4ef3678f63a8f5e","modified":1462880652945},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.woff","hash":"04c3bf56d87a0828935bd6b4aee859995f321693","modified":1462880652946},{"_id":"themes/landscape/source/css/_util/grid.styl","hash":"0bf55ee5d09f193e249083602ac5fcdb1e571aed","modified":1462880652942},{"_id":"themes/landscape/source/css/_util/mixin.styl","hash":"44f32767d9fd3c1c08a60d91f181ee53c8f0dbb3","modified":1462880652943},{"_id":"themes/landscape/source/fancybox/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1462880652948},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-buttons.css","hash":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1462880652947},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-buttons.js","hash":"dc3645529a4bf72983a39fa34c1eb9146e082019","modified":1462880652948},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-media.js","hash":"294420f9ff20f4e3584d212b0c262a00a96ecdb3","modified":1462880652948},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-thumbs.css","hash":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1462880652948},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-thumbs.js","hash":"47da1ae5401c24b5c17cc18e2730780f5c1a7a0c","modified":1462880652948},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.ttf","hash":"7f09c97f333917034ad08fa7295e916c9f72fd3f","modified":1462880652948},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.svg","hash":"46fcc0194d75a0ddac0a038aee41b23456784814","modified":1462880652948},{"_id":"themes/landscape/source/css/images/banner.jpg","hash":"f44aa591089fcb3ec79770a1e102fd3289a7c6a6","modified":1462880652948},{"_id":"source/_posts/Nginx+Tomcat+Memcached集群.md","hash":"3fdc845c9675b25482975f7ad458b36b64cf103b","modified":1463148257986},{"_id":"source/_posts/Nginx+Tomcat集群.md","hash":"1142ca037fe728fcc241063958443a1322422e42","modified":1463147079914},{"_id":"source/_posts/Oracle常用脚本.md","hash":"96ef1a5496e320d3195b11b3f33569a31886daea","modified":1463151171913},{"_id":"source/_posts/浅谈BSF.md","hash":"21435c0cbb9ebd53ef2fdb25a3c8082e4155458f","modified":1463150146795},{"_id":"source/_posts/解决问题心得.md","hash":"afc366e81ab7f56d36050871973df570693be9e3","modified":1463148575520},{"_id":"source/_posts/财务管理系统项目技术经验总结.md","hash":"a7eeb0664f1ef80a819008aca1ea0fdb57628065","modified":1463149614420},{"_id":"source/_posts/Nginx+Tomcat集群/003vMReezy6OUXDo7kt61&690.jpg","hash":"b7a15e619f8e962958b99ebd38555b84b82ee81e","modified":1463146694171}],"Category":[{"name":"JavaScript","_id":"cio5q2lig00027oyb7hqytk4c"},{"name":"Hadoop","_id":"cio5q2liv00067oyboky4b2rk"},{"name":"Linux","_id":"cio5q2liv00097oyb09lmhzyj"},{"name":"Java","_id":"cio5q2liv000b7oyb0bqqc5t2"},{"name":"Tomcat","_id":"cio5uhgmn0002o0yba26ei45b"},{"name":"Oracle","_id":"cio5uhgn30006o0ybel9wspvp"},{"name":"BSF","_id":"cio5uhgn3000bo0ybv6oy15t6"},{"name":"心得体会","_id":"cio5uhgnj000do0yb17ghm3b0"}],"Data":[],"Page":[],"Post":[{"title":"JavaScript面向对象编程","date":"2016-05-11T03:05:20.000Z","comments":1,"toc":true,"_content":"\n## this\njavascript中的this和java一样都是表示当前对象，但需要注意的是同一个函数调用的方式不一样this指向的对象也不一样如下：\n\n```javascript\nfunction Test(){\n  alert(this);\n}\n//此时的this，是window弹出[object Window]\nTest();\n//此时的this，是当前对象的的object 弹出[object Object]\nvar t = new Test();\n```\n<!-- more -->\n会出现前后不一样的原因其实很简单，因为我们直接在调用Test函数浏览器会把这个函数当成window中的一个函数，此时的this当然指向的是window。在后面我们通过new 实例化了Test此时浏览器会吧Test当做成了一个对象此时的this肯定是指向当前对象。\n\n## Prototype\njavascript规定，每一个构造函数都有一个prototype属性，指向另一个对象。这个对象的所有属性和方法，都会被构造函数的实例继承。\n这意味着。我们可以把那些不变的属性和方法，直接定义在prototype对象上。这样带来的好处就是再实例多一个对象的时候减少了内存开销，因为多个对象指向的是同一个内存地址，提高了允许的效率。类似于java中的静态方法（被static修饰的变量和方法）。\n\n## 对于对象常用的操作\n\n### constructor\n每一个对象都会自动包含一个constructor属性，指向他们的构造函数。obj.constructor == Object\n### instanceof\n用于验证原型对象与实例对象之间的关系 obj  instanceof Object\n\n### isPrototypeOf \n判断某个prototype对象和某个实例之间的关系 Object.prototype.isPrototypeOf(obj)\n\n### hasOwnProperty\n用于判断某一个属性到底是本地属性，还是继承自prototype对象的属性  obj.hasOwnProerty(\"name\")\n\n\n ### in\n某个实例是否含有某个属性，不管是不是本地属性。 “name” in Obj\nin运算符还可以用来遍历某个对象的所有属性\n```javascript\nfor(var prop in cat1) {\n  alert(\"cat1[\"+prop+\"]=\"+cat1[prop]); \n}\n```\n\n","source":"_posts/JavaScript面向对象编程.md","raw":"---\ntitle: JavaScript面向对象编程\ndate: 2016-05-11 11:05:20\ncomments: true \ncategories: JavaScript\ntoc: true\n---\n\n## this\njavascript中的this和java一样都是表示当前对象，但需要注意的是同一个函数调用的方式不一样this指向的对象也不一样如下：\n\n```javascript\nfunction Test(){\n  alert(this);\n}\n//此时的this，是window弹出[object Window]\nTest();\n//此时的this，是当前对象的的object 弹出[object Object]\nvar t = new Test();\n```\n<!-- more -->\n会出现前后不一样的原因其实很简单，因为我们直接在调用Test函数浏览器会把这个函数当成window中的一个函数，此时的this当然指向的是window。在后面我们通过new 实例化了Test此时浏览器会吧Test当做成了一个对象此时的this肯定是指向当前对象。\n\n## Prototype\njavascript规定，每一个构造函数都有一个prototype属性，指向另一个对象。这个对象的所有属性和方法，都会被构造函数的实例继承。\n这意味着。我们可以把那些不变的属性和方法，直接定义在prototype对象上。这样带来的好处就是再实例多一个对象的时候减少了内存开销，因为多个对象指向的是同一个内存地址，提高了允许的效率。类似于java中的静态方法（被static修饰的变量和方法）。\n\n## 对于对象常用的操作\n\n### constructor\n每一个对象都会自动包含一个constructor属性，指向他们的构造函数。obj.constructor == Object\n### instanceof\n用于验证原型对象与实例对象之间的关系 obj  instanceof Object\n\n### isPrototypeOf \n判断某个prototype对象和某个实例之间的关系 Object.prototype.isPrototypeOf(obj)\n\n### hasOwnProperty\n用于判断某一个属性到底是本地属性，还是继承自prototype对象的属性  obj.hasOwnProerty(\"name\")\n\n\n ### in\n某个实例是否含有某个属性，不管是不是本地属性。 “name” in Obj\nin运算符还可以用来遍历某个对象的所有属性\n```javascript\nfor(var prop in cat1) {\n  alert(\"cat1[\"+prop+\"]=\"+cat1[prop]); \n}\n```\n\n","slug":"JavaScript面向对象编程","published":1,"updated":"2016-05-11T11:54:03.518Z","layout":"post","photos":[],"link":"","_id":"cio5q2lig00007oybozbqg9eo","content":"<h2 id=\"this\"><a href=\"#this\" class=\"headerlink\" title=\"this\"></a>this</h2><p>javascript中的this和java一样都是表示当前对象，但需要注意的是同一个函数调用的方式不一样this指向的对象也不一样如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Test</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">  alert(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//此时的this，是window弹出[object Window]</span></span><br><span class=\"line\">Test();</span><br><span class=\"line\"><span class=\"comment\">//此时的this，是当前对象的的object 弹出[object Object]</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> t = <span class=\"keyword\">new</span> Test();</span><br></pre></td></tr></table></figure>\n<a id=\"more\"></a>\n<p>会出现前后不一样的原因其实很简单，因为我们直接在调用Test函数浏览器会把这个函数当成window中的一个函数，此时的this当然指向的是window。在后面我们通过new 实例化了Test此时浏览器会吧Test当做成了一个对象此时的this肯定是指向当前对象。</p>\n<h2 id=\"Prototype\"><a href=\"#Prototype\" class=\"headerlink\" title=\"Prototype\"></a>Prototype</h2><p>javascript规定，每一个构造函数都有一个prototype属性，指向另一个对象。这个对象的所有属性和方法，都会被构造函数的实例继承。<br>这意味着。我们可以把那些不变的属性和方法，直接定义在prototype对象上。这样带来的好处就是再实例多一个对象的时候减少了内存开销，因为多个对象指向的是同一个内存地址，提高了允许的效率。类似于java中的静态方法（被static修饰的变量和方法）。</p>\n<h2 id=\"对于对象常用的操作\"><a href=\"#对于对象常用的操作\" class=\"headerlink\" title=\"对于对象常用的操作\"></a>对于对象常用的操作</h2><h3 id=\"constructor-NaN\"><a href=\"#constructor-NaN\" class=\"headerlink\" title=\"constructor\"></a>constructor</h3><p>每一个对象都会自动包含一个constructor属性，指向他们的构造函数。obj.constructor == Object</p>\n<h3 id=\"instanceof\"><a href=\"#instanceof\" class=\"headerlink\" title=\"instanceof\"></a>instanceof</h3><p>用于验证原型对象与实例对象之间的关系 obj  instanceof Object</p>\n<h3 id=\"isPrototypeOf-NaN\"><a href=\"#isPrototypeOf-NaN\" class=\"headerlink\" title=\"isPrototypeOf\"></a>isPrototypeOf</h3><p>判断某个prototype对象和某个实例之间的关系 Object.prototype.isPrototypeOf(obj)</p>\n<h3 id=\"hasOwnProperty-NaN\"><a href=\"#hasOwnProperty-NaN\" class=\"headerlink\" title=\"hasOwnProperty\"></a>hasOwnProperty</h3><p>用于判断某一个属性到底是本地属性，还是继承自prototype对象的属性  obj.hasOwnProerty(“name”)</p>\n<h3 id=\"in\"><a href=\"#in\" class=\"headerlink\" title=\"in\"></a>in</h3><p>某个实例是否含有某个属性，不管是不是本地属性。 “name” in Obj<br>in运算符还可以用来遍历某个对象的所有属性<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span>(<span class=\"keyword\">var</span> prop <span class=\"keyword\">in</span> cat1) &#123;</span><br><span class=\"line\">  alert(<span class=\"string\">\"cat1[\"</span>+prop+<span class=\"string\">\"]=\"</span>+cat1[prop]); </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n","excerpt":"<h2 id=\"this\"><a href=\"#this\" class=\"headerlink\" title=\"this\"></a>this</h2><p>javascript中的this和java一样都是表示当前对象，但需要注意的是同一个函数调用的方式不一样this指向的对象也不一样如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Test</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">  alert(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//此时的this，是window弹出[object Window]</span></span><br><span class=\"line\">Test();</span><br><span class=\"line\"><span class=\"comment\">//此时的this，是当前对象的的object 弹出[object Object]</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> t = <span class=\"keyword\">new</span> Test();</span><br></pre></td></tr></table></figure>","more":"<p>会出现前后不一样的原因其实很简单，因为我们直接在调用Test函数浏览器会把这个函数当成window中的一个函数，此时的this当然指向的是window。在后面我们通过new 实例化了Test此时浏览器会吧Test当做成了一个对象此时的this肯定是指向当前对象。</p>\n<h2 id=\"Prototype\"><a href=\"#Prototype\" class=\"headerlink\" title=\"Prototype\"></a>Prototype</h2><p>javascript规定，每一个构造函数都有一个prototype属性，指向另一个对象。这个对象的所有属性和方法，都会被构造函数的实例继承。<br>这意味着。我们可以把那些不变的属性和方法，直接定义在prototype对象上。这样带来的好处就是再实例多一个对象的时候减少了内存开销，因为多个对象指向的是同一个内存地址，提高了允许的效率。类似于java中的静态方法（被static修饰的变量和方法）。</p>\n<h2 id=\"对于对象常用的操作\"><a href=\"#对于对象常用的操作\" class=\"headerlink\" title=\"对于对象常用的操作\"></a>对于对象常用的操作</h2><h3 id=\"constructor-NaN\"><a href=\"#constructor-NaN\" class=\"headerlink\" title=\"constructor\"></a>constructor</h3><p>每一个对象都会自动包含一个constructor属性，指向他们的构造函数。obj.constructor == Object</p>\n<h3 id=\"instanceof\"><a href=\"#instanceof\" class=\"headerlink\" title=\"instanceof\"></a>instanceof</h3><p>用于验证原型对象与实例对象之间的关系 obj  instanceof Object</p>\n<h3 id=\"isPrototypeOf-NaN\"><a href=\"#isPrototypeOf-NaN\" class=\"headerlink\" title=\"isPrototypeOf\"></a>isPrototypeOf</h3><p>判断某个prototype对象和某个实例之间的关系 Object.prototype.isPrototypeOf(obj)</p>\n<h3 id=\"hasOwnProperty-NaN\"><a href=\"#hasOwnProperty-NaN\" class=\"headerlink\" title=\"hasOwnProperty\"></a>hasOwnProperty</h3><p>用于判断某一个属性到底是本地属性，还是继承自prototype对象的属性  obj.hasOwnProerty(“name”)</p>\n<h3 id=\"in\"><a href=\"#in\" class=\"headerlink\" title=\"in\"></a>in</h3><p>某个实例是否含有某个属性，不管是不是本地属性。 “name” in Obj<br>in运算符还可以用来遍历某个对象的所有属性<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span>(<span class=\"keyword\">var</span> prop <span class=\"keyword\">in</span> cat1) &#123;</span><br><span class=\"line\">  alert(<span class=\"string\">\"cat1[\"</span>+prop+<span class=\"string\">\"]=\"</span>+cat1[prop]); </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>"},{"title":"Hadoop集群完全分布式部署","date":"2015-01-08T15:45:20.000Z","comments":1,"toc":true,"_content":"\n## 准备环境\n|IP       \t\t | 主机名称    | 角色                  |操作系统   |\n|:--------------:|:-----------:|:---------------------:|:---------:|\n|192.168.131.129 |HadoopMaster | NameNode JobTracker   | CentOS 6.6|\n|192.168.131.128 |HadoopSlave1 | DataNode TaskTracker  | CentOS 6.6|\n\n<!-- more --> \n## hadoop版本\n***hadoop-2.6.0***\n***hadoop目录结构***\n![hadoop目录结构](003vMReezy6P1MG9JTO50&690.png)\n\n## 修改主机名称\n***将192.168.131.129修改为HadoopMaster***\n```\nshell vi /etc/sysconfig/network\nNETWORKING=yes\nHOSTNAME=HadoopMaster\n```\n***将192.168.131.128修改为HadoopSlave1***\n\n```\nshell vi /etc/sysconfig/network\nHOSTNAME=HadoopSlave\n```\n***通过命令hostname输出主机名称验证是否修改成功***\n\n```\nshell hostname\nHadoopMaster\n```\n\n## 配置hosts\n```\nshell vi /etc/hosts\n192.168.131.129 HadoopMaster\n192.168.131.128 HadoopSlave1\n```\n***在hosts文件添加如上两行 必须保证所有节点的host一样***\n\n\n## 安装jdk\n第一步：检查是否已经安装了jdk 存在就卸载 rpm -e 包名\n```\nshell rpm -qa|grep java\n```\n第二步：查看yum库是否有java安装包\n```\nshell yum -y list java*\n```\n第三步：选择一个进行安装\n```\nshell yum -y install java-1.6.0-openjdk*\n```\n第四步：确定是否安装成功\n```\nshell java -version\njava version \"1.6.0_20\"\nOpenJDK Runtime Environment (IcedTea6 1.9.10) (rhel-1.23.1.9.10.el5_7-i386)\nOpenJDK Client VM (build 19.0-b09, mixed mode)\n```\n显示如上信息表示安装成功\n\n## 安装软件（系统一般都自带）\n```\nshell yum install ssh\nshell yum install rsync\n```\n## 创建hadoop用户\n所有节点的用户名称和密码多必须保持一致相同\n\n## 切换到Hadoop用户配置ssh免密码登录\n1、在Master节点上执行\n```\nshell ssh-keygen -t dsa -P '' -f ~/.ssh/id_dsa \nshell cat ~/.ssh/id_dsa.pub >> ~/.ssh/authorized_keys \n```\n2、对authorized_keys 授权\n```\nshell chmod 744 authorized_keys \nshell ls ~/.ssh/\n```\n3、验证是否密码登录\n```\nshell ssh HadoopMaster\n```\n4、将id_dsa.pub 复制其他Slave节点hadoop用户~/.ssh/目录下\n```\nshell scp  ~/.ssh/id_dsa.pub hadoop@192.168.1.128:~/.ssh/\n```\n5、在Slave节点上通过\n```\nshell cat ~/.ssh/id_dsa.pub >> ~/.ssh/authorized_keys \n```\n生成authorized_keys并授权\n6、在Master节点上验证是否能密码了登录Slave节点\n```\nshell ssh HadoopSlave1\n```\n\n## 切换到root用户下载hadoop\n\n```\nshell http://apache.fayea.com/hadoop/common/hadoop-2.6.0/hadoop-2.6.0.tar.gz\n```\n[hadoop所有版本地址](http://apache.fayea.com/hadoop/common/)\n\n## 解压hadoop\n```\nshell tar -zxvf hadoop-2.6.0.tar.gz\n```\n将hadoop移动到/home/hadoop/目录下\n把hadoop-2.6.0目录操作权限分配给hadoop用户\n```\nshell chown hadoop hadoop-2.6.0/*\nshell chmod 700 hadoop-2.6.0/*\n```\n查看文件操作操作用户权限\n![文件权限](003vMReezy6P1KnAQkx19&690.png)\n\n## 设置hadoop启动参数\n### 设置java安装路径\n```\nshell vi etc/hadoop/hadoop-env.sh\nexport JAVA_HOME=java的安装路径\n```\n如果通过yum安装的jdk不知道java安装路径可以通过如下命令查找\n```\nshell which java\n/use/bin/java\n```\n得到的路径是/use/bin/java只需要将JAVE_HOME=/use即可\n![java环境配置](003vMReezy6P1KHLwtFe7&690.png)\n\n## 配置core-site.xml\n```xml\nshell /home/hadoop/hadoop-2.6.0/etc/hadoop/core-site.xml\n\n<configuration>\n\t<property>  \n        <name>hadoop.tmp.dir</name>  \n        <value>/home/hadoop/tmp</value>  \n        <description>Abase for other temporary directories.</description>  \n    </property>\n\t<property>\n      <name>fs.default.name</name>\n      <value>hdfs://HadoopMaster:9000</value>         \n  </property>          \n  <property>            \n       <name>mapred.job.tracker</name>           \n       <value>hdfs://HadoopMaster:9001</value>     \n  </property>                      \n  <property>  \n        <name>io.file.buffer.size</name>  \n        <value>4096</value>  \n  </property>\n</configuration>\n```\n\n## 配置hdfs-site.xml\n```xml\nshell vi /home/hadoop/hadoop-2.6.0/etc/hadoop/hdfs-site.xml\n\n<configuration>\n\t<property>  \n        <name>dfs.nameservices</name>  \n        <value>hadoop-cluster1</value>  \n    </property>  \n    <property>  \n        <name>dfs.namenode.secondary.http-address</name>  \n        <value>HadoopMaster:50090</value>  \n    </property>  \n    <property>  \n        <name>dfs.namenode.name.dir</name>  \n        <value>file:///home/hadoop/dfs/name</value>  \n    </property>  \n    <property>  \n        <name>dfs.datanode.data.dir</name>  \n        <value>file:///home/hadoop/dfs/data</value>  \n    </property>  \n    <property>  \n        <name>dfs.replication</name>  \n        <value>2</value>  \n    </property>  \n    <property>  \n        <name>dfs.webhdfs.enabled</name>  \n        <value>true</value>  \n    </property> \n</configuration>\n```\n\n## 配置slaves\n```\nshell vi /home/hadoop/hadoop-2.6.0/etc/hadoop/slaves\n```\n***集群中所有slave节点的配置文件HadoopSlave1是Slave节点主机名称***\n```\nshell cat etc/hadoop/slaves\nlocalhost\n```\n***将localhost修改为HadoopSlave1***\n\n## 配置hadoop安装目录\n```\nshell vi /etc/profile\n\nexport HADOOP_HOME=/home/hadoop/hadoop-2.6.0\nexport HADOOP_COMMON_HOME=$HADOOP_HOME\nexport HADOOP_HDFS_HOME=$HADOOP_HOME\nexport HADOOP_MAPRED_HOME=$HADOOP_HOME\nexport HADOOP_YARN_HOME=$HADOOP_HOME\nexport HADOOP_CONF_DIR=$HADOOP_HOME/etc/hadoop\nexport PATH=$PATH:$HADOOP_HOME/bin:$HADOOP_HOOME/sbin:$HADOOP_HOME/lib\nexport HADOOP_COMMON_LIB_NATIVE_DIR=$HADOOP_HOME/lib/native\nexport HADOOP_OPTS=\"-Djava.library.path=$HADOOP_HOME/lib\"\n\n#使修改立即生效\nshell source /etc/profile \n```\n\n***注意：如果不添加上面配置可能会报如下错误***\n```\n15/01/07 23:52:35 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\nStarting namenodes on [OpenJDK Client VM warning: You have loaded library /home/hadoop/hadoop-2.6.0/lib/native/libhadoop.so.1.0.0 which might have disabled stack guard. The VM will try to fix the stack guard now.\nIt's highly recommended that you fix the library with 'execstack -c ', or link it with '-z noexecstack'.\n```\n\n## 格式化hadoop\n```\nshell bin/hadoop namenode -format\n```\n![格式化hadoop](003vMReezy6P1LyH3gqae&690.jpg)\n格式化成功\n\n## 同步节点\n将hadoop分别复制到其他节点的相同目录下（例如Master节点hadoop目录是/home/hadoop/hadoop-2.6.0其他节点也是这个目录）\n```\nshell scp -r hadoop-2.6.0 hadoop@192.168.131.128:/home/hadoop/\n```\n\n## 启动hadoop\n```\nshell sbin/start-all.sh\n```\n\n通过http://192.168.131.129:50070查看hadoop相关信息\n![启动成功](003vMReezy6P1MlAy3H5d&690.jpg)\n如果没有启动成功或者live noades为0查看hadoop启动日志就能很快解决问题\n![启动失败](003vMReezy6P1Mzjamje7&690.jpg)\n\n查看日志看到如异常（日志文件在 hadoop logs目录下）\n![查看日志](003vMReezy6P1O1zJBg32&690.jpg)\n这个问题主要是因为Master节点clusterID 和Slave节点clusterID 号不一致导致解决办法就是删除在core-site.xml中配置的hadoop.tmp.dir 的/home/hadoop/tmp目录下所有文件重新启动就ok了","source":"_posts/Hadoop集群完全分布式部署.md","raw":"---\ntitle: Hadoop集群完全分布式部署\ndate: 2015-01-08 23:45:20 \ncomments: true \ncategories: Hadoop\ntoc: true\n---\n\n## 准备环境\n|IP       \t\t | 主机名称    | 角色                  |操作系统   |\n|:--------------:|:-----------:|:---------------------:|:---------:|\n|192.168.131.129 |HadoopMaster | NameNode JobTracker   | CentOS 6.6|\n|192.168.131.128 |HadoopSlave1 | DataNode TaskTracker  | CentOS 6.6|\n\n<!-- more --> \n## hadoop版本\n***hadoop-2.6.0***\n***hadoop目录结构***\n![hadoop目录结构](003vMReezy6P1MG9JTO50&690.png)\n\n## 修改主机名称\n***将192.168.131.129修改为HadoopMaster***\n```\nshell vi /etc/sysconfig/network\nNETWORKING=yes\nHOSTNAME=HadoopMaster\n```\n***将192.168.131.128修改为HadoopSlave1***\n\n```\nshell vi /etc/sysconfig/network\nHOSTNAME=HadoopSlave\n```\n***通过命令hostname输出主机名称验证是否修改成功***\n\n```\nshell hostname\nHadoopMaster\n```\n\n## 配置hosts\n```\nshell vi /etc/hosts\n192.168.131.129 HadoopMaster\n192.168.131.128 HadoopSlave1\n```\n***在hosts文件添加如上两行 必须保证所有节点的host一样***\n\n\n## 安装jdk\n第一步：检查是否已经安装了jdk 存在就卸载 rpm -e 包名\n```\nshell rpm -qa|grep java\n```\n第二步：查看yum库是否有java安装包\n```\nshell yum -y list java*\n```\n第三步：选择一个进行安装\n```\nshell yum -y install java-1.6.0-openjdk*\n```\n第四步：确定是否安装成功\n```\nshell java -version\njava version \"1.6.0_20\"\nOpenJDK Runtime Environment (IcedTea6 1.9.10) (rhel-1.23.1.9.10.el5_7-i386)\nOpenJDK Client VM (build 19.0-b09, mixed mode)\n```\n显示如上信息表示安装成功\n\n## 安装软件（系统一般都自带）\n```\nshell yum install ssh\nshell yum install rsync\n```\n## 创建hadoop用户\n所有节点的用户名称和密码多必须保持一致相同\n\n## 切换到Hadoop用户配置ssh免密码登录\n1、在Master节点上执行\n```\nshell ssh-keygen -t dsa -P '' -f ~/.ssh/id_dsa \nshell cat ~/.ssh/id_dsa.pub >> ~/.ssh/authorized_keys \n```\n2、对authorized_keys 授权\n```\nshell chmod 744 authorized_keys \nshell ls ~/.ssh/\n```\n3、验证是否密码登录\n```\nshell ssh HadoopMaster\n```\n4、将id_dsa.pub 复制其他Slave节点hadoop用户~/.ssh/目录下\n```\nshell scp  ~/.ssh/id_dsa.pub hadoop@192.168.1.128:~/.ssh/\n```\n5、在Slave节点上通过\n```\nshell cat ~/.ssh/id_dsa.pub >> ~/.ssh/authorized_keys \n```\n生成authorized_keys并授权\n6、在Master节点上验证是否能密码了登录Slave节点\n```\nshell ssh HadoopSlave1\n```\n\n## 切换到root用户下载hadoop\n\n```\nshell http://apache.fayea.com/hadoop/common/hadoop-2.6.0/hadoop-2.6.0.tar.gz\n```\n[hadoop所有版本地址](http://apache.fayea.com/hadoop/common/)\n\n## 解压hadoop\n```\nshell tar -zxvf hadoop-2.6.0.tar.gz\n```\n将hadoop移动到/home/hadoop/目录下\n把hadoop-2.6.0目录操作权限分配给hadoop用户\n```\nshell chown hadoop hadoop-2.6.0/*\nshell chmod 700 hadoop-2.6.0/*\n```\n查看文件操作操作用户权限\n![文件权限](003vMReezy6P1KnAQkx19&690.png)\n\n## 设置hadoop启动参数\n### 设置java安装路径\n```\nshell vi etc/hadoop/hadoop-env.sh\nexport JAVA_HOME=java的安装路径\n```\n如果通过yum安装的jdk不知道java安装路径可以通过如下命令查找\n```\nshell which java\n/use/bin/java\n```\n得到的路径是/use/bin/java只需要将JAVE_HOME=/use即可\n![java环境配置](003vMReezy6P1KHLwtFe7&690.png)\n\n## 配置core-site.xml\n```xml\nshell /home/hadoop/hadoop-2.6.0/etc/hadoop/core-site.xml\n\n<configuration>\n\t<property>  \n        <name>hadoop.tmp.dir</name>  \n        <value>/home/hadoop/tmp</value>  \n        <description>Abase for other temporary directories.</description>  \n    </property>\n\t<property>\n      <name>fs.default.name</name>\n      <value>hdfs://HadoopMaster:9000</value>         \n  </property>          \n  <property>            \n       <name>mapred.job.tracker</name>           \n       <value>hdfs://HadoopMaster:9001</value>     \n  </property>                      \n  <property>  \n        <name>io.file.buffer.size</name>  \n        <value>4096</value>  \n  </property>\n</configuration>\n```\n\n## 配置hdfs-site.xml\n```xml\nshell vi /home/hadoop/hadoop-2.6.0/etc/hadoop/hdfs-site.xml\n\n<configuration>\n\t<property>  \n        <name>dfs.nameservices</name>  \n        <value>hadoop-cluster1</value>  \n    </property>  \n    <property>  \n        <name>dfs.namenode.secondary.http-address</name>  \n        <value>HadoopMaster:50090</value>  \n    </property>  \n    <property>  \n        <name>dfs.namenode.name.dir</name>  \n        <value>file:///home/hadoop/dfs/name</value>  \n    </property>  \n    <property>  \n        <name>dfs.datanode.data.dir</name>  \n        <value>file:///home/hadoop/dfs/data</value>  \n    </property>  \n    <property>  \n        <name>dfs.replication</name>  \n        <value>2</value>  \n    </property>  \n    <property>  \n        <name>dfs.webhdfs.enabled</name>  \n        <value>true</value>  \n    </property> \n</configuration>\n```\n\n## 配置slaves\n```\nshell vi /home/hadoop/hadoop-2.6.0/etc/hadoop/slaves\n```\n***集群中所有slave节点的配置文件HadoopSlave1是Slave节点主机名称***\n```\nshell cat etc/hadoop/slaves\nlocalhost\n```\n***将localhost修改为HadoopSlave1***\n\n## 配置hadoop安装目录\n```\nshell vi /etc/profile\n\nexport HADOOP_HOME=/home/hadoop/hadoop-2.6.0\nexport HADOOP_COMMON_HOME=$HADOOP_HOME\nexport HADOOP_HDFS_HOME=$HADOOP_HOME\nexport HADOOP_MAPRED_HOME=$HADOOP_HOME\nexport HADOOP_YARN_HOME=$HADOOP_HOME\nexport HADOOP_CONF_DIR=$HADOOP_HOME/etc/hadoop\nexport PATH=$PATH:$HADOOP_HOME/bin:$HADOOP_HOOME/sbin:$HADOOP_HOME/lib\nexport HADOOP_COMMON_LIB_NATIVE_DIR=$HADOOP_HOME/lib/native\nexport HADOOP_OPTS=\"-Djava.library.path=$HADOOP_HOME/lib\"\n\n#使修改立即生效\nshell source /etc/profile \n```\n\n***注意：如果不添加上面配置可能会报如下错误***\n```\n15/01/07 23:52:35 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\nStarting namenodes on [OpenJDK Client VM warning: You have loaded library /home/hadoop/hadoop-2.6.0/lib/native/libhadoop.so.1.0.0 which might have disabled stack guard. The VM will try to fix the stack guard now.\nIt's highly recommended that you fix the library with 'execstack -c ', or link it with '-z noexecstack'.\n```\n\n## 格式化hadoop\n```\nshell bin/hadoop namenode -format\n```\n![格式化hadoop](003vMReezy6P1LyH3gqae&690.jpg)\n格式化成功\n\n## 同步节点\n将hadoop分别复制到其他节点的相同目录下（例如Master节点hadoop目录是/home/hadoop/hadoop-2.6.0其他节点也是这个目录）\n```\nshell scp -r hadoop-2.6.0 hadoop@192.168.131.128:/home/hadoop/\n```\n\n## 启动hadoop\n```\nshell sbin/start-all.sh\n```\n\n通过http://192.168.131.129:50070查看hadoop相关信息\n![启动成功](003vMReezy6P1MlAy3H5d&690.jpg)\n如果没有启动成功或者live noades为0查看hadoop启动日志就能很快解决问题\n![启动失败](003vMReezy6P1Mzjamje7&690.jpg)\n\n查看日志看到如异常（日志文件在 hadoop logs目录下）\n![查看日志](003vMReezy6P1O1zJBg32&690.jpg)\n这个问题主要是因为Master节点clusterID 和Slave节点clusterID 号不一致导致解决办法就是删除在core-site.xml中配置的hadoop.tmp.dir 的/home/hadoop/tmp目录下所有文件重新启动就ok了","slug":"Hadoop集群完全分布式部署","published":1,"updated":"2016-05-11T13:43:44.383Z","layout":"post","photos":[],"link":"","_id":"cio5q2lig00017oyb696tvb8p","content":"<h2 id=\"准备环境\"><a href=\"#准备环境\" class=\"headerlink\" title=\"准备环境\"></a>准备环境</h2><table>\n<thead>\n<tr>\n<th style=\"text-align:center\">IP</th>\n<th style=\"text-align:center\">主机名称</th>\n<th style=\"text-align:center\">角色</th>\n<th style=\"text-align:center\">操作系统</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">192.168.131.129</td>\n<td style=\"text-align:center\">HadoopMaster</td>\n<td style=\"text-align:center\">NameNode JobTracker</td>\n<td style=\"text-align:center\">CentOS 6.6</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">192.168.131.128</td>\n<td style=\"text-align:center\">HadoopSlave1</td>\n<td style=\"text-align:center\">DataNode TaskTracker</td>\n<td style=\"text-align:center\">CentOS 6.6</td>\n</tr>\n</tbody>\n</table>\n<a id=\"more\"></a> \n<h2 id=\"hadoop版本\"><a href=\"#hadoop版本\" class=\"headerlink\" title=\"hadoop版本\"></a>hadoop版本</h2><p><strong><em>hadoop-2.6.0</em></strong><br><strong><em>hadoop目录结构</em></strong><br><img src=\"003vMReezy6P1MG9JTO50&amp;690.png\" alt=\"hadoop目录结构\"></p>\n<h2 id=\"修改主机名称\"><a href=\"#修改主机名称\" class=\"headerlink\" title=\"修改主机名称\"></a>修改主机名称</h2><p><strong><em>将192.168.131.129修改为HadoopMaster</em></strong><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell vi /etc/sysconfig/network</span><br><span class=\"line\">NETWORKING=yes</span><br><span class=\"line\">HOSTNAME=HadoopMaster</span><br></pre></td></tr></table></figure></p>\n<p><strong><em>将192.168.131.128修改为HadoopSlave1</em></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell vi /etc/sysconfig/network</span><br><span class=\"line\">HOSTNAME=HadoopSlave</span><br></pre></td></tr></table></figure>\n<p><strong><em>通过命令hostname输出主机名称验证是否修改成功</em></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell hostname</span><br><span class=\"line\">HadoopMaster</span><br></pre></td></tr></table></figure>\n<h2 id=\"配置hosts\"><a href=\"#配置hosts\" class=\"headerlink\" title=\"配置hosts\"></a>配置hosts</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell vi /etc/hosts</span><br><span class=\"line\">192.168.131.129 HadoopMaster</span><br><span class=\"line\">192.168.131.128 HadoopSlave1</span><br></pre></td></tr></table></figure>\n<p><strong><em>在hosts文件添加如上两行 必须保证所有节点的host一样</em></strong></p>\n<h2 id=\"安装jdk\"><a href=\"#安装jdk\" class=\"headerlink\" title=\"安装jdk\"></a>安装jdk</h2><p>第一步：检查是否已经安装了jdk 存在就卸载 rpm -e 包名<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell rpm -qa|grep java</span><br></pre></td></tr></table></figure></p>\n<p>第二步：查看yum库是否有java安装包<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell yum -y list java*</span><br></pre></td></tr></table></figure></p>\n<p>第三步：选择一个进行安装<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell yum -y install java-1.6.0-openjdk*</span><br></pre></td></tr></table></figure></p>\n<p>第四步：确定是否安装成功<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell java -version</span><br><span class=\"line\">java version &quot;1.6.0_20&quot;</span><br><span class=\"line\">OpenJDK Runtime Environment (IcedTea6 1.9.10) (rhel-1.23.1.9.10.el5_7-i386)</span><br><span class=\"line\">OpenJDK Client VM (build 19.0-b09, mixed mode)</span><br></pre></td></tr></table></figure></p>\n<p>显示如上信息表示安装成功</p>\n<h2 id=\"安装软件（系统一般都自带）\"><a href=\"#安装软件（系统一般都自带）\" class=\"headerlink\" title=\"安装软件（系统一般都自带）\"></a>安装软件（系统一般都自带）</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell yum install ssh</span><br><span class=\"line\">shell yum install rsync</span><br></pre></td></tr></table></figure>\n<h2 id=\"创建hadoop用户\"><a href=\"#创建hadoop用户\" class=\"headerlink\" title=\"创建hadoop用户\"></a>创建hadoop用户</h2><p>所有节点的用户名称和密码多必须保持一致相同</p>\n<h2 id=\"切换到Hadoop用户配置ssh免密码登录\"><a href=\"#切换到Hadoop用户配置ssh免密码登录\" class=\"headerlink\" title=\"切换到Hadoop用户配置ssh免密码登录\"></a>切换到Hadoop用户配置ssh免密码登录</h2><p>1、在Master节点上执行<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell ssh-keygen -t dsa -P &apos;&apos; -f ~/.ssh/id_dsa </span><br><span class=\"line\">shell cat ~/.ssh/id_dsa.pub &gt;&gt; ~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure></p>\n<p>2、对authorized_keys 授权<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell chmod 744 authorized_keys </span><br><span class=\"line\">shell ls ~/.ssh/</span><br></pre></td></tr></table></figure></p>\n<p>3、验证是否密码登录<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell ssh HadoopMaster</span><br></pre></td></tr></table></figure></p>\n<p>4、将id_dsa.pub 复制其他Slave节点hadoop用户~/.ssh/目录下<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell scp  ~/.ssh/id_dsa.pub hadoop@192.168.1.128:~/.ssh/</span><br></pre></td></tr></table></figure></p>\n<p>5、在Slave节点上通过<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell cat ~/.ssh/id_dsa.pub &gt;&gt; ~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure></p>\n<p>生成authorized_keys并授权<br>6、在Master节点上验证是否能密码了登录Slave节点<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell ssh HadoopSlave1</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"切换到root用户下载hadoop\"><a href=\"#切换到root用户下载hadoop\" class=\"headerlink\" title=\"切换到root用户下载hadoop\"></a>切换到root用户下载hadoop</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell http://apache.fayea.com/hadoop/common/hadoop-2.6.0/hadoop-2.6.0.tar.gz</span><br></pre></td></tr></table></figure>\n<p><a href=\"http://apache.fayea.com/hadoop/common/\" target=\"_blank\" rel=\"external\">hadoop所有版本地址</a></p>\n<h2 id=\"解压hadoop\"><a href=\"#解压hadoop\" class=\"headerlink\" title=\"解压hadoop\"></a>解压hadoop</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell tar -zxvf hadoop-2.6.0.tar.gz</span><br></pre></td></tr></table></figure>\n<p>将hadoop移动到/home/hadoop/目录下<br>把hadoop-2.6.0目录操作权限分配给hadoop用户<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell chown hadoop hadoop-2.6.0/*</span><br><span class=\"line\">shell chmod 700 hadoop-2.6.0/*</span><br></pre></td></tr></table></figure></p>\n<p>查看文件操作操作用户权限<br><img src=\"003vMReezy6P1KnAQkx19&amp;690.png\" alt=\"文件权限\"></p>\n<h2 id=\"设置hadoop启动参数\"><a href=\"#设置hadoop启动参数\" class=\"headerlink\" title=\"设置hadoop启动参数\"></a>设置hadoop启动参数</h2><h3 id=\"设置java安装路径\"><a href=\"#设置java安装路径\" class=\"headerlink\" title=\"设置java安装路径\"></a>设置java安装路径</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell vi etc/hadoop/hadoop-env.sh</span><br><span class=\"line\">export JAVA_HOME=java的安装路径</span><br></pre></td></tr></table></figure>\n<p>如果通过yum安装的jdk不知道java安装路径可以通过如下命令查找<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell which java</span><br><span class=\"line\">/use/bin/java</span><br></pre></td></tr></table></figure></p>\n<p>得到的路径是/use/bin/java只需要将JAVE_HOME=/use即可<br><img src=\"003vMReezy6P1KHLwtFe7&amp;690.png\" alt=\"java环境配置\"></p>\n<h2 id=\"配置core-site-xml\"><a href=\"#配置core-site-xml\" class=\"headerlink\" title=\"配置core-site.xml\"></a>配置core-site.xml</h2><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell /home/hadoop/hadoop-2.6.0/etc/hadoop/core-site.xml</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>hadoop.tmp.dir<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>/home/hadoop/tmp<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">description</span>&gt;</span>Abase for other temporary directories.<span class=\"tag\">&lt;/<span class=\"name\">description</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>fs.default.name<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>hdfs://HadoopMaster:9000<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span>         </span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span>          </span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span>            </span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>mapred.job.tracker<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span>           </span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>hdfs://HadoopMaster:9001<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span>     </span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span>                      </span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>io.file.buffer.size<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>4096<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span>  </span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"配置hdfs-site-xml\"><a href=\"#配置hdfs-site-xml\" class=\"headerlink\" title=\"配置hdfs-site.xml\"></a>配置hdfs-site.xml</h2><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell vi /home/hadoop/hadoop-2.6.0/etc/hadoop/hdfs-site.xml</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>dfs.nameservices<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>hadoop-cluster1<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>dfs.namenode.secondary.http-address<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>HadoopMaster:50090<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>dfs.namenode.name.dir<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>file:///home/hadoop/dfs/name<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>dfs.datanode.data.dir<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>file:///home/hadoop/dfs/data<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>dfs.replication<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>2<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>dfs.webhdfs.enabled<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"配置slaves\"><a href=\"#配置slaves\" class=\"headerlink\" title=\"配置slaves\"></a>配置slaves</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell vi /home/hadoop/hadoop-2.6.0/etc/hadoop/slaves</span><br></pre></td></tr></table></figure>\n<p><strong><em>集群中所有slave节点的配置文件HadoopSlave1是Slave节点主机名称</em></strong><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell cat etc/hadoop/slaves</span><br><span class=\"line\">localhost</span><br></pre></td></tr></table></figure></p>\n<p><strong><em>将localhost修改为HadoopSlave1</em></strong></p>\n<h2 id=\"配置hadoop安装目录\"><a href=\"#配置hadoop安装目录\" class=\"headerlink\" title=\"配置hadoop安装目录\"></a>配置hadoop安装目录</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell vi /etc/profile</span><br><span class=\"line\"></span><br><span class=\"line\">export HADOOP_HOME=/home/hadoop/hadoop-2.6.0</span><br><span class=\"line\">export HADOOP_COMMON_HOME=$HADOOP_HOME</span><br><span class=\"line\">export HADOOP_HDFS_HOME=$HADOOP_HOME</span><br><span class=\"line\">export HADOOP_MAPRED_HOME=$HADOOP_HOME</span><br><span class=\"line\">export HADOOP_YARN_HOME=$HADOOP_HOME</span><br><span class=\"line\">export HADOOP_CONF_DIR=$HADOOP_HOME/etc/hadoop</span><br><span class=\"line\">export PATH=$PATH:$HADOOP_HOME/bin:$HADOOP_HOOME/sbin:$HADOOP_HOME/lib</span><br><span class=\"line\">export HADOOP_COMMON_LIB_NATIVE_DIR=$HADOOP_HOME/lib/native</span><br><span class=\"line\">export HADOOP_OPTS=&quot;-Djava.library.path=$HADOOP_HOME/lib&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">#使修改立即生效</span><br><span class=\"line\">shell source /etc/profile</span><br></pre></td></tr></table></figure>\n<p><strong><em>注意：如果不添加上面配置可能会报如下错误</em></strong><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">15/01/07 23:52:35 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable</span><br><span class=\"line\">Starting namenodes on [OpenJDK Client VM warning: You have loaded library /home/hadoop/hadoop-2.6.0/lib/native/libhadoop.so.1.0.0 which might have disabled stack guard. The VM will try to fix the stack guard now.</span><br><span class=\"line\">It&apos;s highly recommended that you fix the library with &apos;execstack -c &apos;, or link it with &apos;-z noexecstack&apos;.</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"格式化hadoop\"><a href=\"#格式化hadoop\" class=\"headerlink\" title=\"格式化hadoop\"></a>格式化hadoop</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell bin/hadoop namenode -format</span><br></pre></td></tr></table></figure>\n<p><img src=\"003vMReezy6P1LyH3gqae&amp;690.jpg\" alt=\"格式化hadoop\"><br>格式化成功</p>\n<h2 id=\"同步节点\"><a href=\"#同步节点\" class=\"headerlink\" title=\"同步节点\"></a>同步节点</h2><p>将hadoop分别复制到其他节点的相同目录下（例如Master节点hadoop目录是/home/hadoop/hadoop-2.6.0其他节点也是这个目录）<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell scp -r hadoop-2.6.0 hadoop@192.168.131.128:/home/hadoop/</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"启动hadoop\"><a href=\"#启动hadoop\" class=\"headerlink\" title=\"启动hadoop\"></a>启动hadoop</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell sbin/start-all.sh</span><br></pre></td></tr></table></figure>\n<p>通过<a href=\"http://192.168.131.129:50070查看hadoop相关信息\" target=\"_blank\" rel=\"external\">http://192.168.131.129:50070查看hadoop相关信息</a><br><img src=\"003vMReezy6P1MlAy3H5d&amp;690.jpg\" alt=\"启动成功\"><br>如果没有启动成功或者live noades为0查看hadoop启动日志就能很快解决问题<br><img src=\"003vMReezy6P1Mzjamje7&amp;690.jpg\" alt=\"启动失败\"></p>\n<p>查看日志看到如异常（日志文件在 hadoop logs目录下）<br><img src=\"003vMReezy6P1O1zJBg32&amp;690.jpg\" alt=\"查看日志\"><br>这个问题主要是因为Master节点clusterID 和Slave节点clusterID 号不一致导致解决办法就是删除在core-site.xml中配置的hadoop.tmp.dir 的/home/hadoop/tmp目录下所有文件重新启动就ok了</p>\n","excerpt":"<h2 id=\"准备环境\"><a href=\"#准备环境\" class=\"headerlink\" title=\"准备环境\"></a>准备环境</h2><table>\n<thead>\n<tr>\n<th style=\"text-align:center\">IP</th>\n<th style=\"text-align:center\">主机名称</th>\n<th style=\"text-align:center\">角色</th>\n<th style=\"text-align:center\">操作系统</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">192.168.131.129</td>\n<td style=\"text-align:center\">HadoopMaster</td>\n<td style=\"text-align:center\">NameNode JobTracker</td>\n<td style=\"text-align:center\">CentOS 6.6</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">192.168.131.128</td>\n<td style=\"text-align:center\">HadoopSlave1</td>\n<td style=\"text-align:center\">DataNode TaskTracker</td>\n<td style=\"text-align:center\">CentOS 6.6</td>\n</tr>\n</tbody>\n</table>","more":"<h2 id=\"hadoop版本\"><a href=\"#hadoop版本\" class=\"headerlink\" title=\"hadoop版本\"></a>hadoop版本</h2><p><strong><em>hadoop-2.6.0</em></strong><br><strong><em>hadoop目录结构</em></strong><br><img src=\"003vMReezy6P1MG9JTO50&amp;690.png\" alt=\"hadoop目录结构\"></p>\n<h2 id=\"修改主机名称\"><a href=\"#修改主机名称\" class=\"headerlink\" title=\"修改主机名称\"></a>修改主机名称</h2><p><strong><em>将192.168.131.129修改为HadoopMaster</em></strong><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell vi /etc/sysconfig/network</span><br><span class=\"line\">NETWORKING=yes</span><br><span class=\"line\">HOSTNAME=HadoopMaster</span><br></pre></td></tr></table></figure></p>\n<p><strong><em>将192.168.131.128修改为HadoopSlave1</em></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell vi /etc/sysconfig/network</span><br><span class=\"line\">HOSTNAME=HadoopSlave</span><br></pre></td></tr></table></figure>\n<p><strong><em>通过命令hostname输出主机名称验证是否修改成功</em></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell hostname</span><br><span class=\"line\">HadoopMaster</span><br></pre></td></tr></table></figure>\n<h2 id=\"配置hosts\"><a href=\"#配置hosts\" class=\"headerlink\" title=\"配置hosts\"></a>配置hosts</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell vi /etc/hosts</span><br><span class=\"line\">192.168.131.129 HadoopMaster</span><br><span class=\"line\">192.168.131.128 HadoopSlave1</span><br></pre></td></tr></table></figure>\n<p><strong><em>在hosts文件添加如上两行 必须保证所有节点的host一样</em></strong></p>\n<h2 id=\"安装jdk\"><a href=\"#安装jdk\" class=\"headerlink\" title=\"安装jdk\"></a>安装jdk</h2><p>第一步：检查是否已经安装了jdk 存在就卸载 rpm -e 包名<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell rpm -qa|grep java</span><br></pre></td></tr></table></figure></p>\n<p>第二步：查看yum库是否有java安装包<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell yum -y list java*</span><br></pre></td></tr></table></figure></p>\n<p>第三步：选择一个进行安装<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell yum -y install java-1.6.0-openjdk*</span><br></pre></td></tr></table></figure></p>\n<p>第四步：确定是否安装成功<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell java -version</span><br><span class=\"line\">java version &quot;1.6.0_20&quot;</span><br><span class=\"line\">OpenJDK Runtime Environment (IcedTea6 1.9.10) (rhel-1.23.1.9.10.el5_7-i386)</span><br><span class=\"line\">OpenJDK Client VM (build 19.0-b09, mixed mode)</span><br></pre></td></tr></table></figure></p>\n<p>显示如上信息表示安装成功</p>\n<h2 id=\"安装软件（系统一般都自带）\"><a href=\"#安装软件（系统一般都自带）\" class=\"headerlink\" title=\"安装软件（系统一般都自带）\"></a>安装软件（系统一般都自带）</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell yum install ssh</span><br><span class=\"line\">shell yum install rsync</span><br></pre></td></tr></table></figure>\n<h2 id=\"创建hadoop用户\"><a href=\"#创建hadoop用户\" class=\"headerlink\" title=\"创建hadoop用户\"></a>创建hadoop用户</h2><p>所有节点的用户名称和密码多必须保持一致相同</p>\n<h2 id=\"切换到Hadoop用户配置ssh免密码登录\"><a href=\"#切换到Hadoop用户配置ssh免密码登录\" class=\"headerlink\" title=\"切换到Hadoop用户配置ssh免密码登录\"></a>切换到Hadoop用户配置ssh免密码登录</h2><p>1、在Master节点上执行<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell ssh-keygen -t dsa -P &apos;&apos; -f ~/.ssh/id_dsa </span><br><span class=\"line\">shell cat ~/.ssh/id_dsa.pub &gt;&gt; ~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure></p>\n<p>2、对authorized_keys 授权<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell chmod 744 authorized_keys </span><br><span class=\"line\">shell ls ~/.ssh/</span><br></pre></td></tr></table></figure></p>\n<p>3、验证是否密码登录<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell ssh HadoopMaster</span><br></pre></td></tr></table></figure></p>\n<p>4、将id_dsa.pub 复制其他Slave节点hadoop用户~/.ssh/目录下<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell scp  ~/.ssh/id_dsa.pub hadoop@192.168.1.128:~/.ssh/</span><br></pre></td></tr></table></figure></p>\n<p>5、在Slave节点上通过<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell cat ~/.ssh/id_dsa.pub &gt;&gt; ~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure></p>\n<p>生成authorized_keys并授权<br>6、在Master节点上验证是否能密码了登录Slave节点<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell ssh HadoopSlave1</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"切换到root用户下载hadoop\"><a href=\"#切换到root用户下载hadoop\" class=\"headerlink\" title=\"切换到root用户下载hadoop\"></a>切换到root用户下载hadoop</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell http://apache.fayea.com/hadoop/common/hadoop-2.6.0/hadoop-2.6.0.tar.gz</span><br></pre></td></tr></table></figure>\n<p><a href=\"http://apache.fayea.com/hadoop/common/\">hadoop所有版本地址</a></p>\n<h2 id=\"解压hadoop\"><a href=\"#解压hadoop\" class=\"headerlink\" title=\"解压hadoop\"></a>解压hadoop</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell tar -zxvf hadoop-2.6.0.tar.gz</span><br></pre></td></tr></table></figure>\n<p>将hadoop移动到/home/hadoop/目录下<br>把hadoop-2.6.0目录操作权限分配给hadoop用户<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell chown hadoop hadoop-2.6.0/*</span><br><span class=\"line\">shell chmod 700 hadoop-2.6.0/*</span><br></pre></td></tr></table></figure></p>\n<p>查看文件操作操作用户权限<br><img src=\"003vMReezy6P1KnAQkx19&amp;690.png\" alt=\"文件权限\"></p>\n<h2 id=\"设置hadoop启动参数\"><a href=\"#设置hadoop启动参数\" class=\"headerlink\" title=\"设置hadoop启动参数\"></a>设置hadoop启动参数</h2><h3 id=\"设置java安装路径\"><a href=\"#设置java安装路径\" class=\"headerlink\" title=\"设置java安装路径\"></a>设置java安装路径</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell vi etc/hadoop/hadoop-env.sh</span><br><span class=\"line\">export JAVA_HOME=java的安装路径</span><br></pre></td></tr></table></figure>\n<p>如果通过yum安装的jdk不知道java安装路径可以通过如下命令查找<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell which java</span><br><span class=\"line\">/use/bin/java</span><br></pre></td></tr></table></figure></p>\n<p>得到的路径是/use/bin/java只需要将JAVE_HOME=/use即可<br><img src=\"003vMReezy6P1KHLwtFe7&amp;690.png\" alt=\"java环境配置\"></p>\n<h2 id=\"配置core-site-xml\"><a href=\"#配置core-site-xml\" class=\"headerlink\" title=\"配置core-site.xml\"></a>配置core-site.xml</h2><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell /home/hadoop/hadoop-2.6.0/etc/hadoop/core-site.xml</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>hadoop.tmp.dir<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>/home/hadoop/tmp<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">description</span>&gt;</span>Abase for other temporary directories.<span class=\"tag\">&lt;/<span class=\"name\">description</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>fs.default.name<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>hdfs://HadoopMaster:9000<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span>         </span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span>          </span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span>            </span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>mapred.job.tracker<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span>           </span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>hdfs://HadoopMaster:9001<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span>     </span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span>                      </span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>io.file.buffer.size<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>4096<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span>  </span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"配置hdfs-site-xml\"><a href=\"#配置hdfs-site-xml\" class=\"headerlink\" title=\"配置hdfs-site.xml\"></a>配置hdfs-site.xml</h2><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell vi /home/hadoop/hadoop-2.6.0/etc/hadoop/hdfs-site.xml</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>dfs.nameservices<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>hadoop-cluster1<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>dfs.namenode.secondary.http-address<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>HadoopMaster:50090<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>dfs.namenode.name.dir<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>file:///home/hadoop/dfs/name<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>dfs.datanode.data.dir<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>file:///home/hadoop/dfs/data<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>dfs.replication<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>2<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>dfs.webhdfs.enabled<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"配置slaves\"><a href=\"#配置slaves\" class=\"headerlink\" title=\"配置slaves\"></a>配置slaves</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell vi /home/hadoop/hadoop-2.6.0/etc/hadoop/slaves</span><br></pre></td></tr></table></figure>\n<p><strong><em>集群中所有slave节点的配置文件HadoopSlave1是Slave节点主机名称</em></strong><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell cat etc/hadoop/slaves</span><br><span class=\"line\">localhost</span><br></pre></td></tr></table></figure></p>\n<p><strong><em>将localhost修改为HadoopSlave1</em></strong></p>\n<h2 id=\"配置hadoop安装目录\"><a href=\"#配置hadoop安装目录\" class=\"headerlink\" title=\"配置hadoop安装目录\"></a>配置hadoop安装目录</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell vi /etc/profile</span><br><span class=\"line\"></span><br><span class=\"line\">export HADOOP_HOME=/home/hadoop/hadoop-2.6.0</span><br><span class=\"line\">export HADOOP_COMMON_HOME=$HADOOP_HOME</span><br><span class=\"line\">export HADOOP_HDFS_HOME=$HADOOP_HOME</span><br><span class=\"line\">export HADOOP_MAPRED_HOME=$HADOOP_HOME</span><br><span class=\"line\">export HADOOP_YARN_HOME=$HADOOP_HOME</span><br><span class=\"line\">export HADOOP_CONF_DIR=$HADOOP_HOME/etc/hadoop</span><br><span class=\"line\">export PATH=$PATH:$HADOOP_HOME/bin:$HADOOP_HOOME/sbin:$HADOOP_HOME/lib</span><br><span class=\"line\">export HADOOP_COMMON_LIB_NATIVE_DIR=$HADOOP_HOME/lib/native</span><br><span class=\"line\">export HADOOP_OPTS=&quot;-Djava.library.path=$HADOOP_HOME/lib&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">#使修改立即生效</span><br><span class=\"line\">shell source /etc/profile</span><br></pre></td></tr></table></figure>\n<p><strong><em>注意：如果不添加上面配置可能会报如下错误</em></strong><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">15/01/07 23:52:35 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable</span><br><span class=\"line\">Starting namenodes on [OpenJDK Client VM warning: You have loaded library /home/hadoop/hadoop-2.6.0/lib/native/libhadoop.so.1.0.0 which might have disabled stack guard. The VM will try to fix the stack guard now.</span><br><span class=\"line\">It&apos;s highly recommended that you fix the library with &apos;execstack -c &apos;, or link it with &apos;-z noexecstack&apos;.</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"格式化hadoop\"><a href=\"#格式化hadoop\" class=\"headerlink\" title=\"格式化hadoop\"></a>格式化hadoop</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell bin/hadoop namenode -format</span><br></pre></td></tr></table></figure>\n<p><img src=\"003vMReezy6P1LyH3gqae&amp;690.jpg\" alt=\"格式化hadoop\"><br>格式化成功</p>\n<h2 id=\"同步节点\"><a href=\"#同步节点\" class=\"headerlink\" title=\"同步节点\"></a>同步节点</h2><p>将hadoop分别复制到其他节点的相同目录下（例如Master节点hadoop目录是/home/hadoop/hadoop-2.6.0其他节点也是这个目录）<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell scp -r hadoop-2.6.0 hadoop@192.168.131.128:/home/hadoop/</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"启动hadoop\"><a href=\"#启动hadoop\" class=\"headerlink\" title=\"启动hadoop\"></a>启动hadoop</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell sbin/start-all.sh</span><br></pre></td></tr></table></figure>\n<p>通过<a href=\"http://192.168.131.129:50070查看hadoop相关信息\">http://192.168.131.129:50070查看hadoop相关信息</a><br><img src=\"003vMReezy6P1MlAy3H5d&amp;690.jpg\" alt=\"启动成功\"><br>如果没有启动成功或者live noades为0查看hadoop启动日志就能很快解决问题<br><img src=\"003vMReezy6P1Mzjamje7&amp;690.jpg\" alt=\"启动失败\"></p>\n<p>查看日志看到如异常（日志文件在 hadoop logs目录下）<br><img src=\"003vMReezy6P1O1zJBg32&amp;690.jpg\" alt=\"查看日志\"><br>这个问题主要是因为Master节点clusterID 和Slave节点clusterID 号不一致导致解决办法就是删除在core-site.xml中配置的hadoop.tmp.dir 的/home/hadoop/tmp目录下所有文件重新启动就ok了</p>"},{"title":"Linux常见问题解决方法","date":"2016-05-10T12:05:33.000Z","comments":1,"_content":"\n### 使用SSH登陆Linux的时候提示\n 1. 问题描述\n```shell\nThe host '192.168.1.240' is unreachable.\nthe host may be down,or there may be a problem with the network connection.Sometimes such problems can also be caused by a misconfigured firewall\n```\n**解决办法**\n<!-- more -->\n 1. 关闭防火墙\n```shell\nservice iptables stop(重启生效)\niptables -F(立即生效)\n```\n***如果通过上面的方法还是无法连接那就是sshd服务没有启动***\n\n 2. 启动服务就可以正常访问。\n```shell\n service sshd start\n```\n\n\n----------\n### connect network is unreachable\n原因是没有正确设置IP地址\n**解决办法**\n 1. 修改ifcfg-eth0\n```shell\nvi /etc/sysconfig/network-scripts/ifcfg-eth0\n\nservice network restart\nroute add default  gw 192.168.1.1(设置网关)\nservice network restart\n```\n----------\n\n### linux从一台主机复杂文件目录到另一台\n\n 1. 复制文件\n```shell\nscp conf.xml root@192.168.1.240:/usr/conf\n\n说明：scp 文件名 用户名@计算机IP或者计算机名称 :远程路径\n```\n\n 2. 复制目录\n```shell\nscp -r apache-tomcat-6.0.41 root@192.168.1.240:/usr/tomcat\n\n说明：scp -r 目录名 用户名@计算机IP或者计算机名称 :远程路径\n```\n\n\n----------\n### make：cc：命令未找到\n**解决办法**\n 1. 安装gcc\n```shell\nyum -y install gcc automake autoconf libtool make\n```\n\n\n----------\n\n### /bin/sh:ctags:command not found\n**解决办法**\n 1. 安装ctags\n```shell\nyum install ctags\n```\n\n\n\n\n","source":"_posts/Linux常见问题解决方法.md","raw":"---\ntitle: Linux常见问题解决方法\ndate: 2016-05-10 20:05:33 \ncomments: true \ncategories: Linux\n---\n\n### 使用SSH登陆Linux的时候提示\n 1. 问题描述\n```shell\nThe host '192.168.1.240' is unreachable.\nthe host may be down,or there may be a problem with the network connection.Sometimes such problems can also be caused by a misconfigured firewall\n```\n**解决办法**\n<!-- more -->\n 1. 关闭防火墙\n```shell\nservice iptables stop(重启生效)\niptables -F(立即生效)\n```\n***如果通过上面的方法还是无法连接那就是sshd服务没有启动***\n\n 2. 启动服务就可以正常访问。\n```shell\n service sshd start\n```\n\n\n----------\n### connect network is unreachable\n原因是没有正确设置IP地址\n**解决办法**\n 1. 修改ifcfg-eth0\n```shell\nvi /etc/sysconfig/network-scripts/ifcfg-eth0\n\nservice network restart\nroute add default  gw 192.168.1.1(设置网关)\nservice network restart\n```\n----------\n\n### linux从一台主机复杂文件目录到另一台\n\n 1. 复制文件\n```shell\nscp conf.xml root@192.168.1.240:/usr/conf\n\n说明：scp 文件名 用户名@计算机IP或者计算机名称 :远程路径\n```\n\n 2. 复制目录\n```shell\nscp -r apache-tomcat-6.0.41 root@192.168.1.240:/usr/tomcat\n\n说明：scp -r 目录名 用户名@计算机IP或者计算机名称 :远程路径\n```\n\n\n----------\n### make：cc：命令未找到\n**解决办法**\n 1. 安装gcc\n```shell\nyum -y install gcc automake autoconf libtool make\n```\n\n\n----------\n\n### /bin/sh:ctags:command not found\n**解决办法**\n 1. 安装ctags\n```shell\nyum install ctags\n```\n\n\n\n\n","slug":"Linux常见问题解决方法","published":1,"updated":"2016-05-11T11:54:03.519Z","layout":"post","photos":[],"link":"","_id":"cio5q2liv00037oyb1pgvab2o","content":"<h3 id=\"使用SSH登陆Linux的时候提示\"><a href=\"#使用SSH登陆Linux的时候提示\" class=\"headerlink\" title=\"使用SSH登陆Linux的时候提示\"></a>使用SSH登陆Linux的时候提示</h3><ol>\n<li>问题描述<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">The host &apos;192.168.1.240&apos; is unreachable.</span><br><span class=\"line\">the host may be down,or there may be a problem with the network connection.Sometimes such problems can also be caused by a misconfigured firewall</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<p><strong>解决办法</strong><br><a id=\"more\"></a></p>\n<ol>\n<li>关闭防火墙<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">service iptables stop(重启生效)</span><br><span class=\"line\">iptables -F(立即生效)</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<p><strong><em>如果通过上面的方法还是无法连接那就是sshd服务没有启动</em></strong></p>\n<ol>\n<li>启动服务就可以正常访问。<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">service sshd start</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<hr>\n<h3 id=\"connect-network-is-unreachable\"><a href=\"#connect-network-is-unreachable\" class=\"headerlink\" title=\"connect network is unreachable\"></a>connect network is unreachable</h3><p>原因是没有正确设置IP地址<br><strong>解决办法</strong></p>\n<ol>\n<li>修改ifcfg-eth0<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi /etc/sysconfig/network-scripts/ifcfg-eth0</span><br><span class=\"line\"></span><br><span class=\"line\">service network restart</span><br><span class=\"line\">route add default  gw 192.168.1.1(设置网关)</span><br><span class=\"line\">service network restart</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<hr>\n<h3 id=\"linux从一台主机复杂文件目录到另一台\"><a href=\"#linux从一台主机复杂文件目录到另一台\" class=\"headerlink\" title=\"linux从一台主机复杂文件目录到另一台\"></a>linux从一台主机复杂文件目录到另一台</h3><ol>\n<li><p>复制文件</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scp conf.xml root@192.168.1.240:/usr/conf</span><br><span class=\"line\"></span><br><span class=\"line\">说明：scp 文件名 用户名@计算机IP或者计算机名称 :远程路径</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>复制目录</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scp -r apache-tomcat-6.0.41 root@192.168.1.240:/usr/tomcat</span><br><span class=\"line\"></span><br><span class=\"line\">说明：scp -r 目录名 用户名@计算机IP或者计算机名称 :远程路径</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<hr>\n<h3 id=\"make：cc：命令未找到\"><a href=\"#make：cc：命令未找到\" class=\"headerlink\" title=\"make：cc：命令未找到\"></a>make：cc：命令未找到</h3><p><strong>解决办法</strong></p>\n<ol>\n<li>安装gcc<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum -y install gcc automake autoconf libtool make</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<hr>\n<h3 id=\"bin-sh-ctags-command-not-found\"><a href=\"#bin-sh-ctags-command-not-found\" class=\"headerlink\" title=\"/bin/sh:ctags:command not found\"></a>/bin/sh:ctags:command not found</h3><p><strong>解决办法</strong></p>\n<ol>\n<li>安装ctags<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install ctags</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n","excerpt":"<h3 id=\"使用SSH登陆Linux的时候提示\"><a href=\"#使用SSH登陆Linux的时候提示\" class=\"headerlink\" title=\"使用SSH登陆Linux的时候提示\"></a>使用SSH登陆Linux的时候提示</h3><ol>\n<li>问题描述<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">The host &apos;192.168.1.240&apos; is unreachable.</span><br><span class=\"line\">the host may be down,or there may be a problem with the network connection.Sometimes such problems can also be caused by a misconfigured firewall</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<p><strong>解决办法</strong><br>","more":"</p>\n<ol>\n<li>关闭防火墙<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">service iptables stop(重启生效)</span><br><span class=\"line\">iptables -F(立即生效)</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<p><strong><em>如果通过上面的方法还是无法连接那就是sshd服务没有启动</em></strong></p>\n<ol>\n<li>启动服务就可以正常访问。<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">service sshd start</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<hr>\n<h3 id=\"connect-network-is-unreachable\"><a href=\"#connect-network-is-unreachable\" class=\"headerlink\" title=\"connect network is unreachable\"></a>connect network is unreachable</h3><p>原因是没有正确设置IP地址<br><strong>解决办法</strong></p>\n<ol>\n<li>修改ifcfg-eth0<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi /etc/sysconfig/network-scripts/ifcfg-eth0</span><br><span class=\"line\"></span><br><span class=\"line\">service network restart</span><br><span class=\"line\">route add default  gw 192.168.1.1(设置网关)</span><br><span class=\"line\">service network restart</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<hr>\n<h3 id=\"linux从一台主机复杂文件目录到另一台\"><a href=\"#linux从一台主机复杂文件目录到另一台\" class=\"headerlink\" title=\"linux从一台主机复杂文件目录到另一台\"></a>linux从一台主机复杂文件目录到另一台</h3><ol>\n<li><p>复制文件</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scp conf.xml root@192.168.1.240:/usr/conf</span><br><span class=\"line\"></span><br><span class=\"line\">说明：scp 文件名 用户名@计算机IP或者计算机名称 :远程路径</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>复制目录</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scp -r apache-tomcat-6.0.41 root@192.168.1.240:/usr/tomcat</span><br><span class=\"line\"></span><br><span class=\"line\">说明：scp -r 目录名 用户名@计算机IP或者计算机名称 :远程路径</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<hr>\n<h3 id=\"make：cc：命令未找到\"><a href=\"#make：cc：命令未找到\" class=\"headerlink\" title=\"make：cc：命令未找到\"></a>make：cc：命令未找到</h3><p><strong>解决办法</strong></p>\n<ol>\n<li>安装gcc<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum -y install gcc automake autoconf libtool make</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<hr>\n<h3 id=\"bin-sh-ctags-command-not-found\"><a href=\"#bin-sh-ctags-command-not-found\" class=\"headerlink\" title=\"/bin/sh:ctags:command not found\"></a>/bin/sh:ctags:command not found</h3><p><strong>解决办法</strong></p>\n<ol>\n<li>安装ctags<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install ctags</span><br></pre></td></tr></table></figure>\n</li>\n</ol>"},{"title":"Java设计模式之观察者模式","date":"2015-01-05T06:43:27.000Z","comments":1,"toc":true,"_content":"\n观察者模式定义了一个一对多的依赖关系，让一个或多个观察者对象监察一个主题对象。这样一个主题对象在状态上的变化能够通知所有的依赖于此对象的那些观察者对象，使这些观察者对象能够自动更新。\n观察者（Observer）模式是对象的行为型模式，又叫做发表-订阅（Publish/Subscribe）模式、模型-视图（Model/View）模式、源-收听者（Source/Listener）模式或从属者（Dependents）模式。\n\t  \n<!-- more --> \n### 类图结构\n![类图结构](class.jpg)\n\n### 抽象主题\n主题把所有的观察者对象引用保存到一个集合中，每个主题都可以有任何数量的观察者。主题提供一个增加、销毁观察者和通知所有观察者的方法。\n\n![抽象主题](003vMReezy6OWsKgs3pa3&690.jpg)\n\n### 抽象观察者\n为所有具体的观察者定义一个接口，再得到通知更新自己。\n\n![抽象观察者](003vMReezy6OWsC8Oogc8&690.jpg)\n\n### 具体主题\n保存对具体观察者对象有用的内部状态；在这种内部状态改变时给其观察者发出一个通知；具体主题角色又叫作具体被观察者角色；\n\n### 具体观察者\n保存一个指向具体主题对象的引用；和一个与主题的状态相符的状态。具体观察者角色实现抽象观察者角色所要求的更新自己的接口，以便使本身的状态与主题的状态同步。\n\n\n下面就使用java.util.Observable 和java.util.Observer 实现观察者模式\n\n***代码清单一：具体主题***\n```java\npackage com.design.mode;\n\nimport java.util.Observable;\npublic class Subject extends Observable{\n  private String str;\n  public void add(String str){\n\tthis.str = str;\n\t//设置change=true\n\tsetChanged();\n\t//通知所有观察者主题有改变\n\tnotifyObservers(str);\n\t//notifyObservers();\n  }\n}\n```\n\n***代码清单二：具体观察者***\n```java\npackage com.design.mode;\nimport java.util.Observable;\nimport java.util.Observer;\npublic class SubjectObserver extends Observer{\n  public SubjectObserver(Observable 0){\n\to.addObserver(this);\n  }\n\t\n  public void update(Observable o,Object arg){\n\tSystem.out.println(arg);\n  }\n}\n```\n\n***代码清单三：测试***\n```java\npackage com.design.mode;\n\npublic class Test{\n  public static void main(String[] args){\n\t//实例化主题\n\tSubject sb = new Subject();\n\t//实例化观察者\n\tSubjectObserver so = new SubjectObserver(sb);\n\tsb.add(\"hello world\");\n  }\n}\n```\n***控制台输出***\n```\nhello world\n```\n\n### 总结\n观察者设计模式降低了系统的耦合度被观察者角色所知道的只是一个具体观察者列表，每一个具体观察者都符合一个抽象观察者的接口。被观察者并不认识任何一个具体观察者，它只知道它们都有一个共同的接口。\n由于被观察者和观察者没有紧密地耦合在一起，因此它们可以属于不同的抽象化层次。如果被观察者和观察者都被扔到一起，那么这个对象必然跨越抽象化和具体化层次。\n\n\n\n","source":"_posts/Java设计模式之观察者模式.md","raw":"---\ntitle: Java设计模式之观察者模式\ndate: 2015-01-05 14:43:27 \ncomments: true \ncategories: Java\ntoc: true\n---\n\n观察者模式定义了一个一对多的依赖关系，让一个或多个观察者对象监察一个主题对象。这样一个主题对象在状态上的变化能够通知所有的依赖于此对象的那些观察者对象，使这些观察者对象能够自动更新。\n观察者（Observer）模式是对象的行为型模式，又叫做发表-订阅（Publish/Subscribe）模式、模型-视图（Model/View）模式、源-收听者（Source/Listener）模式或从属者（Dependents）模式。\n\t  \n<!-- more --> \n### 类图结构\n![类图结构](class.jpg)\n\n### 抽象主题\n主题把所有的观察者对象引用保存到一个集合中，每个主题都可以有任何数量的观察者。主题提供一个增加、销毁观察者和通知所有观察者的方法。\n\n![抽象主题](003vMReezy6OWsKgs3pa3&690.jpg)\n\n### 抽象观察者\n为所有具体的观察者定义一个接口，再得到通知更新自己。\n\n![抽象观察者](003vMReezy6OWsC8Oogc8&690.jpg)\n\n### 具体主题\n保存对具体观察者对象有用的内部状态；在这种内部状态改变时给其观察者发出一个通知；具体主题角色又叫作具体被观察者角色；\n\n### 具体观察者\n保存一个指向具体主题对象的引用；和一个与主题的状态相符的状态。具体观察者角色实现抽象观察者角色所要求的更新自己的接口，以便使本身的状态与主题的状态同步。\n\n\n下面就使用java.util.Observable 和java.util.Observer 实现观察者模式\n\n***代码清单一：具体主题***\n```java\npackage com.design.mode;\n\nimport java.util.Observable;\npublic class Subject extends Observable{\n  private String str;\n  public void add(String str){\n\tthis.str = str;\n\t//设置change=true\n\tsetChanged();\n\t//通知所有观察者主题有改变\n\tnotifyObservers(str);\n\t//notifyObservers();\n  }\n}\n```\n\n***代码清单二：具体观察者***\n```java\npackage com.design.mode;\nimport java.util.Observable;\nimport java.util.Observer;\npublic class SubjectObserver extends Observer{\n  public SubjectObserver(Observable 0){\n\to.addObserver(this);\n  }\n\t\n  public void update(Observable o,Object arg){\n\tSystem.out.println(arg);\n  }\n}\n```\n\n***代码清单三：测试***\n```java\npackage com.design.mode;\n\npublic class Test{\n  public static void main(String[] args){\n\t//实例化主题\n\tSubject sb = new Subject();\n\t//实例化观察者\n\tSubjectObserver so = new SubjectObserver(sb);\n\tsb.add(\"hello world\");\n  }\n}\n```\n***控制台输出***\n```\nhello world\n```\n\n### 总结\n观察者设计模式降低了系统的耦合度被观察者角色所知道的只是一个具体观察者列表，每一个具体观察者都符合一个抽象观察者的接口。被观察者并不认识任何一个具体观察者，它只知道它们都有一个共同的接口。\n由于被观察者和观察者没有紧密地耦合在一起，因此它们可以属于不同的抽象化层次。如果被观察者和观察者都被扔到一起，那么这个对象必然跨越抽象化和具体化层次。\n\n\n\n","slug":"Java设计模式之观察者模式","published":1,"updated":"2016-05-11T12:40:50.499Z","layout":"post","photos":[],"link":"","_id":"cio5q2liv00047oybaem3lmaf","content":"<p>观察者模式定义了一个一对多的依赖关系，让一个或多个观察者对象监察一个主题对象。这样一个主题对象在状态上的变化能够通知所有的依赖于此对象的那些观察者对象，使这些观察者对象能够自动更新。<br>观察者（Observer）模式是对象的行为型模式，又叫做发表-订阅（Publish/Subscribe）模式、模型-视图（Model/View）模式、源-收听者（Source/Listener）模式或从属者（Dependents）模式。</p>\n<a id=\"more\"></a> \n<h3 id=\"类图结构\"><a href=\"#类图结构\" class=\"headerlink\" title=\"类图结构\"></a>类图结构</h3><p><img src=\"class.jpg\" alt=\"类图结构\"></p>\n<h3 id=\"抽象主题\"><a href=\"#抽象主题\" class=\"headerlink\" title=\"抽象主题\"></a>抽象主题</h3><p>主题把所有的观察者对象引用保存到一个集合中，每个主题都可以有任何数量的观察者。主题提供一个增加、销毁观察者和通知所有观察者的方法。</p>\n<p><img src=\"003vMReezy6OWsKgs3pa3&amp;690.jpg\" alt=\"抽象主题\"></p>\n<h3 id=\"抽象观察者\"><a href=\"#抽象观察者\" class=\"headerlink\" title=\"抽象观察者\"></a>抽象观察者</h3><p>为所有具体的观察者定义一个接口，再得到通知更新自己。</p>\n<p><img src=\"003vMReezy6OWsC8Oogc8&amp;690.jpg\" alt=\"抽象观察者\"></p>\n<h3 id=\"具体主题\"><a href=\"#具体主题\" class=\"headerlink\" title=\"具体主题\"></a>具体主题</h3><p>保存对具体观察者对象有用的内部状态；在这种内部状态改变时给其观察者发出一个通知；具体主题角色又叫作具体被观察者角色；</p>\n<h3 id=\"具体观察者\"><a href=\"#具体观察者\" class=\"headerlink\" title=\"具体观察者\"></a>具体观察者</h3><p>保存一个指向具体主题对象的引用；和一个与主题的状态相符的状态。具体观察者角色实现抽象观察者角色所要求的更新自己的接口，以便使本身的状态与主题的状态同步。</p>\n<p>下面就使用java.util.Observable 和java.util.Observer 实现观察者模式</p>\n<p><strong><em>代码清单一：具体主题</em></strong><br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.design.mode;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Observable;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Subject</span> <span class=\"keyword\">extends</span> <span class=\"title\">Observable</span></span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> String str;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(String str)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">this</span>.str = str;</span><br><span class=\"line\">\t<span class=\"comment\">//设置change=true</span></span><br><span class=\"line\">\tsetChanged();</span><br><span class=\"line\">\t<span class=\"comment\">//通知所有观察者主题有改变</span></span><br><span class=\"line\">\tnotifyObservers(str);</span><br><span class=\"line\">\t<span class=\"comment\">//notifyObservers();</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><strong><em>代码清单二：具体观察者</em></strong><br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.design.mode;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Observable;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Observer;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SubjectObserver</span> <span class=\"keyword\">extends</span> <span class=\"title\">Observer</span></span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">SubjectObserver</span><span class=\"params\">(Observable <span class=\"number\">0</span>)</span></span>&#123;</span><br><span class=\"line\">\to.addObserver(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(Observable o,Object arg)</span></span>&#123;</span><br><span class=\"line\">\tSystem.out.println(arg);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><strong><em>代码清单三：测试</em></strong><br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.design.mode;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span></span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">//实例化主题</span></span><br><span class=\"line\">\tSubject sb = <span class=\"keyword\">new</span> Subject();</span><br><span class=\"line\">\t<span class=\"comment\">//实例化观察者</span></span><br><span class=\"line\">\tSubjectObserver so = <span class=\"keyword\">new</span> SubjectObserver(sb);</span><br><span class=\"line\">\tsb.add(<span class=\"string\">\"hello world\"</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><strong><em>控制台输出</em></strong><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hello world</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h3><p>观察者设计模式降低了系统的耦合度被观察者角色所知道的只是一个具体观察者列表，每一个具体观察者都符合一个抽象观察者的接口。被观察者并不认识任何一个具体观察者，它只知道它们都有一个共同的接口。<br>由于被观察者和观察者没有紧密地耦合在一起，因此它们可以属于不同的抽象化层次。如果被观察者和观察者都被扔到一起，那么这个对象必然跨越抽象化和具体化层次。</p>\n","excerpt":"<p>观察者模式定义了一个一对多的依赖关系，让一个或多个观察者对象监察一个主题对象。这样一个主题对象在状态上的变化能够通知所有的依赖于此对象的那些观察者对象，使这些观察者对象能够自动更新。<br>观察者（Observer）模式是对象的行为型模式，又叫做发表-订阅（Publish/Subscribe）模式、模型-视图（Model/View）模式、源-收听者（Source/Listener）模式或从属者（Dependents）模式。</p>","more":"<h3 id=\"类图结构\"><a href=\"#类图结构\" class=\"headerlink\" title=\"类图结构\"></a>类图结构</h3><p><img src=\"class.jpg\" alt=\"类图结构\"></p>\n<h3 id=\"抽象主题\"><a href=\"#抽象主题\" class=\"headerlink\" title=\"抽象主题\"></a>抽象主题</h3><p>主题把所有的观察者对象引用保存到一个集合中，每个主题都可以有任何数量的观察者。主题提供一个增加、销毁观察者和通知所有观察者的方法。</p>\n<p><img src=\"003vMReezy6OWsKgs3pa3&amp;690.jpg\" alt=\"抽象主题\"></p>\n<h3 id=\"抽象观察者\"><a href=\"#抽象观察者\" class=\"headerlink\" title=\"抽象观察者\"></a>抽象观察者</h3><p>为所有具体的观察者定义一个接口，再得到通知更新自己。</p>\n<p><img src=\"003vMReezy6OWsC8Oogc8&amp;690.jpg\" alt=\"抽象观察者\"></p>\n<h3 id=\"具体主题\"><a href=\"#具体主题\" class=\"headerlink\" title=\"具体主题\"></a>具体主题</h3><p>保存对具体观察者对象有用的内部状态；在这种内部状态改变时给其观察者发出一个通知；具体主题角色又叫作具体被观察者角色；</p>\n<h3 id=\"具体观察者\"><a href=\"#具体观察者\" class=\"headerlink\" title=\"具体观察者\"></a>具体观察者</h3><p>保存一个指向具体主题对象的引用；和一个与主题的状态相符的状态。具体观察者角色实现抽象观察者角色所要求的更新自己的接口，以便使本身的状态与主题的状态同步。</p>\n<p>下面就使用java.util.Observable 和java.util.Observer 实现观察者模式</p>\n<p><strong><em>代码清单一：具体主题</em></strong><br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.design.mode;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Observable;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Subject</span> <span class=\"keyword\">extends</span> <span class=\"title\">Observable</span></span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> String str;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(String str)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">this</span>.str = str;</span><br><span class=\"line\">\t<span class=\"comment\">//设置change=true</span></span><br><span class=\"line\">\tsetChanged();</span><br><span class=\"line\">\t<span class=\"comment\">//通知所有观察者主题有改变</span></span><br><span class=\"line\">\tnotifyObservers(str);</span><br><span class=\"line\">\t<span class=\"comment\">//notifyObservers();</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><strong><em>代码清单二：具体观察者</em></strong><br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.design.mode;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Observable;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Observer;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SubjectObserver</span> <span class=\"keyword\">extends</span> <span class=\"title\">Observer</span></span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">SubjectObserver</span><span class=\"params\">(Observable <span class=\"number\">0</span>)</span></span>&#123;</span><br><span class=\"line\">\to.addObserver(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(Observable o,Object arg)</span></span>&#123;</span><br><span class=\"line\">\tSystem.out.println(arg);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><strong><em>代码清单三：测试</em></strong><br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.design.mode;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span></span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">//实例化主题</span></span><br><span class=\"line\">\tSubject sb = <span class=\"keyword\">new</span> Subject();</span><br><span class=\"line\">\t<span class=\"comment\">//实例化观察者</span></span><br><span class=\"line\">\tSubjectObserver so = <span class=\"keyword\">new</span> SubjectObserver(sb);</span><br><span class=\"line\">\tsb.add(<span class=\"string\">\"hello world\"</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><strong><em>控制台输出</em></strong><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hello world</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h3><p>观察者设计模式降低了系统的耦合度被观察者角色所知道的只是一个具体观察者列表，每一个具体观察者都符合一个抽象观察者的接口。被观察者并不认识任何一个具体观察者，它只知道它们都有一个共同的接口。<br>由于被观察者和观察者没有紧密地耦合在一起，因此它们可以属于不同的抽象化层次。如果被观察者和观察者都被扔到一起，那么这个对象必然跨越抽象化和具体化层次。</p>"},{"title":"System.setOut","date":"2016-05-10T12:10:33.000Z","comments":1,"_content":"   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;今天一同事问我System.out.println()输出的内容为什么没有输出到日志文件中。他告诉我的是他使用的weblogic中间件。说起这个真的平时没太注意。因为我之前一直使用的是jboss，查看日志也是看的jboss日志文件，通过System.out.println输出的内容也显示在了日志文件中。带着好奇心去看了下自己系统下的日志文件果然没有。于是打开jboss的log4j.xml 与自己系统下的log4j.xml进行了一下对比发现并无不同。于是打开jboss代码看了下发现jboss org.jboss.logging.Log4jService  installSystemAdapters方法中对System.setOut 有设置。\n   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;表示对于System.setOut不懂到网上百度了下，官方说明是通过System.setOut方法允许程序员自行定义System.out输出流， 我们可以将我们改造好的PrintStream替换java原来的System.out对象。于是他这个问题就很好解决了。\n<!-- more --> \n```java\npublic void init() {\n  PrintStream printStream = new PrintStream(System.out) {\n   public void println(boolean x) {\n    log(Boolean.valueOf(x));\n   }\n\n   public void println(char x) {\n    log(Character.valueOf(x));\n   }\n\n   public void println(char[] x) {\n    log(x == null ? null : new String(x));\n   }\n\n   public void println(double x) {\n    log(Double.valueOf(x));\n   }\n\n   public void println(float x) {\n    log(Float.valueOf(x));\n   }\n\n   public void println(int x) {\n    log(Integer.valueOf(x));\n   }\n\n   public void println(long x) {\n    log(x);\n   }\n\n   public void println(Object x) {\n    log(x);\n   }\n\n   public void println(String x) {\n    log(x);\n   }\n  };\n  System.setOut(printStream);\n  System.setErr(printStream);\n\n }\n\n private void log(Object info) {\n  LogFactoryImpl.getLog(getClass()).info(info);\n }\n```\n\n在web的监听器里面初始下这个就可以了\n\n下面是log4j的配置文件\n\n```\nlog4j.rootLogger=INFO,Stdout,R\nlog4j.appender.Stdout=org.apache.log4j.ConsoleAppender\nlog4j.appender.Stdout.layout=org.apache.log4j.PatternLayout\nlog4j.appender.Stdout.layout.ConversionPattern=%d{yyyy-MM-dd HH:mm:ss} %-5p %m%n\nlog4j.appender.R=org.apache.log4j.DailyRollingFileAppender\nlog4j.appender.R.File=F:/stdout.log\nlog4j.appender.R.datePattern='.'yyyy-MM-dd'.txt'\nlog4j.appender.R.layout=org.apache.log4j.PatternLayout\nlog4j.appender.R.layout.ConversionPattern=%d{yyyy-MM-dd HH:mm:ss} %-5p %m%n\n```\n\n","source":"_posts/System.setOut.md","raw":"---\ntitle: System.setOut\ndate: 2016-05-10 20:10:33 \ncomments: true \ncategories: Java\n---\n   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;今天一同事问我System.out.println()输出的内容为什么没有输出到日志文件中。他告诉我的是他使用的weblogic中间件。说起这个真的平时没太注意。因为我之前一直使用的是jboss，查看日志也是看的jboss日志文件，通过System.out.println输出的内容也显示在了日志文件中。带着好奇心去看了下自己系统下的日志文件果然没有。于是打开jboss的log4j.xml 与自己系统下的log4j.xml进行了一下对比发现并无不同。于是打开jboss代码看了下发现jboss org.jboss.logging.Log4jService  installSystemAdapters方法中对System.setOut 有设置。\n   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;表示对于System.setOut不懂到网上百度了下，官方说明是通过System.setOut方法允许程序员自行定义System.out输出流， 我们可以将我们改造好的PrintStream替换java原来的System.out对象。于是他这个问题就很好解决了。\n<!-- more --> \n```java\npublic void init() {\n  PrintStream printStream = new PrintStream(System.out) {\n   public void println(boolean x) {\n    log(Boolean.valueOf(x));\n   }\n\n   public void println(char x) {\n    log(Character.valueOf(x));\n   }\n\n   public void println(char[] x) {\n    log(x == null ? null : new String(x));\n   }\n\n   public void println(double x) {\n    log(Double.valueOf(x));\n   }\n\n   public void println(float x) {\n    log(Float.valueOf(x));\n   }\n\n   public void println(int x) {\n    log(Integer.valueOf(x));\n   }\n\n   public void println(long x) {\n    log(x);\n   }\n\n   public void println(Object x) {\n    log(x);\n   }\n\n   public void println(String x) {\n    log(x);\n   }\n  };\n  System.setOut(printStream);\n  System.setErr(printStream);\n\n }\n\n private void log(Object info) {\n  LogFactoryImpl.getLog(getClass()).info(info);\n }\n```\n\n在web的监听器里面初始下这个就可以了\n\n下面是log4j的配置文件\n\n```\nlog4j.rootLogger=INFO,Stdout,R\nlog4j.appender.Stdout=org.apache.log4j.ConsoleAppender\nlog4j.appender.Stdout.layout=org.apache.log4j.PatternLayout\nlog4j.appender.Stdout.layout.ConversionPattern=%d{yyyy-MM-dd HH:mm:ss} %-5p %m%n\nlog4j.appender.R=org.apache.log4j.DailyRollingFileAppender\nlog4j.appender.R.File=F:/stdout.log\nlog4j.appender.R.datePattern='.'yyyy-MM-dd'.txt'\nlog4j.appender.R.layout=org.apache.log4j.PatternLayout\nlog4j.appender.R.layout.ConversionPattern=%d{yyyy-MM-dd HH:mm:ss} %-5p %m%n\n```\n\n","slug":"System.setOut","published":1,"updated":"2016-05-11T11:54:03.519Z","layout":"post","photos":[],"link":"","_id":"cio5q2liv00057oybjke4iqzy","content":"<p>   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;今天一同事问我System.out.println()输出的内容为什么没有输出到日志文件中。他告诉我的是他使用的weblogic中间件。说起这个真的平时没太注意。因为我之前一直使用的是jboss，查看日志也是看的jboss日志文件，通过System.out.println输出的内容也显示在了日志文件中。带着好奇心去看了下自己系统下的日志文件果然没有。于是打开jboss的log4j.xml 与自己系统下的log4j.xml进行了一下对比发现并无不同。于是打开jboss代码看了下发现jboss org.jboss.logging.Log4jService  installSystemAdapters方法中对System.setOut 有设置。<br>   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;表示对于System.setOut不懂到网上百度了下，官方说明是通过System.setOut方法允许程序员自行定义System.out输出流， 我们可以将我们改造好的PrintStream替换java原来的System.out对象。于是他这个问题就很好解决了。<br><a id=\"more\"></a><br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  PrintStream printStream = <span class=\"keyword\">new</span> PrintStream(System.out) &#123;</span><br><span class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">println</span><span class=\"params\">(<span class=\"keyword\">boolean</span> x)</span> </span>&#123;</span><br><span class=\"line\">    log(Boolean.valueOf(x));</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">println</span><span class=\"params\">(<span class=\"keyword\">char</span> x)</span> </span>&#123;</span><br><span class=\"line\">    log(Character.valueOf(x));</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">println</span><span class=\"params\">(<span class=\"keyword\">char</span>[] x)</span> </span>&#123;</span><br><span class=\"line\">    log(x == <span class=\"keyword\">null</span> ? <span class=\"keyword\">null</span> : <span class=\"keyword\">new</span> String(x));</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">println</span><span class=\"params\">(<span class=\"keyword\">double</span> x)</span> </span>&#123;</span><br><span class=\"line\">    log(Double.valueOf(x));</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">println</span><span class=\"params\">(<span class=\"keyword\">float</span> x)</span> </span>&#123;</span><br><span class=\"line\">    log(Float.valueOf(x));</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">println</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    log(Integer.valueOf(x));</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">println</span><span class=\"params\">(<span class=\"keyword\">long</span> x)</span> </span>&#123;</span><br><span class=\"line\">    log(x);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">println</span><span class=\"params\">(Object x)</span> </span>&#123;</span><br><span class=\"line\">    log(x);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">println</span><span class=\"params\">(String x)</span> </span>&#123;</span><br><span class=\"line\">    log(x);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">  System.setOut(printStream);</span><br><span class=\"line\">  System.setErr(printStream);</span><br><span class=\"line\"></span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">log</span><span class=\"params\">(Object info)</span> </span>&#123;</span><br><span class=\"line\">  LogFactoryImpl.getLog(getClass()).info(info);</span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure></p>\n<p>在web的监听器里面初始下这个就可以了</p>\n<p>下面是log4j的配置文件</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">log4j.rootLogger=INFO,Stdout,R</span><br><span class=\"line\">log4j.appender.Stdout=org.apache.log4j.ConsoleAppender</span><br><span class=\"line\">log4j.appender.Stdout.layout=org.apache.log4j.PatternLayout</span><br><span class=\"line\">log4j.appender.Stdout.layout.ConversionPattern=%d&#123;yyyy-MM-dd HH:mm:ss&#125; %-5p %m%n</span><br><span class=\"line\">log4j.appender.R=org.apache.log4j.DailyRollingFileAppender</span><br><span class=\"line\">log4j.appender.R.File=F:/stdout.log</span><br><span class=\"line\">log4j.appender.R.datePattern=&apos;.&apos;yyyy-MM-dd&apos;.txt&apos;</span><br><span class=\"line\">log4j.appender.R.layout=org.apache.log4j.PatternLayout</span><br><span class=\"line\">log4j.appender.R.layout.ConversionPattern=%d&#123;yyyy-MM-dd HH:mm:ss&#125; %-5p %m%n</span><br></pre></td></tr></table></figure>\n","excerpt":"<p>   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;今天一同事问我System.out.println()输出的内容为什么没有输出到日志文件中。他告诉我的是他使用的weblogic中间件。说起这个真的平时没太注意。因为我之前一直使用的是jboss，查看日志也是看的jboss日志文件，通过System.out.println输出的内容也显示在了日志文件中。带着好奇心去看了下自己系统下的日志文件果然没有。于是打开jboss的log4j.xml 与自己系统下的log4j.xml进行了一下对比发现并无不同。于是打开jboss代码看了下发现jboss org.jboss.logging.Log4jService  installSystemAdapters方法中对System.setOut 有设置。<br>   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;表示对于System.setOut不懂到网上百度了下，官方说明是通过System.setOut方法允许程序员自行定义System.out输出流， 我们可以将我们改造好的PrintStream替换java原来的System.out对象。于是他这个问题就很好解决了。<br>","more":"<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  PrintStream printStream = <span class=\"keyword\">new</span> PrintStream(System.out) &#123;</span><br><span class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">println</span><span class=\"params\">(<span class=\"keyword\">boolean</span> x)</span> </span>&#123;</span><br><span class=\"line\">    log(Boolean.valueOf(x));</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">println</span><span class=\"params\">(<span class=\"keyword\">char</span> x)</span> </span>&#123;</span><br><span class=\"line\">    log(Character.valueOf(x));</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">println</span><span class=\"params\">(<span class=\"keyword\">char</span>[] x)</span> </span>&#123;</span><br><span class=\"line\">    log(x == <span class=\"keyword\">null</span> ? <span class=\"keyword\">null</span> : <span class=\"keyword\">new</span> String(x));</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">println</span><span class=\"params\">(<span class=\"keyword\">double</span> x)</span> </span>&#123;</span><br><span class=\"line\">    log(Double.valueOf(x));</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">println</span><span class=\"params\">(<span class=\"keyword\">float</span> x)</span> </span>&#123;</span><br><span class=\"line\">    log(Float.valueOf(x));</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">println</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    log(Integer.valueOf(x));</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">println</span><span class=\"params\">(<span class=\"keyword\">long</span> x)</span> </span>&#123;</span><br><span class=\"line\">    log(x);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">println</span><span class=\"params\">(Object x)</span> </span>&#123;</span><br><span class=\"line\">    log(x);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">println</span><span class=\"params\">(String x)</span> </span>&#123;</span><br><span class=\"line\">    log(x);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">  System.setOut(printStream);</span><br><span class=\"line\">  System.setErr(printStream);</span><br><span class=\"line\"></span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">log</span><span class=\"params\">(Object info)</span> </span>&#123;</span><br><span class=\"line\">  LogFactoryImpl.getLog(getClass()).info(info);</span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure></p>\n<p>在web的监听器里面初始下这个就可以了</p>\n<p>下面是log4j的配置文件</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">log4j.rootLogger=INFO,Stdout,R</span><br><span class=\"line\">log4j.appender.Stdout=org.apache.log4j.ConsoleAppender</span><br><span class=\"line\">log4j.appender.Stdout.layout=org.apache.log4j.PatternLayout</span><br><span class=\"line\">log4j.appender.Stdout.layout.ConversionPattern=%d&#123;yyyy-MM-dd HH:mm:ss&#125; %-5p %m%n</span><br><span class=\"line\">log4j.appender.R=org.apache.log4j.DailyRollingFileAppender</span><br><span class=\"line\">log4j.appender.R.File=F:/stdout.log</span><br><span class=\"line\">log4j.appender.R.datePattern=&apos;.&apos;yyyy-MM-dd&apos;.txt&apos;</span><br><span class=\"line\">log4j.appender.R.layout=org.apache.log4j.PatternLayout</span><br><span class=\"line\">log4j.appender.R.layout.ConversionPattern=%d&#123;yyyy-MM-dd HH:mm:ss&#125; %-5p %m%n</span><br></pre></td></tr></table></figure>"},{"title":"博客搭建","date":"2016-05-10T11:05:33.000Z","comments":0,"_content":"2016年5月10号基于github搭建我的第一个博客\n\n\n个人简历: [关于我](/about/index.html)\n","source":"_posts/博客搭建.md","raw":"---\ntitle: 博客搭建\ndate: 2016-05-10 19:05:33\ncomments: false \n---\n2016年5月10号基于github搭建我的第一个博客\n\n\n个人简历: [关于我](/about/index.html)\n","slug":"博客搭建","published":1,"updated":"2016-05-11T11:54:03.520Z","layout":"post","photos":[],"link":"","_id":"cio5q2liv00077oybmjkvkh69","content":"<p>2016年5月10号基于github搭建我的第一个博客</p>\n<p>个人简历: <a href=\"/about/index.html\">关于我</a></p>\n","excerpt":"","more":"<p>2016年5月10号基于github搭建我的第一个博客</p>\n<p>个人简历: <a href=\"/about/index.html\">关于我</a></p>\n"},{"title":"Nginx+Tomcat+Memcached集群","date":"2015-01-14T08:18:41.000Z","comments":1,"toc":true,"_content":"\n\nNginx和Tomcat的安装和配置在这里就不说了，不明白的可以看文章[Nginx+Tomcat集群](/2014/12/10/Nginx+Tomcat集群/)。这篇文章是以前面[Nginx+Tomcat集群](/2014/12/10/Nginx+Tomcat集群/)的文章为基础。Nginx+Tomcat+Memcached集群其实很简单，就是将session管理交给了Memcached管理，这样的好处不言而喻，就是如果集群中的节点如果很多的话采用Tomcat节点间的session复制来保证session的共享。这样会给系统带来很大一部分开销。所以就讲session交给了Memcached管理。Memcached是个分布式缓存系统，采用c语言实现。今天我们以一个Memcached为例。对Memcached不在进集群了。\n安置Memcached之前需要安装他依赖的软件libevent-devel。\n<!--more-->\n\n## 软件安装\n\n### 安装libevent-devel\n```\nsehll yum install libevent-devel\n```\n\n### 安装memcached\n```\nsehll wget http://memcached.org/files/memcached-1.4.22.tar.gz\nsehll tar -zxvf memcached-1.4.22.tar.gz\nsehll cd memcached-1.4.22\nsehll ./configure && make && make test && make install\n```\n\n### 启动memcached\n```\nshell /usr/local/bin/memcached -d -m 256 -p 11211 -u root -l 192.168.1.233\n```\n启动memcached的参数不明白的地方可以查看网上的说明\n\n### 下载依赖Jar\n***下载memcached session管理的jar包,Tomcat的版本不一样依赖jar包也不一样我这里是以Tomcat6为例并采用javolution方式策略***\n\nmemcached-session-manager-1.8.2.jar\nspymemcached-2.7.3.jar\nmsm-xstream-serializer-1.8.2.jar\nmsm-javolution-serializer-1.8.2.jar\nmsm-flexjson-serializer-1.8.2.jar\nmemcached-session-manager-tc6-1.8.2.jar\njavolution-5.5.1.jar\n\n将以上包复制到%TOMCAT_HOME%\\lib\\下\n## 配置\n修改%TOMCAT_HOME%\\conf\\context.xml在Context节点下添加如下配置\n```xml\n<Manager className=\"de.javakaffee.web.msm.MemcachedBackupSessionManager\"\n\tmemcacheNodes=\"n1:192.168.1.233:11211\"\n\trequestUriIgnorePattern=\".*\\.(png|gif|jpg|css|js)$\"\n\tsessionBackupAsync=\"false\"\n\tsessionBackupTimeout=\"1800000\"\n\tcopyCollectionsForSerialization=\"false\"\n\ttranscoderFactoryClass=\"de.javakaffee.web.msm.serializer.javolution.JavolutionTranscoderFactory\"/>\n```\n要说明的就是memcachedNodes的配置 我上面写的是memcachedNodes=\"n1:192.168.1.233:11211\"\n192.168.1.233为memcached所在主机IP地址11211为端口然后如果有多个memcached的话用逗号隔开例如：\nmemcachedNodes=\"n1:192.168.1.233:11211,n2:192.168.1.234:11211\"\n\n***注意***\n每个节点都需要这么配置而且需要保证一样，让后将我们之前在server.xml中的Tomcat集群session复制配置注释掉。","source":"_posts/Nginx+Tomcat+Memcached集群.md","raw":"---\ntitle: Nginx+Tomcat+Memcached集群\ndate: 2015-01-14 16:18:41\ncomments: true\ncategories: Tomcat\ntoc: true \n---\n\n\nNginx和Tomcat的安装和配置在这里就不说了，不明白的可以看文章[Nginx+Tomcat集群](/2014/12/10/Nginx+Tomcat集群/)。这篇文章是以前面[Nginx+Tomcat集群](/2014/12/10/Nginx+Tomcat集群/)的文章为基础。Nginx+Tomcat+Memcached集群其实很简单，就是将session管理交给了Memcached管理，这样的好处不言而喻，就是如果集群中的节点如果很多的话采用Tomcat节点间的session复制来保证session的共享。这样会给系统带来很大一部分开销。所以就讲session交给了Memcached管理。Memcached是个分布式缓存系统，采用c语言实现。今天我们以一个Memcached为例。对Memcached不在进集群了。\n安置Memcached之前需要安装他依赖的软件libevent-devel。\n<!--more-->\n\n## 软件安装\n\n### 安装libevent-devel\n```\nsehll yum install libevent-devel\n```\n\n### 安装memcached\n```\nsehll wget http://memcached.org/files/memcached-1.4.22.tar.gz\nsehll tar -zxvf memcached-1.4.22.tar.gz\nsehll cd memcached-1.4.22\nsehll ./configure && make && make test && make install\n```\n\n### 启动memcached\n```\nshell /usr/local/bin/memcached -d -m 256 -p 11211 -u root -l 192.168.1.233\n```\n启动memcached的参数不明白的地方可以查看网上的说明\n\n### 下载依赖Jar\n***下载memcached session管理的jar包,Tomcat的版本不一样依赖jar包也不一样我这里是以Tomcat6为例并采用javolution方式策略***\n\nmemcached-session-manager-1.8.2.jar\nspymemcached-2.7.3.jar\nmsm-xstream-serializer-1.8.2.jar\nmsm-javolution-serializer-1.8.2.jar\nmsm-flexjson-serializer-1.8.2.jar\nmemcached-session-manager-tc6-1.8.2.jar\njavolution-5.5.1.jar\n\n将以上包复制到%TOMCAT_HOME%\\lib\\下\n## 配置\n修改%TOMCAT_HOME%\\conf\\context.xml在Context节点下添加如下配置\n```xml\n<Manager className=\"de.javakaffee.web.msm.MemcachedBackupSessionManager\"\n\tmemcacheNodes=\"n1:192.168.1.233:11211\"\n\trequestUriIgnorePattern=\".*\\.(png|gif|jpg|css|js)$\"\n\tsessionBackupAsync=\"false\"\n\tsessionBackupTimeout=\"1800000\"\n\tcopyCollectionsForSerialization=\"false\"\n\ttranscoderFactoryClass=\"de.javakaffee.web.msm.serializer.javolution.JavolutionTranscoderFactory\"/>\n```\n要说明的就是memcachedNodes的配置 我上面写的是memcachedNodes=\"n1:192.168.1.233:11211\"\n192.168.1.233为memcached所在主机IP地址11211为端口然后如果有多个memcached的话用逗号隔开例如：\nmemcachedNodes=\"n1:192.168.1.233:11211,n2:192.168.1.234:11211\"\n\n***注意***\n每个节点都需要这么配置而且需要保证一样，让后将我们之前在server.xml中的Tomcat集群session复制配置注释掉。","slug":"Nginx+Tomcat+Memcached集群","published":1,"updated":"2016-05-13T14:04:17.986Z","layout":"post","photos":[],"link":"","_id":"cio5uhgm80000o0yb6mmgogp0","content":"<p>Nginx和Tomcat的安装和配置在这里就不说了，不明白的可以看文章<a href=\"/2014/12/10/Nginx+Tomcat集群/\">Nginx+Tomcat集群</a>。这篇文章是以前面<a href=\"/2014/12/10/Nginx+Tomcat集群/\">Nginx+Tomcat集群</a>的文章为基础。Nginx+Tomcat+Memcached集群其实很简单，就是将session管理交给了Memcached管理，这样的好处不言而喻，就是如果集群中的节点如果很多的话采用Tomcat节点间的session复制来保证session的共享。这样会给系统带来很大一部分开销。所以就讲session交给了Memcached管理。Memcached是个分布式缓存系统，采用c语言实现。今天我们以一个Memcached为例。对Memcached不在进集群了。<br>安置Memcached之前需要安装他依赖的软件libevent-devel。<br><a id=\"more\"></a></p>\n<h2 id=\"软件安装\"><a href=\"#软件安装\" class=\"headerlink\" title=\"软件安装\"></a>软件安装</h2><h3 id=\"安装libevent-devel\"><a href=\"#安装libevent-devel\" class=\"headerlink\" title=\"安装libevent-devel\"></a>安装libevent-devel</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sehll yum install libevent-devel</span><br></pre></td></tr></table></figure>\n<h3 id=\"安装memcached\"><a href=\"#安装memcached\" class=\"headerlink\" title=\"安装memcached\"></a>安装memcached</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sehll wget http://memcached.org/files/memcached-1.4.22.tar.gz</span><br><span class=\"line\">sehll tar -zxvf memcached-1.4.22.tar.gz</span><br><span class=\"line\">sehll cd memcached-1.4.22</span><br><span class=\"line\">sehll ./configure &amp;&amp; make &amp;&amp; make test &amp;&amp; make install</span><br></pre></td></tr></table></figure>\n<h3 id=\"启动memcached\"><a href=\"#启动memcached\" class=\"headerlink\" title=\"启动memcached\"></a>启动memcached</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell /usr/local/bin/memcached -d -m 256 -p 11211 -u root -l 192.168.1.233</span><br></pre></td></tr></table></figure>\n<p>启动memcached的参数不明白的地方可以查看网上的说明</p>\n<h3 id=\"下载依赖Jar\"><a href=\"#下载依赖Jar\" class=\"headerlink\" title=\"下载依赖Jar\"></a>下载依赖Jar</h3><p><strong><em>下载memcached session管理的jar包,Tomcat的版本不一样依赖jar包也不一样我这里是以Tomcat6为例并采用javolution方式策略</em></strong></p>\n<p>memcached-session-manager-1.8.2.jar<br>spymemcached-2.7.3.jar<br>msm-xstream-serializer-1.8.2.jar<br>msm-javolution-serializer-1.8.2.jar<br>msm-flexjson-serializer-1.8.2.jar<br>memcached-session-manager-tc6-1.8.2.jar<br>javolution-5.5.1.jar</p>\n<p>将以上包复制到%TOMCAT_HOME%\\lib\\下</p>\n<h2 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h2><p>修改%TOMCAT_HOME%\\conf\\context.xml在Context节点下添加如下配置<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Manager</span> <span class=\"attr\">className</span>=<span class=\"string\">\"de.javakaffee.web.msm.MemcachedBackupSessionManager\"</span></span><br><span class=\"line\">\t<span class=\"attr\">memcacheNodes</span>=<span class=\"string\">\"n1:192.168.1.233:11211\"</span></span><br><span class=\"line\">\t<span class=\"attr\">requestUriIgnorePattern</span>=<span class=\"string\">\".*\\.(png|gif|jpg|css|js)$\"</span></span><br><span class=\"line\">\t<span class=\"attr\">sessionBackupAsync</span>=<span class=\"string\">\"false\"</span></span><br><span class=\"line\">\t<span class=\"attr\">sessionBackupTimeout</span>=<span class=\"string\">\"1800000\"</span></span><br><span class=\"line\">\t<span class=\"attr\">copyCollectionsForSerialization</span>=<span class=\"string\">\"false\"</span></span><br><span class=\"line\">\t<span class=\"attr\">transcoderFactoryClass</span>=<span class=\"string\">\"de.javakaffee.web.msm.serializer.javolution.JavolutionTranscoderFactory\"</span>/&gt;</span></span><br></pre></td></tr></table></figure></p>\n<p>要说明的就是memcachedNodes的配置 我上面写的是memcachedNodes=”n1:192.168.1.233:11211”<br>192.168.1.233为memcached所在主机IP地址11211为端口然后如果有多个memcached的话用逗号隔开例如：<br>memcachedNodes=”n1:192.168.1.233:11211,n2:192.168.1.234:11211”</p>\n<p><strong><em>注意</em></strong><br>每个节点都需要这么配置而且需要保证一样，让后将我们之前在server.xml中的Tomcat集群session复制配置注释掉。</p>\n","excerpt":"<p>Nginx和Tomcat的安装和配置在这里就不说了，不明白的可以看文章<a href=\"/2014/12/10/Nginx+Tomcat集群/\">Nginx+Tomcat集群</a>。这篇文章是以前面<a href=\"/2014/12/10/Nginx+Tomcat集群/\">Nginx+Tomcat集群</a>的文章为基础。Nginx+Tomcat+Memcached集群其实很简单，就是将session管理交给了Memcached管理，这样的好处不言而喻，就是如果集群中的节点如果很多的话采用Tomcat节点间的session复制来保证session的共享。这样会给系统带来很大一部分开销。所以就讲session交给了Memcached管理。Memcached是个分布式缓存系统，采用c语言实现。今天我们以一个Memcached为例。对Memcached不在进集群了。<br>安置Memcached之前需要安装他依赖的软件libevent-devel。<br>","more":"</p>\n<h2 id=\"软件安装\"><a href=\"#软件安装\" class=\"headerlink\" title=\"软件安装\"></a>软件安装</h2><h3 id=\"安装libevent-devel\"><a href=\"#安装libevent-devel\" class=\"headerlink\" title=\"安装libevent-devel\"></a>安装libevent-devel</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sehll yum install libevent-devel</span><br></pre></td></tr></table></figure>\n<h3 id=\"安装memcached\"><a href=\"#安装memcached\" class=\"headerlink\" title=\"安装memcached\"></a>安装memcached</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sehll wget http://memcached.org/files/memcached-1.4.22.tar.gz</span><br><span class=\"line\">sehll tar -zxvf memcached-1.4.22.tar.gz</span><br><span class=\"line\">sehll cd memcached-1.4.22</span><br><span class=\"line\">sehll ./configure &amp;&amp; make &amp;&amp; make test &amp;&amp; make install</span><br></pre></td></tr></table></figure>\n<h3 id=\"启动memcached\"><a href=\"#启动memcached\" class=\"headerlink\" title=\"启动memcached\"></a>启动memcached</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell /usr/local/bin/memcached -d -m 256 -p 11211 -u root -l 192.168.1.233</span><br></pre></td></tr></table></figure>\n<p>启动memcached的参数不明白的地方可以查看网上的说明</p>\n<h3 id=\"下载依赖Jar\"><a href=\"#下载依赖Jar\" class=\"headerlink\" title=\"下载依赖Jar\"></a>下载依赖Jar</h3><p><strong><em>下载memcached session管理的jar包,Tomcat的版本不一样依赖jar包也不一样我这里是以Tomcat6为例并采用javolution方式策略</em></strong></p>\n<p>memcached-session-manager-1.8.2.jar<br>spymemcached-2.7.3.jar<br>msm-xstream-serializer-1.8.2.jar<br>msm-javolution-serializer-1.8.2.jar<br>msm-flexjson-serializer-1.8.2.jar<br>memcached-session-manager-tc6-1.8.2.jar<br>javolution-5.5.1.jar</p>\n<p>将以上包复制到%TOMCAT_HOME%\\lib\\下</p>\n<h2 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h2><p>修改%TOMCAT_HOME%\\conf\\context.xml在Context节点下添加如下配置<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Manager</span> <span class=\"attr\">className</span>=<span class=\"string\">\"de.javakaffee.web.msm.MemcachedBackupSessionManager\"</span></span><br><span class=\"line\">\t<span class=\"attr\">memcacheNodes</span>=<span class=\"string\">\"n1:192.168.1.233:11211\"</span></span><br><span class=\"line\">\t<span class=\"attr\">requestUriIgnorePattern</span>=<span class=\"string\">\".*\\.(png|gif|jpg|css|js)$\"</span></span><br><span class=\"line\">\t<span class=\"attr\">sessionBackupAsync</span>=<span class=\"string\">\"false\"</span></span><br><span class=\"line\">\t<span class=\"attr\">sessionBackupTimeout</span>=<span class=\"string\">\"1800000\"</span></span><br><span class=\"line\">\t<span class=\"attr\">copyCollectionsForSerialization</span>=<span class=\"string\">\"false\"</span></span><br><span class=\"line\">\t<span class=\"attr\">transcoderFactoryClass</span>=<span class=\"string\">\"de.javakaffee.web.msm.serializer.javolution.JavolutionTranscoderFactory\"</span>/&gt;</span></span><br></pre></td></tr></table></figure></p>\n<p>要说明的就是memcachedNodes的配置 我上面写的是memcachedNodes=”n1:192.168.1.233:11211”<br>192.168.1.233为memcached所在主机IP地址11211为端口然后如果有多个memcached的话用逗号隔开例如：<br>memcachedNodes=”n1:192.168.1.233:11211,n2:192.168.1.234:11211”</p>\n<p><strong><em>注意</em></strong><br>每个节点都需要这么配置而且需要保证一样，让后将我们之前在server.xml中的Tomcat集群session复制配置注释掉。</p>"},{"title":"Oracle常用脚本","date":"2014-04-30T13:28:01.000Z","comments":1,"toc":true,"_content":"\n### 建表空间\n```sql\ncreate temporary tablespace bjjtxx_space_temp \ntempfile 'D:/oracle/product/10.2.0/oradata/orcl/bjjtxx_temp.dbf' \nsize 32m \nautoextend on \nnext 32m maxsize 2048m\nextent management local; \n\ncreate tablespace bjjtxx_space\nlogging\ndatafile 'D:/oracle/product/10.2.0/oradata/orcl/bjjtxx.dbf' \nsize 32m \nautoextend on \nnext 32m maxsize 2048m\nextent management local;\n```\n<!--more-->\n\n### 建用户\n```sql\ncreate user bjjtxx_develop identified by bjjtxx\ndefault tablespace bjjtxx_space\ntemporary tablespace bjjtxx_space_temp;\n```\n### 用户授权\n```sql\ngrant dba,connect,resource,CTXAPP,create view to bjjtxx_develop;\n```\n\n### 锁表查询\n***查看锁住的表***\n```sql\nSELECT b.owner,b.object_name,a.session_id,a.locked_mode  \n    FROM v$locked_object a ,dba_objects b  \n    WHERE b.object_id = a.object_id; \n```\n\n***查看被锁住的会话 ***\n```sql\nSELECT b.username,b.sid,b.serial#,logon_time  \n    FROM v$locked_object a,v$session b  \n    WHERE a.session_id = b.sid order by b.logon_time; \n```\n\n***如果要断开某个会话，执行  ***\n```sql\nalter system kill session ‘sid,serial#’\n```\n\n### 设置表空间大小\n\n***查找出oralce表空间的文件名、路径 ***\n```sql\nselect tablespace_name, file_id, file_name, round(bytes/(1024*1024),0) total_space from dba_data_files; \n```\n\n***修改表空间大小  ***\n```sql\nALTER DATABASE DATAFILE 'E:\\LARGE.DBF' RESIZE 3000M;\n```\n\n\n***设置表空间最大大小  ***\n```sql\nALTER DATABASE DATAFILE ''/oracle/oradata/db/GAME.dbf \nAUTOEXTEND ON NEXT 100M \nMAXSIZE 10000M;\n```\n","source":"_posts/Oracle常用脚本.md","raw":"---\ntitle: Oracle常用脚本\ndate: 2014-04-30 21:28:01\ncomments: true\ncategories: Oracle\ntoc: true \n---\n\n### 建表空间\n```sql\ncreate temporary tablespace bjjtxx_space_temp \ntempfile 'D:/oracle/product/10.2.0/oradata/orcl/bjjtxx_temp.dbf' \nsize 32m \nautoextend on \nnext 32m maxsize 2048m\nextent management local; \n\ncreate tablespace bjjtxx_space\nlogging\ndatafile 'D:/oracle/product/10.2.0/oradata/orcl/bjjtxx.dbf' \nsize 32m \nautoextend on \nnext 32m maxsize 2048m\nextent management local;\n```\n<!--more-->\n\n### 建用户\n```sql\ncreate user bjjtxx_develop identified by bjjtxx\ndefault tablespace bjjtxx_space\ntemporary tablespace bjjtxx_space_temp;\n```\n### 用户授权\n```sql\ngrant dba,connect,resource,CTXAPP,create view to bjjtxx_develop;\n```\n\n### 锁表查询\n***查看锁住的表***\n```sql\nSELECT b.owner,b.object_name,a.session_id,a.locked_mode  \n    FROM v$locked_object a ,dba_objects b  \n    WHERE b.object_id = a.object_id; \n```\n\n***查看被锁住的会话 ***\n```sql\nSELECT b.username,b.sid,b.serial#,logon_time  \n    FROM v$locked_object a,v$session b  \n    WHERE a.session_id = b.sid order by b.logon_time; \n```\n\n***如果要断开某个会话，执行  ***\n```sql\nalter system kill session ‘sid,serial#’\n```\n\n### 设置表空间大小\n\n***查找出oralce表空间的文件名、路径 ***\n```sql\nselect tablespace_name, file_id, file_name, round(bytes/(1024*1024),0) total_space from dba_data_files; \n```\n\n***修改表空间大小  ***\n```sql\nALTER DATABASE DATAFILE 'E:\\LARGE.DBF' RESIZE 3000M;\n```\n\n\n***设置表空间最大大小  ***\n```sql\nALTER DATABASE DATAFILE ''/oracle/oradata/db/GAME.dbf \nAUTOEXTEND ON NEXT 100M \nMAXSIZE 10000M;\n```\n","slug":"Oracle常用脚本","published":1,"updated":"2016-05-13T14:52:51.913Z","layout":"post","photos":[],"link":"","_id":"cio5uhgmn0001o0yb2cdt3uen","content":"<h3 id=\"建表空间\"><a href=\"#建表空间\" class=\"headerlink\" title=\"建表空间\"></a>建表空间</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">temporary</span> <span class=\"keyword\">tablespace</span> bjjtxx_space_temp </span><br><span class=\"line\">tempfile <span class=\"string\">'D:/oracle/product/10.2.0/oradata/orcl/bjjtxx_temp.dbf'</span> </span><br><span class=\"line\"><span class=\"keyword\">size</span> <span class=\"number\">32</span>m </span><br><span class=\"line\"><span class=\"keyword\">autoextend</span> <span class=\"keyword\">on</span> </span><br><span class=\"line\"><span class=\"keyword\">next</span> <span class=\"number\">32</span>m <span class=\"keyword\">maxsize</span> <span class=\"number\">2048</span>m</span><br><span class=\"line\"><span class=\"keyword\">extent</span> <span class=\"keyword\">management</span> <span class=\"keyword\">local</span>; </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">tablespace</span> bjjtxx_space</span><br><span class=\"line\"><span class=\"keyword\">logging</span></span><br><span class=\"line\"><span class=\"keyword\">datafile</span> <span class=\"string\">'D:/oracle/product/10.2.0/oradata/orcl/bjjtxx.dbf'</span> </span><br><span class=\"line\"><span class=\"keyword\">size</span> <span class=\"number\">32</span>m </span><br><span class=\"line\"><span class=\"keyword\">autoextend</span> <span class=\"keyword\">on</span> </span><br><span class=\"line\"><span class=\"keyword\">next</span> <span class=\"number\">32</span>m <span class=\"keyword\">maxsize</span> <span class=\"number\">2048</span>m</span><br><span class=\"line\"><span class=\"keyword\">extent</span> <span class=\"keyword\">management</span> <span class=\"keyword\">local</span>;</span><br></pre></td></tr></table></figure>\n<a id=\"more\"></a>\n<h3 id=\"建用户\"><a href=\"#建用户\" class=\"headerlink\" title=\"建用户\"></a>建用户</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">user</span> bjjtxx_develop <span class=\"keyword\">identified</span> <span class=\"keyword\">by</span> bjjtxx</span><br><span class=\"line\"><span class=\"keyword\">default</span> <span class=\"keyword\">tablespace</span> bjjtxx_space</span><br><span class=\"line\"><span class=\"keyword\">temporary</span> <span class=\"keyword\">tablespace</span> bjjtxx_space_temp;</span><br></pre></td></tr></table></figure>\n<h3 id=\"用户授权\"><a href=\"#用户授权\" class=\"headerlink\" title=\"用户授权\"></a>用户授权</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">grant</span> dba,<span class=\"keyword\">connect</span>,<span class=\"keyword\">resource</span>,CTXAPP,<span class=\"keyword\">create</span> <span class=\"keyword\">view</span> <span class=\"keyword\">to</span> bjjtxx_develop;</span><br></pre></td></tr></table></figure>\n<h3 id=\"锁表查询\"><a href=\"#锁表查询\" class=\"headerlink\" title=\"锁表查询\"></a>锁表查询</h3><p><strong><em>查看锁住的表</em></strong><br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span> b.owner,b.object_name,a.session_id,a.locked_mode  </span><br><span class=\"line\">    <span class=\"keyword\">FROM</span> v$locked_object a ,dba_objects b  </span><br><span class=\"line\">    <span class=\"keyword\">WHERE</span> b.object_id = a.object_id;</span><br></pre></td></tr></table></figure></p>\n<p><strong><em>查看被锁住的会话 </em></strong><br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span> b.username,b.sid,b.serial#,logon_time  </span><br><span class=\"line\">    <span class=\"keyword\">FROM</span> v$locked_object a,v$<span class=\"keyword\">session</span> b  </span><br><span class=\"line\">    <span class=\"keyword\">WHERE</span> a.session_id = b.sid <span class=\"keyword\">order</span> <span class=\"keyword\">by</span> b.logon_time;</span><br></pre></td></tr></table></figure></p>\n<p><strong><em>如果要断开某个会话，执行  </em></strong><br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">alter</span> <span class=\"keyword\">system</span> <span class=\"keyword\">kill</span> <span class=\"keyword\">session</span> ‘<span class=\"keyword\">sid</span>,<span class=\"built_in\">serial</span>#’</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"设置表空间大小\"><a href=\"#设置表空间大小\" class=\"headerlink\" title=\"设置表空间大小\"></a>设置表空间大小</h3><p><strong><em>查找出oralce表空间的文件名、路径 </em></strong><br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">select</span> tablespace_name, file_id, file_name, <span class=\"keyword\">round</span>(<span class=\"keyword\">bytes</span>/(<span class=\"number\">1024</span>*<span class=\"number\">1024</span>),<span class=\"number\">0</span>) total_space <span class=\"keyword\">from</span> dba_data_files;</span><br></pre></td></tr></table></figure></p>\n<p><strong><em>修改表空间大小  </em></strong><br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">DATABASE</span> <span class=\"keyword\">DATAFILE</span> <span class=\"string\">'E:\\LARGE.DBF'</span> <span class=\"keyword\">RESIZE</span> <span class=\"number\">3000</span>M;</span><br></pre></td></tr></table></figure></p>\n<p><strong><em>设置表空间最大大小  </em></strong><br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">DATABASE</span> <span class=\"keyword\">DATAFILE</span> <span class=\"string\">''</span>/<span class=\"keyword\">oracle</span>/<span class=\"keyword\">oradata</span>/db/GAME.dbf </span><br><span class=\"line\"><span class=\"keyword\">AUTOEXTEND</span> <span class=\"keyword\">ON</span> <span class=\"keyword\">NEXT</span> <span class=\"number\">100</span>M </span><br><span class=\"line\"><span class=\"keyword\">MAXSIZE</span> <span class=\"number\">10000</span>M;</span><br></pre></td></tr></table></figure></p>\n","excerpt":"<h3 id=\"建表空间\"><a href=\"#建表空间\" class=\"headerlink\" title=\"建表空间\"></a>建表空间</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">temporary</span> <span class=\"keyword\">tablespace</span> bjjtxx_space_temp </span><br><span class=\"line\">tempfile <span class=\"string\">'D:/oracle/product/10.2.0/oradata/orcl/bjjtxx_temp.dbf'</span> </span><br><span class=\"line\"><span class=\"keyword\">size</span> <span class=\"number\">32</span>m </span><br><span class=\"line\"><span class=\"keyword\">autoextend</span> <span class=\"keyword\">on</span> </span><br><span class=\"line\"><span class=\"keyword\">next</span> <span class=\"number\">32</span>m <span class=\"keyword\">maxsize</span> <span class=\"number\">2048</span>m</span><br><span class=\"line\"><span class=\"keyword\">extent</span> <span class=\"keyword\">management</span> <span class=\"keyword\">local</span>; </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">tablespace</span> bjjtxx_space</span><br><span class=\"line\"><span class=\"keyword\">logging</span></span><br><span class=\"line\"><span class=\"keyword\">datafile</span> <span class=\"string\">'D:/oracle/product/10.2.0/oradata/orcl/bjjtxx.dbf'</span> </span><br><span class=\"line\"><span class=\"keyword\">size</span> <span class=\"number\">32</span>m </span><br><span class=\"line\"><span class=\"keyword\">autoextend</span> <span class=\"keyword\">on</span> </span><br><span class=\"line\"><span class=\"keyword\">next</span> <span class=\"number\">32</span>m <span class=\"keyword\">maxsize</span> <span class=\"number\">2048</span>m</span><br><span class=\"line\"><span class=\"keyword\">extent</span> <span class=\"keyword\">management</span> <span class=\"keyword\">local</span>;</span><br></pre></td></tr></table></figure>","more":"<h3 id=\"建用户\"><a href=\"#建用户\" class=\"headerlink\" title=\"建用户\"></a>建用户</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">user</span> bjjtxx_develop <span class=\"keyword\">identified</span> <span class=\"keyword\">by</span> bjjtxx</span><br><span class=\"line\"><span class=\"keyword\">default</span> <span class=\"keyword\">tablespace</span> bjjtxx_space</span><br><span class=\"line\"><span class=\"keyword\">temporary</span> <span class=\"keyword\">tablespace</span> bjjtxx_space_temp;</span><br></pre></td></tr></table></figure>\n<h3 id=\"用户授权\"><a href=\"#用户授权\" class=\"headerlink\" title=\"用户授权\"></a>用户授权</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">grant</span> dba,<span class=\"keyword\">connect</span>,<span class=\"keyword\">resource</span>,CTXAPP,<span class=\"keyword\">create</span> <span class=\"keyword\">view</span> <span class=\"keyword\">to</span> bjjtxx_develop;</span><br></pre></td></tr></table></figure>\n<h3 id=\"锁表查询\"><a href=\"#锁表查询\" class=\"headerlink\" title=\"锁表查询\"></a>锁表查询</h3><p><strong><em>查看锁住的表</em></strong><br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span> b.owner,b.object_name,a.session_id,a.locked_mode  </span><br><span class=\"line\">    <span class=\"keyword\">FROM</span> v$locked_object a ,dba_objects b  </span><br><span class=\"line\">    <span class=\"keyword\">WHERE</span> b.object_id = a.object_id;</span><br></pre></td></tr></table></figure></p>\n<p><strong><em>查看被锁住的会话 </em></strong><br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span> b.username,b.sid,b.serial#,logon_time  </span><br><span class=\"line\">    <span class=\"keyword\">FROM</span> v$locked_object a,v$<span class=\"keyword\">session</span> b  </span><br><span class=\"line\">    <span class=\"keyword\">WHERE</span> a.session_id = b.sid <span class=\"keyword\">order</span> <span class=\"keyword\">by</span> b.logon_time;</span><br></pre></td></tr></table></figure></p>\n<p><strong><em>如果要断开某个会话，执行  </em></strong><br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">alter</span> <span class=\"keyword\">system</span> <span class=\"keyword\">kill</span> <span class=\"keyword\">session</span> ‘<span class=\"keyword\">sid</span>,<span class=\"built_in\">serial</span>#’</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"设置表空间大小\"><a href=\"#设置表空间大小\" class=\"headerlink\" title=\"设置表空间大小\"></a>设置表空间大小</h3><p><strong><em>查找出oralce表空间的文件名、路径 </em></strong><br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">select</span> tablespace_name, file_id, file_name, <span class=\"keyword\">round</span>(<span class=\"keyword\">bytes</span>/(<span class=\"number\">1024</span>*<span class=\"number\">1024</span>),<span class=\"number\">0</span>) total_space <span class=\"keyword\">from</span> dba_data_files;</span><br></pre></td></tr></table></figure></p>\n<p><strong><em>修改表空间大小  </em></strong><br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">DATABASE</span> <span class=\"keyword\">DATAFILE</span> <span class=\"string\">'E:\\LARGE.DBF'</span> <span class=\"keyword\">RESIZE</span> <span class=\"number\">3000</span>M;</span><br></pre></td></tr></table></figure></p>\n<p><strong><em>设置表空间最大大小  </em></strong><br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">DATABASE</span> <span class=\"keyword\">DATAFILE</span> <span class=\"string\">''</span>/<span class=\"keyword\">oracle</span>/<span class=\"keyword\">oradata</span>/db/GAME.dbf </span><br><span class=\"line\"><span class=\"keyword\">AUTOEXTEND</span> <span class=\"keyword\">ON</span> <span class=\"keyword\">NEXT</span> <span class=\"number\">100</span>M </span><br><span class=\"line\"><span class=\"keyword\">MAXSIZE</span> <span class=\"number\">10000</span>M;</span><br></pre></td></tr></table></figure></p>"},{"title":"Nginx+Tomcat集群","date":"2014-12-10T06:35:40.000Z","comments":1,"toc":true,"_content":"## 环境\n|系统\t  |  JDK    |Tomcat    |Nginx                                      |\n|:-------:|:-------:|:--------:|:-----------------------------------------:|\n|CentOS6 192.168.1.231 CentOS6 192.168.1.232  |JDK1.6   |Tomcat6   |nginx-release-centos-6-0.el6.ngx.noarch.rpm|\n## 安装JDK\n第一步：检查是否已经安装了jdk 存在就卸载 rpm -e 包名\n<!--more-->\n```\nshell rpm -qa | grep java*\n```\n第二步：查看yum库是否有java安装包\n```\nshell  yum -y list java*\n```\n第三步：选择一个进行安装\n```\nshell yum -y install java-1.6.0-openjdk*\n```\n第四步：确定是否安装成功\n```\nshell java -version\njava version \"1.6.0_20\"\nOpenJDK Runtime Environment (IcedTea6 1.9.10) (rhel-1.23.1.9.10.el5_7-i386)\nOpenJDK Client VM (build 19.0-b09, mixed mode)\n显示如上信息表示安装成功\n```\n\n## 安装Nginx\n***通过yum安装nginx 针对 CentOS系统 其他版本可能会存在差异***\n\n### 下载安装包\n```\nshell rpm -ivh http://nginx.org/packages/centos/6/noarch/RPMS/nginx-release-centos-6-0.el6.ngx.noarch.rpm\n```\n\n### 查看nginx信息\n```\nshell yum info nginx\n\nLoaded plugins: fastestmirror, refresh-packagekit, security\nLoading mirror speeds from cached hostfile\n * base: mirrors.yun-idc.com\n * extras: mirrors.yun-idc.com\n * updates: mirrors.yun-idc.com\nnginx                                                                    | 2.9 kB     00:00    \nnginx/primary_db                                                         |  33 kB     00:00    \nAvailable Packages\nName        : nginx\nArch        : i386\nVersion     : 1.6.2\nRelease     : 1.el6.ngx\nSize        : 343 k\nRepo        : nginx\nSummary     : High performance web server\nURL         : http://nginx.org/\nLicense     : 2-clause BSD-like license\nDescription : nginx [engine x] is an HTTP and reverse proxy server, as well as\n            : a mail proxy server.\n```\n\n### 安装\n```\nshell yum install nginx\n```\n### 启动\n```\nshell service nginx start\n```\n### 访问\n\nhttp://ip\n\n查找nginx安装目录\n```\nshell ps -ef |grep nginx\nroot      2244     1  0 22:45 ?        00:00:00 nginx: master process /usr/sbin/nginx -c /etc/nginx/nginx.conf\nnginx     2245  2244  0 22:45 ?        00:00:00 nginx: worker process                  \nroot      2268  1922  0 22:50 pts/1    00:00:00 grep nginx\n```\n***如果不能连接到nginx，原因很多，但是可以先检查 1,nginx服务是否真的起来了；2,linux服务器防火墙是否打开***\n\n## 安装Tomcat\n```\nshell yum install tomcat6 tomcat6-webapps tomcat6-admin-webapps\n```\n\n### 启动\n\n```\nshell service tomcat6 start\n```\n\n### 启动\n\n```\nshell service tomcat6 stop\n```\n\n### 重启\n\n```\nshell service tomcat6 restart\n```\n\n按照以上方法安装tomcat6默认目录在/usr/share/tomcat6/下\n配置文件默认目录在/etc/tomcat6/下\n\n## 集群配置\n\n### 配置nginx.conf\n***在http{}中添加***\n```\nupstream cluster{\n server 192.168.1.231:8080 weight=2;\n server 192.168.1.232:8080 weight=1;\n}\n```\ncluster这个名称可以随便起\nweight参数表示权值，权值越高被分配到的几率越大\nserver 192.168.1.231:8080; 就是一个tomcat节点\n***在server{}中添加如下配置 表示对于访问.jsp的页面使用代理服务器跳转到tomcat节点中***\n```\nlocation ~ \\.jsp$ {\n   proxy_pass   http://cluster;\n}\n```\n\n如果想对根进行设置只需要对\n\n```\nlocation / {\n root   /usr/share/nginx/html;\n index  index.html index.html;\n}\n修改为\nlocation / {\n proxy_set_header Host $host;\n proxy_pass  http://cluster;\n}\n即可\n```\n\n复杂点的设置如下\n\n```\nlocation / {\n proxy_pass  http://cluster;\n proxy_redirect          off;\n proxy_set_header        Host $host;\n proxy_set_header        X-Real-IP $remote_addr;\n proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;\n client_max_body_size    10m;\n client_body_buffer_size 128k;\n proxy_connect_timeout   90;\n proxy_send_timeout      90;\n proxy_read_timeout      90;\n proxy_buffer_size       4k;\n proxy_buffers           4 32k;\n proxy_busy_buffers_size 64k;\n proxy_temp_file_write_size 64k;\n}\n```\n\n### nginx.conf文件说明\n```\n#nginx用户\nuser  nginx;\n#nginx进程数字越大对于处理并发能力越强如果设置2就相当于开启了两个nginx\nworker_processes  1;\n#错误文件日志路径\nerror_log  /var/log/nginx/error.log warn;\npid        /var/run/nginx.pid;\n#对应每个processes允许最大的连接数\nevents {\n    worker_connections  1024;\n}\n\nhttp {\n    include       /etc/nginx/mime.types;\n    default_type  application/octet-stream;\n    log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '\n                      '$status $body_bytes_sent \"$http_referer\" '\n                      '\"$http_user_agent\" \"$http_x_forwarded_for\"';\n\n    access_log  /var/log/nginx/access.log  main;\n    sendfile        on;\n    #tcp_nopush     on;\n    keepalive_timeout  65;\n    #gzip  on;\n\t#负载均衡控制 server 对应集群的一个个节点weight表示权重值数字越大出现的次数越多\n\tupstream cluster{\n\t  server 192.168.1.231:8080 weight=1;\n\t  server 192.168.1.240:8080 weight=2;\n\t}\n\t#nginx服务器配置\n    server {\n\t\t#监听端口\n\t\tlisten       80;\n\t\t#服务器名称\n\t    server_name  localhost;\n\n\t\t#charset koi8-r;\n\t\t#access_log  /var/log/nginx/log/host.access.log  main;\n\t    #对于请求跟路径时候的处理\n\t\tlocation / {\n\t\t   root   /usr/share/nginx/html;\n\t\t   index  index.html index.htm;\n\t\t   proxy_set_header Host $host;\n\t\t   proxy_pass  http://cluster;\n\t\t}\n\n\t    #error_page  404              /404.html;\n\n\t    # redirect server error pages to the static page /50x.html\n\n\t    error_page   500 502 503 504  /50x.html;\n\t    location = /50x.html {\n\t\t\troot   /usr/share/nginx/html;\n\t\t\t#proxy_pass   http://cluster;\n\t\t}\n\t    #设置对于请求jsp时候的处理\n\t    location ~ \\.jsp$ {\n\t\t\tproxy_pass   http://cluster;\n\t\t}\n\t    # proxy the PHP scripts to Apache listening on 127.0.0.1:80\n\t    #\n\t    #location ~ \\.php$ {\n\t    #    proxy_pass   http://127.0.0.1;\n\t    #}\n\n\t    # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000\n\t    #\n\t    #location ~ \\.php$ {\n\t    #    root           html;\n\t    #    fastcgi_pass   127.0.0.1:9000;\n\t    #    fastcgi_index  index.php;\n\t    #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;\n\t    #    include        fastcgi_params;\n\t    #}\n\n\t    # deny access to .htaccess files, if Apache's document root\n\t    # concurs with nginx's one\n\t    #\n\t    #location ~ /\\.ht {\n\t    #    deny  all;\n\t    #}\n\t}\n}\n```\n\n### Tomcat配置\n打开tomcat的文档查看集群说明将集群配置如下 复制到tomcat\\conf\\server.xml文件 Engine节点下添加如下配置[具体说明查看官方文档](https://tomcat.apache.org/tomcat-6.0-doc/cluster-howto.html)\n```xml\n <Cluster className=\"org.apache.catalina.ha.tcp.SimpleTcpCluster\"\n\t\t\t channelSendOptions=\"8\">\n\n  <Manager className=\"org.apache.catalina.ha.session.DeltaManager\"\n\t\t   expireSessionsOnShutdown=\"false\"\n\t\t   notifyListenersOnReplication=\"true\"/>\n\n  <Channel className=\"org.apache.catalina.tribes.group.GroupChannel\">\n\t<Membership className=\"org.apache.catalina.tribes.membership.McastService\"\n\t\t\t\taddress=\"228.0.0.4\"\n\t\t\t\tport=\"45564\"\n\t\t\t\tfrequency=\"500\"\n\t\t\t\tdropTime=\"3000\"/>\n\t<Receiver className=\"org.apache.catalina.tribes.transport.nio.NioReceiver\"\n\t\t\t  address=\"auto\"\n\t\t\t  port=\"4000\"\n\t\t\t  autoBind=\"100\"\n\t\t\t  selectorTimeout=\"5000\"\n\t\t\t  maxThreads=\"6\"/>\n\n\t<Sender className=\"org.apache.catalina.tribes.transport.ReplicationTransmitter\">\n\t  <Transport className=\"org.apache.catalina.tribes.transport.nio.PooledParallelSender\"/>\n\t</Sender>\n\t<Interceptor className=\"org.apache.catalina.tribes.group.interceptors.TcpFailureDetector\"/>\n\t<Interceptor className=\"org.apache.catalina.tribes.group.interceptors.MessageDispatch15Interceptor\"/>\n  </Channel>\n\n  <Valve className=\"org.apache.catalina.ha.tcp.ReplicationValve\"\n\t\t filter=\"\"/>\n  <Valve className=\"org.apache.catalina.ha.session.JvmRouteBinderValve\"/>\n\n  <Deployer className=\"org.apache.catalina.ha.deploy.FarmWarDeployer\"\n\t\t\ttempDir=\"/tmp/war-temp/\"\n\t\t\tdeployDir=\"/tmp/war-deploy/\"\n\t\t\twatchDir=\"/tmp/war-listen/\"\n\t\t\twatchEnabled=\"false\"/>\n\n  <ClusterListener className=\"org.apache.catalina.ha.session.JvmRouteSessionIDBinderListener\"/>\n  <ClusterListener className=\"org.apache.catalina.ha.session.ClusterSessionListener\"/>\n</Cluster>   \n```\n\n```xml\n将\n<Engine name=\"Catalina\" defaultHost=\"localhost\"> \n添加jvmRoute属性\n<Engine name=\"Catalina\" defaultHost=\"localhost\" jvmRoute=\"node01\" > \n注意其他节点JvmRoute要分别不一样\n```\n在将应用的web.xml 文件末尾添加  distributable元素 如下表示这个应用下的session是可以共享的\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<web-app>\n   <distributable/>\n</web-app>\n```\n然后启动服务器发现控制台打印\n![控制台打印](003vMReezy6OUXDo7kt61&690.jpg)\n```\n信息: Manager [localhost#/demo]: skipping state transfer. No members active in cluster group.\n一月 04, 2015 7:55:30 下午 org.apache.catalina.tribes.transport.ReceiverBase bind\n信息: Receiver Server Socket bound to:/127.0.0.1:4000\n一月 04, 2015 7:56:34 下午 org.apache.catalina.ha.session.DeltaManager getAllClusterSessions\n警告: Manager [localhost#/demo]: Drop message SESSION-GET-ALL inside GET_ALL_SESSIONS sync phase start date 15-1-4 下午7:55 message date 70-1-1 上午8:00\n```\n\n表示没有发现其他的集群中的其他节点。接受Socket bind的IP是127.0.0.1所以我们需要将他改为局域网的IP\n将节点Receiver 属性address=\"auto\"改为服务器局域网IP如下；其他节点也要做相应的改动\n```xml\n<Receiver className=\"org.apache.catalina.tribes.transport.nio.NioReceiver\"\n\t\t  address=\"192.168.1.231\"\n\t\t  port=\"4000\"\n\t\t  autoBind=\"100\"\n\t\t  selectorTimeout=\"5000\"\n\t\t  maxThreads=\"6\"/>\n```\n再次启动服务器发现可以找到了其他的节点了\n\n然后启动nginx 访问nginx http://192.168.1.228/demo/分别打印\n```\nHello World DF53CB7748D8BC67E0AB8A9BBA13048F.node2\nHello World DF53CB7748D8BC67E0AB8A9BBA13048F.node1\n```\n\n可以看出在node2节点设置的 Hello World在node1、node2上分别获取到了表示配置tomcat的session共享已经成功，如果仅是sessionId相同并不能表示session共享成功，因为通过一个相同的IP和端口访问的服务器都会把cookie中的sessionid发送给服务器。\n\n***注意：***\n不要单独去访问某一台服务器这样是不能验证session是否配置成功。因为访问单独的服务器在浏览器输入的ip和端口是不一样的，浏览器是不会把访问其他服务器的cookie自动带上发送给服务器。所以通过单独访问每次打印的sessionId肯定是不一样的。","source":"_posts/Nginx+Tomcat集群.md","raw":"---\ntitle: Nginx+Tomcat集群\ndate: 2014-12-10 14:35:40\ncomments: true\ncategories: Tomcat\ntoc: true \n---\n## 环境\n|系统\t  |  JDK    |Tomcat    |Nginx                                      |\n|:-------:|:-------:|:--------:|:-----------------------------------------:|\n|CentOS6 192.168.1.231 CentOS6 192.168.1.232  |JDK1.6   |Tomcat6   |nginx-release-centos-6-0.el6.ngx.noarch.rpm|\n## 安装JDK\n第一步：检查是否已经安装了jdk 存在就卸载 rpm -e 包名\n<!--more-->\n```\nshell rpm -qa | grep java*\n```\n第二步：查看yum库是否有java安装包\n```\nshell  yum -y list java*\n```\n第三步：选择一个进行安装\n```\nshell yum -y install java-1.6.0-openjdk*\n```\n第四步：确定是否安装成功\n```\nshell java -version\njava version \"1.6.0_20\"\nOpenJDK Runtime Environment (IcedTea6 1.9.10) (rhel-1.23.1.9.10.el5_7-i386)\nOpenJDK Client VM (build 19.0-b09, mixed mode)\n显示如上信息表示安装成功\n```\n\n## 安装Nginx\n***通过yum安装nginx 针对 CentOS系统 其他版本可能会存在差异***\n\n### 下载安装包\n```\nshell rpm -ivh http://nginx.org/packages/centos/6/noarch/RPMS/nginx-release-centos-6-0.el6.ngx.noarch.rpm\n```\n\n### 查看nginx信息\n```\nshell yum info nginx\n\nLoaded plugins: fastestmirror, refresh-packagekit, security\nLoading mirror speeds from cached hostfile\n * base: mirrors.yun-idc.com\n * extras: mirrors.yun-idc.com\n * updates: mirrors.yun-idc.com\nnginx                                                                    | 2.9 kB     00:00    \nnginx/primary_db                                                         |  33 kB     00:00    \nAvailable Packages\nName        : nginx\nArch        : i386\nVersion     : 1.6.2\nRelease     : 1.el6.ngx\nSize        : 343 k\nRepo        : nginx\nSummary     : High performance web server\nURL         : http://nginx.org/\nLicense     : 2-clause BSD-like license\nDescription : nginx [engine x] is an HTTP and reverse proxy server, as well as\n            : a mail proxy server.\n```\n\n### 安装\n```\nshell yum install nginx\n```\n### 启动\n```\nshell service nginx start\n```\n### 访问\n\nhttp://ip\n\n查找nginx安装目录\n```\nshell ps -ef |grep nginx\nroot      2244     1  0 22:45 ?        00:00:00 nginx: master process /usr/sbin/nginx -c /etc/nginx/nginx.conf\nnginx     2245  2244  0 22:45 ?        00:00:00 nginx: worker process                  \nroot      2268  1922  0 22:50 pts/1    00:00:00 grep nginx\n```\n***如果不能连接到nginx，原因很多，但是可以先检查 1,nginx服务是否真的起来了；2,linux服务器防火墙是否打开***\n\n## 安装Tomcat\n```\nshell yum install tomcat6 tomcat6-webapps tomcat6-admin-webapps\n```\n\n### 启动\n\n```\nshell service tomcat6 start\n```\n\n### 启动\n\n```\nshell service tomcat6 stop\n```\n\n### 重启\n\n```\nshell service tomcat6 restart\n```\n\n按照以上方法安装tomcat6默认目录在/usr/share/tomcat6/下\n配置文件默认目录在/etc/tomcat6/下\n\n## 集群配置\n\n### 配置nginx.conf\n***在http{}中添加***\n```\nupstream cluster{\n server 192.168.1.231:8080 weight=2;\n server 192.168.1.232:8080 weight=1;\n}\n```\ncluster这个名称可以随便起\nweight参数表示权值，权值越高被分配到的几率越大\nserver 192.168.1.231:8080; 就是一个tomcat节点\n***在server{}中添加如下配置 表示对于访问.jsp的页面使用代理服务器跳转到tomcat节点中***\n```\nlocation ~ \\.jsp$ {\n   proxy_pass   http://cluster;\n}\n```\n\n如果想对根进行设置只需要对\n\n```\nlocation / {\n root   /usr/share/nginx/html;\n index  index.html index.html;\n}\n修改为\nlocation / {\n proxy_set_header Host $host;\n proxy_pass  http://cluster;\n}\n即可\n```\n\n复杂点的设置如下\n\n```\nlocation / {\n proxy_pass  http://cluster;\n proxy_redirect          off;\n proxy_set_header        Host $host;\n proxy_set_header        X-Real-IP $remote_addr;\n proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;\n client_max_body_size    10m;\n client_body_buffer_size 128k;\n proxy_connect_timeout   90;\n proxy_send_timeout      90;\n proxy_read_timeout      90;\n proxy_buffer_size       4k;\n proxy_buffers           4 32k;\n proxy_busy_buffers_size 64k;\n proxy_temp_file_write_size 64k;\n}\n```\n\n### nginx.conf文件说明\n```\n#nginx用户\nuser  nginx;\n#nginx进程数字越大对于处理并发能力越强如果设置2就相当于开启了两个nginx\nworker_processes  1;\n#错误文件日志路径\nerror_log  /var/log/nginx/error.log warn;\npid        /var/run/nginx.pid;\n#对应每个processes允许最大的连接数\nevents {\n    worker_connections  1024;\n}\n\nhttp {\n    include       /etc/nginx/mime.types;\n    default_type  application/octet-stream;\n    log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '\n                      '$status $body_bytes_sent \"$http_referer\" '\n                      '\"$http_user_agent\" \"$http_x_forwarded_for\"';\n\n    access_log  /var/log/nginx/access.log  main;\n    sendfile        on;\n    #tcp_nopush     on;\n    keepalive_timeout  65;\n    #gzip  on;\n\t#负载均衡控制 server 对应集群的一个个节点weight表示权重值数字越大出现的次数越多\n\tupstream cluster{\n\t  server 192.168.1.231:8080 weight=1;\n\t  server 192.168.1.240:8080 weight=2;\n\t}\n\t#nginx服务器配置\n    server {\n\t\t#监听端口\n\t\tlisten       80;\n\t\t#服务器名称\n\t    server_name  localhost;\n\n\t\t#charset koi8-r;\n\t\t#access_log  /var/log/nginx/log/host.access.log  main;\n\t    #对于请求跟路径时候的处理\n\t\tlocation / {\n\t\t   root   /usr/share/nginx/html;\n\t\t   index  index.html index.htm;\n\t\t   proxy_set_header Host $host;\n\t\t   proxy_pass  http://cluster;\n\t\t}\n\n\t    #error_page  404              /404.html;\n\n\t    # redirect server error pages to the static page /50x.html\n\n\t    error_page   500 502 503 504  /50x.html;\n\t    location = /50x.html {\n\t\t\troot   /usr/share/nginx/html;\n\t\t\t#proxy_pass   http://cluster;\n\t\t}\n\t    #设置对于请求jsp时候的处理\n\t    location ~ \\.jsp$ {\n\t\t\tproxy_pass   http://cluster;\n\t\t}\n\t    # proxy the PHP scripts to Apache listening on 127.0.0.1:80\n\t    #\n\t    #location ~ \\.php$ {\n\t    #    proxy_pass   http://127.0.0.1;\n\t    #}\n\n\t    # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000\n\t    #\n\t    #location ~ \\.php$ {\n\t    #    root           html;\n\t    #    fastcgi_pass   127.0.0.1:9000;\n\t    #    fastcgi_index  index.php;\n\t    #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;\n\t    #    include        fastcgi_params;\n\t    #}\n\n\t    # deny access to .htaccess files, if Apache's document root\n\t    # concurs with nginx's one\n\t    #\n\t    #location ~ /\\.ht {\n\t    #    deny  all;\n\t    #}\n\t}\n}\n```\n\n### Tomcat配置\n打开tomcat的文档查看集群说明将集群配置如下 复制到tomcat\\conf\\server.xml文件 Engine节点下添加如下配置[具体说明查看官方文档](https://tomcat.apache.org/tomcat-6.0-doc/cluster-howto.html)\n```xml\n <Cluster className=\"org.apache.catalina.ha.tcp.SimpleTcpCluster\"\n\t\t\t channelSendOptions=\"8\">\n\n  <Manager className=\"org.apache.catalina.ha.session.DeltaManager\"\n\t\t   expireSessionsOnShutdown=\"false\"\n\t\t   notifyListenersOnReplication=\"true\"/>\n\n  <Channel className=\"org.apache.catalina.tribes.group.GroupChannel\">\n\t<Membership className=\"org.apache.catalina.tribes.membership.McastService\"\n\t\t\t\taddress=\"228.0.0.4\"\n\t\t\t\tport=\"45564\"\n\t\t\t\tfrequency=\"500\"\n\t\t\t\tdropTime=\"3000\"/>\n\t<Receiver className=\"org.apache.catalina.tribes.transport.nio.NioReceiver\"\n\t\t\t  address=\"auto\"\n\t\t\t  port=\"4000\"\n\t\t\t  autoBind=\"100\"\n\t\t\t  selectorTimeout=\"5000\"\n\t\t\t  maxThreads=\"6\"/>\n\n\t<Sender className=\"org.apache.catalina.tribes.transport.ReplicationTransmitter\">\n\t  <Transport className=\"org.apache.catalina.tribes.transport.nio.PooledParallelSender\"/>\n\t</Sender>\n\t<Interceptor className=\"org.apache.catalina.tribes.group.interceptors.TcpFailureDetector\"/>\n\t<Interceptor className=\"org.apache.catalina.tribes.group.interceptors.MessageDispatch15Interceptor\"/>\n  </Channel>\n\n  <Valve className=\"org.apache.catalina.ha.tcp.ReplicationValve\"\n\t\t filter=\"\"/>\n  <Valve className=\"org.apache.catalina.ha.session.JvmRouteBinderValve\"/>\n\n  <Deployer className=\"org.apache.catalina.ha.deploy.FarmWarDeployer\"\n\t\t\ttempDir=\"/tmp/war-temp/\"\n\t\t\tdeployDir=\"/tmp/war-deploy/\"\n\t\t\twatchDir=\"/tmp/war-listen/\"\n\t\t\twatchEnabled=\"false\"/>\n\n  <ClusterListener className=\"org.apache.catalina.ha.session.JvmRouteSessionIDBinderListener\"/>\n  <ClusterListener className=\"org.apache.catalina.ha.session.ClusterSessionListener\"/>\n</Cluster>   \n```\n\n```xml\n将\n<Engine name=\"Catalina\" defaultHost=\"localhost\"> \n添加jvmRoute属性\n<Engine name=\"Catalina\" defaultHost=\"localhost\" jvmRoute=\"node01\" > \n注意其他节点JvmRoute要分别不一样\n```\n在将应用的web.xml 文件末尾添加  distributable元素 如下表示这个应用下的session是可以共享的\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<web-app>\n   <distributable/>\n</web-app>\n```\n然后启动服务器发现控制台打印\n![控制台打印](003vMReezy6OUXDo7kt61&690.jpg)\n```\n信息: Manager [localhost#/demo]: skipping state transfer. No members active in cluster group.\n一月 04, 2015 7:55:30 下午 org.apache.catalina.tribes.transport.ReceiverBase bind\n信息: Receiver Server Socket bound to:/127.0.0.1:4000\n一月 04, 2015 7:56:34 下午 org.apache.catalina.ha.session.DeltaManager getAllClusterSessions\n警告: Manager [localhost#/demo]: Drop message SESSION-GET-ALL inside GET_ALL_SESSIONS sync phase start date 15-1-4 下午7:55 message date 70-1-1 上午8:00\n```\n\n表示没有发现其他的集群中的其他节点。接受Socket bind的IP是127.0.0.1所以我们需要将他改为局域网的IP\n将节点Receiver 属性address=\"auto\"改为服务器局域网IP如下；其他节点也要做相应的改动\n```xml\n<Receiver className=\"org.apache.catalina.tribes.transport.nio.NioReceiver\"\n\t\t  address=\"192.168.1.231\"\n\t\t  port=\"4000\"\n\t\t  autoBind=\"100\"\n\t\t  selectorTimeout=\"5000\"\n\t\t  maxThreads=\"6\"/>\n```\n再次启动服务器发现可以找到了其他的节点了\n\n然后启动nginx 访问nginx http://192.168.1.228/demo/分别打印\n```\nHello World DF53CB7748D8BC67E0AB8A9BBA13048F.node2\nHello World DF53CB7748D8BC67E0AB8A9BBA13048F.node1\n```\n\n可以看出在node2节点设置的 Hello World在node1、node2上分别获取到了表示配置tomcat的session共享已经成功，如果仅是sessionId相同并不能表示session共享成功，因为通过一个相同的IP和端口访问的服务器都会把cookie中的sessionid发送给服务器。\n\n***注意：***\n不要单独去访问某一台服务器这样是不能验证session是否配置成功。因为访问单独的服务器在浏览器输入的ip和端口是不一样的，浏览器是不会把访问其他服务器的cookie自动带上发送给服务器。所以通过单独访问每次打印的sessionId肯定是不一样的。","slug":"Nginx+Tomcat集群","published":1,"updated":"2016-05-13T13:44:39.914Z","layout":"post","photos":[],"link":"","_id":"cio5uhgmn0003o0ybkqnkf09x","content":"<h2 id=\"环境\"><a href=\"#环境\" class=\"headerlink\" title=\"环境\"></a>环境</h2><table>\n<thead>\n<tr>\n<th style=\"text-align:center\">系统</th>\n<th style=\"text-align:center\">JDK</th>\n<th style=\"text-align:center\">Tomcat</th>\n<th style=\"text-align:center\">Nginx</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">CentOS6 192.168.1.231 CentOS6 192.168.1.232</td>\n<td style=\"text-align:center\">JDK1.6</td>\n<td style=\"text-align:center\">Tomcat6</td>\n<td style=\"text-align:center\">nginx-release-centos-6-0.el6.ngx.noarch.rpm</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"安装JDK\"><a href=\"#安装JDK\" class=\"headerlink\" title=\"安装JDK\"></a>安装JDK</h2><p>第一步：检查是否已经安装了jdk 存在就卸载 rpm -e 包名<br><a id=\"more\"></a><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell rpm -qa | grep java*</span><br></pre></td></tr></table></figure></p>\n<p>第二步：查看yum库是否有java安装包<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell  yum -y list java*</span><br></pre></td></tr></table></figure></p>\n<p>第三步：选择一个进行安装<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell yum -y install java-1.6.0-openjdk*</span><br></pre></td></tr></table></figure></p>\n<p>第四步：确定是否安装成功<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell java -version</span><br><span class=\"line\">java version &quot;1.6.0_20&quot;</span><br><span class=\"line\">OpenJDK Runtime Environment (IcedTea6 1.9.10) (rhel-1.23.1.9.10.el5_7-i386)</span><br><span class=\"line\">OpenJDK Client VM (build 19.0-b09, mixed mode)</span><br><span class=\"line\">显示如上信息表示安装成功</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"安装Nginx\"><a href=\"#安装Nginx\" class=\"headerlink\" title=\"安装Nginx\"></a>安装Nginx</h2><p><strong><em>通过yum安装nginx 针对 CentOS系统 其他版本可能会存在差异</em></strong></p>\n<h3 id=\"下载安装包\"><a href=\"#下载安装包\" class=\"headerlink\" title=\"下载安装包\"></a>下载安装包</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell rpm -ivh http://nginx.org/packages/centos/6/noarch/RPMS/nginx-release-centos-6-0.el6.ngx.noarch.rpm</span><br></pre></td></tr></table></figure>\n<h3 id=\"查看nginx信息\"><a href=\"#查看nginx信息\" class=\"headerlink\" title=\"查看nginx信息\"></a>查看nginx信息</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell yum info nginx</span><br><span class=\"line\"></span><br><span class=\"line\">Loaded plugins: fastestmirror, refresh-packagekit, security</span><br><span class=\"line\">Loading mirror speeds from cached hostfile</span><br><span class=\"line\"> * base: mirrors.yun-idc.com</span><br><span class=\"line\"> * extras: mirrors.yun-idc.com</span><br><span class=\"line\"> * updates: mirrors.yun-idc.com</span><br><span class=\"line\">nginx                                                                    | 2.9 kB     00:00    </span><br><span class=\"line\">nginx/primary_db                                                         |  33 kB     00:00    </span><br><span class=\"line\">Available Packages</span><br><span class=\"line\">Name        : nginx</span><br><span class=\"line\">Arch        : i386</span><br><span class=\"line\">Version     : 1.6.2</span><br><span class=\"line\">Release     : 1.el6.ngx</span><br><span class=\"line\">Size        : 343 k</span><br><span class=\"line\">Repo        : nginx</span><br><span class=\"line\">Summary     : High performance web server</span><br><span class=\"line\">URL         : http://nginx.org/</span><br><span class=\"line\">License     : 2-clause BSD-like license</span><br><span class=\"line\">Description : nginx [engine x] is an HTTP and reverse proxy server, as well as</span><br><span class=\"line\">            : a mail proxy server.</span><br></pre></td></tr></table></figure>\n<h3 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell yum install nginx</span><br></pre></td></tr></table></figure>\n<h3 id=\"启动\"><a href=\"#启动\" class=\"headerlink\" title=\"启动\"></a>启动</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell service nginx start</span><br></pre></td></tr></table></figure>\n<h3 id=\"访问\"><a href=\"#访问\" class=\"headerlink\" title=\"访问\"></a>访问</h3><p><a href=\"http://ip\" target=\"_blank\" rel=\"external\">http://ip</a></p>\n<p>查找nginx安装目录<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell ps -ef |grep nginx</span><br><span class=\"line\">root      2244     1  0 22:45 ?        00:00:00 nginx: master process /usr/sbin/nginx -c /etc/nginx/nginx.conf</span><br><span class=\"line\">nginx     2245  2244  0 22:45 ?        00:00:00 nginx: worker process                  </span><br><span class=\"line\">root      2268  1922  0 22:50 pts/1    00:00:00 grep nginx</span><br></pre></td></tr></table></figure></p>\n<p><strong><em>如果不能连接到nginx，原因很多，但是可以先检查 1,nginx服务是否真的起来了；2,linux服务器防火墙是否打开</em></strong></p>\n<h2 id=\"安装Tomcat\"><a href=\"#安装Tomcat\" class=\"headerlink\" title=\"安装Tomcat\"></a>安装Tomcat</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell yum install tomcat6 tomcat6-webapps tomcat6-admin-webapps</span><br></pre></td></tr></table></figure>\n<h3 id=\"启动-1\"><a href=\"#启动-1\" class=\"headerlink\" title=\"启动\"></a>启动</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell service tomcat6 start</span><br></pre></td></tr></table></figure>\n<h3 id=\"启动-2\"><a href=\"#启动-2\" class=\"headerlink\" title=\"启动\"></a>启动</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell service tomcat6 stop</span><br></pre></td></tr></table></figure>\n<h3 id=\"重启\"><a href=\"#重启\" class=\"headerlink\" title=\"重启\"></a>重启</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell service tomcat6 restart</span><br></pre></td></tr></table></figure>\n<p>按照以上方法安装tomcat6默认目录在/usr/share/tomcat6/下<br>配置文件默认目录在/etc/tomcat6/下</p>\n<h2 id=\"集群配置\"><a href=\"#集群配置\" class=\"headerlink\" title=\"集群配置\"></a>集群配置</h2><h3 id=\"配置nginx-conf\"><a href=\"#配置nginx-conf\" class=\"headerlink\" title=\"配置nginx.conf\"></a>配置nginx.conf</h3><p><strong><em>在http{}中添加</em></strong><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">upstream cluster&#123;</span><br><span class=\"line\"> server 192.168.1.231:8080 weight=2;</span><br><span class=\"line\"> server 192.168.1.232:8080 weight=1;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>cluster这个名称可以随便起<br>weight参数表示权值，权值越高被分配到的几率越大<br>server 192.168.1.231:8080; 就是一个tomcat节点<br><strong><em>在server{}中添加如下配置 表示对于访问.jsp的页面使用代理服务器跳转到tomcat节点中</em></strong><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">location ~ \\.jsp$ &#123;</span><br><span class=\"line\">   proxy_pass   http://cluster;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>如果想对根进行设置只需要对</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">location / &#123;</span><br><span class=\"line\"> root   /usr/share/nginx/html;</span><br><span class=\"line\"> index  index.html index.html;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">修改为</span><br><span class=\"line\">location / &#123;</span><br><span class=\"line\"> proxy_set_header Host $host;</span><br><span class=\"line\"> proxy_pass  http://cluster;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">即可</span><br></pre></td></tr></table></figure>\n<p>复杂点的设置如下</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">location / &#123;</span><br><span class=\"line\"> proxy_pass  http://cluster;</span><br><span class=\"line\"> proxy_redirect          off;</span><br><span class=\"line\"> proxy_set_header        Host $host;</span><br><span class=\"line\"> proxy_set_header        X-Real-IP $remote_addr;</span><br><span class=\"line\"> proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class=\"line\"> client_max_body_size    10m;</span><br><span class=\"line\"> client_body_buffer_size 128k;</span><br><span class=\"line\"> proxy_connect_timeout   90;</span><br><span class=\"line\"> proxy_send_timeout      90;</span><br><span class=\"line\"> proxy_read_timeout      90;</span><br><span class=\"line\"> proxy_buffer_size       4k;</span><br><span class=\"line\"> proxy_buffers           4 32k;</span><br><span class=\"line\"> proxy_busy_buffers_size 64k;</span><br><span class=\"line\"> proxy_temp_file_write_size 64k;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"nginx-conf文件说明\"><a href=\"#nginx-conf文件说明\" class=\"headerlink\" title=\"nginx.conf文件说明\"></a>nginx.conf文件说明</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#nginx用户</span><br><span class=\"line\">user  nginx;</span><br><span class=\"line\">#nginx进程数字越大对于处理并发能力越强如果设置2就相当于开启了两个nginx</span><br><span class=\"line\">worker_processes  1;</span><br><span class=\"line\">#错误文件日志路径</span><br><span class=\"line\">error_log  /var/log/nginx/error.log warn;</span><br><span class=\"line\">pid        /var/run/nginx.pid;</span><br><span class=\"line\">#对应每个processes允许最大的连接数</span><br><span class=\"line\">events &#123;</span><br><span class=\"line\">    worker_connections  1024;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">http &#123;</span><br><span class=\"line\">    include       /etc/nginx/mime.types;</span><br><span class=\"line\">    default_type  application/octet-stream;</span><br><span class=\"line\">    log_format  main  &apos;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &apos;</span><br><span class=\"line\">                      &apos;$status $body_bytes_sent &quot;$http_referer&quot; &apos;</span><br><span class=\"line\">                      &apos;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&apos;;</span><br><span class=\"line\"></span><br><span class=\"line\">    access_log  /var/log/nginx/access.log  main;</span><br><span class=\"line\">    sendfile        on;</span><br><span class=\"line\">    #tcp_nopush     on;</span><br><span class=\"line\">    keepalive_timeout  65;</span><br><span class=\"line\">    #gzip  on;</span><br><span class=\"line\">\t#负载均衡控制 server 对应集群的一个个节点weight表示权重值数字越大出现的次数越多</span><br><span class=\"line\">\tupstream cluster&#123;</span><br><span class=\"line\">\t  server 192.168.1.231:8080 weight=1;</span><br><span class=\"line\">\t  server 192.168.1.240:8080 weight=2;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t#nginx服务器配置</span><br><span class=\"line\">    server &#123;</span><br><span class=\"line\">\t\t#监听端口</span><br><span class=\"line\">\t\tlisten       80;</span><br><span class=\"line\">\t\t#服务器名称</span><br><span class=\"line\">\t    server_name  localhost;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t#charset koi8-r;</span><br><span class=\"line\">\t\t#access_log  /var/log/nginx/log/host.access.log  main;</span><br><span class=\"line\">\t    #对于请求跟路径时候的处理</span><br><span class=\"line\">\t\tlocation / &#123;</span><br><span class=\"line\">\t\t   root   /usr/share/nginx/html;</span><br><span class=\"line\">\t\t   index  index.html index.htm;</span><br><span class=\"line\">\t\t   proxy_set_header Host $host;</span><br><span class=\"line\">\t\t   proxy_pass  http://cluster;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t    #error_page  404              /404.html;</span><br><span class=\"line\"></span><br><span class=\"line\">\t    # redirect server error pages to the static page /50x.html</span><br><span class=\"line\"></span><br><span class=\"line\">\t    error_page   500 502 503 504  /50x.html;</span><br><span class=\"line\">\t    location = /50x.html &#123;</span><br><span class=\"line\">\t\t\troot   /usr/share/nginx/html;</span><br><span class=\"line\">\t\t\t#proxy_pass   http://cluster;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t    #设置对于请求jsp时候的处理</span><br><span class=\"line\">\t    location ~ \\.jsp$ &#123;</span><br><span class=\"line\">\t\t\tproxy_pass   http://cluster;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t    # proxy the PHP scripts to Apache listening on 127.0.0.1:80</span><br><span class=\"line\">\t    #</span><br><span class=\"line\">\t    #location ~ \\.php$ &#123;</span><br><span class=\"line\">\t    #    proxy_pass   http://127.0.0.1;</span><br><span class=\"line\">\t    #&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t    # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span><br><span class=\"line\">\t    #</span><br><span class=\"line\">\t    #location ~ \\.php$ &#123;</span><br><span class=\"line\">\t    #    root           html;</span><br><span class=\"line\">\t    #    fastcgi_pass   127.0.0.1:9000;</span><br><span class=\"line\">\t    #    fastcgi_index  index.php;</span><br><span class=\"line\">\t    #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span><br><span class=\"line\">\t    #    include        fastcgi_params;</span><br><span class=\"line\">\t    #&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t    # deny access to .htaccess files, if Apache&apos;s document root</span><br><span class=\"line\">\t    # concurs with nginx&apos;s one</span><br><span class=\"line\">\t    #</span><br><span class=\"line\">\t    #location ~ /\\.ht &#123;</span><br><span class=\"line\">\t    #    deny  all;</span><br><span class=\"line\">\t    #&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"Tomcat配置\"><a href=\"#Tomcat配置\" class=\"headerlink\" title=\"Tomcat配置\"></a>Tomcat配置</h3><p>打开tomcat的文档查看集群说明将集群配置如下 复制到tomcat\\conf\\server.xml文件 Engine节点下添加如下配置<a href=\"https://tomcat.apache.org/tomcat-6.0-doc/cluster-howto.html\" target=\"_blank\" rel=\"external\">具体说明查看官方文档</a><br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">Cluster</span> <span class=\"attr\">className</span>=<span class=\"string\">\"org.apache.catalina.ha.tcp.SimpleTcpCluster\"</span></span><br><span class=\"line\">\t\t\t <span class=\"attr\">channelSendOptions</span>=<span class=\"string\">\"8\"</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Manager</span> <span class=\"attr\">className</span>=<span class=\"string\">\"org.apache.catalina.ha.session.DeltaManager\"</span></span><br><span class=\"line\">\t\t   <span class=\"attr\">expireSessionsOnShutdown</span>=<span class=\"string\">\"false\"</span></span><br><span class=\"line\">\t\t   <span class=\"attr\">notifyListenersOnReplication</span>=<span class=\"string\">\"true\"</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Channel</span> <span class=\"attr\">className</span>=<span class=\"string\">\"org.apache.catalina.tribes.group.GroupChannel\"</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">Membership</span> <span class=\"attr\">className</span>=<span class=\"string\">\"org.apache.catalina.tribes.membership.McastService\"</span></span><br><span class=\"line\">\t\t\t\t<span class=\"attr\">address</span>=<span class=\"string\">\"228.0.0.4\"</span></span><br><span class=\"line\">\t\t\t\t<span class=\"attr\">port</span>=<span class=\"string\">\"45564\"</span></span><br><span class=\"line\">\t\t\t\t<span class=\"attr\">frequency</span>=<span class=\"string\">\"500\"</span></span><br><span class=\"line\">\t\t\t\t<span class=\"attr\">dropTime</span>=<span class=\"string\">\"3000\"</span>/&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">Receiver</span> <span class=\"attr\">className</span>=<span class=\"string\">\"org.apache.catalina.tribes.transport.nio.NioReceiver\"</span></span><br><span class=\"line\">\t\t\t  <span class=\"attr\">address</span>=<span class=\"string\">\"auto\"</span></span><br><span class=\"line\">\t\t\t  <span class=\"attr\">port</span>=<span class=\"string\">\"4000\"</span></span><br><span class=\"line\">\t\t\t  <span class=\"attr\">autoBind</span>=<span class=\"string\">\"100\"</span></span><br><span class=\"line\">\t\t\t  <span class=\"attr\">selectorTimeout</span>=<span class=\"string\">\"5000\"</span></span><br><span class=\"line\">\t\t\t  <span class=\"attr\">maxThreads</span>=<span class=\"string\">\"6\"</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">Sender</span> <span class=\"attr\">className</span>=<span class=\"string\">\"org.apache.catalina.tribes.transport.ReplicationTransmitter\"</span>&gt;</span></span><br><span class=\"line\">\t  <span class=\"tag\">&lt;<span class=\"name\">Transport</span> <span class=\"attr\">className</span>=<span class=\"string\">\"org.apache.catalina.tribes.transport.nio.PooledParallelSender\"</span>/&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">Sender</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">Interceptor</span> <span class=\"attr\">className</span>=<span class=\"string\">\"org.apache.catalina.tribes.group.interceptors.TcpFailureDetector\"</span>/&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">Interceptor</span> <span class=\"attr\">className</span>=<span class=\"string\">\"org.apache.catalina.tribes.group.interceptors.MessageDispatch15Interceptor\"</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">Channel</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Valve</span> <span class=\"attr\">className</span>=<span class=\"string\">\"org.apache.catalina.ha.tcp.ReplicationValve\"</span></span><br><span class=\"line\">\t\t <span class=\"attr\">filter</span>=<span class=\"string\">\"\"</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Valve</span> <span class=\"attr\">className</span>=<span class=\"string\">\"org.apache.catalina.ha.session.JvmRouteBinderValve\"</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Deployer</span> <span class=\"attr\">className</span>=<span class=\"string\">\"org.apache.catalina.ha.deploy.FarmWarDeployer\"</span></span><br><span class=\"line\">\t\t\t<span class=\"attr\">tempDir</span>=<span class=\"string\">\"/tmp/war-temp/\"</span></span><br><span class=\"line\">\t\t\t<span class=\"attr\">deployDir</span>=<span class=\"string\">\"/tmp/war-deploy/\"</span></span><br><span class=\"line\">\t\t\t<span class=\"attr\">watchDir</span>=<span class=\"string\">\"/tmp/war-listen/\"</span></span><br><span class=\"line\">\t\t\t<span class=\"attr\">watchEnabled</span>=<span class=\"string\">\"false\"</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">ClusterListener</span> <span class=\"attr\">className</span>=<span class=\"string\">\"org.apache.catalina.ha.session.JvmRouteSessionIDBinderListener\"</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">ClusterListener</span> <span class=\"attr\">className</span>=<span class=\"string\">\"org.apache.catalina.ha.session.ClusterSessionListener\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">Cluster</span>&gt;</span></span><br></pre></td></tr></table></figure></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">将</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Engine</span> <span class=\"attr\">name</span>=<span class=\"string\">\"Catalina\"</span> <span class=\"attr\">defaultHost</span>=<span class=\"string\">\"localhost\"</span>&gt;</span> </span><br><span class=\"line\">添加jvmRoute属性</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Engine</span> <span class=\"attr\">name</span>=<span class=\"string\">\"Catalina\"</span> <span class=\"attr\">defaultHost</span>=<span class=\"string\">\"localhost\"</span> <span class=\"attr\">jvmRoute</span>=<span class=\"string\">\"node01\"</span> &gt;</span> </span><br><span class=\"line\">注意其他节点JvmRoute要分别不一样</span><br></pre></td></tr></table></figure>\n<p>在将应用的web.xml 文件末尾添加  distributable元素 如下表示这个应用下的session是可以共享的<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">web-app</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">distributable</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure></p>\n<p>然后启动服务器发现控制台打印<br><img src=\"003vMReezy6OUXDo7kt61&amp;690.jpg\" alt=\"控制台打印\"><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">信息: Manager [localhost#/demo]: skipping state transfer. No members active in cluster group.</span><br><span class=\"line\">一月 04, 2015 7:55:30 下午 org.apache.catalina.tribes.transport.ReceiverBase bind</span><br><span class=\"line\">信息: Receiver Server Socket bound to:/127.0.0.1:4000</span><br><span class=\"line\">一月 04, 2015 7:56:34 下午 org.apache.catalina.ha.session.DeltaManager getAllClusterSessions</span><br><span class=\"line\">警告: Manager [localhost#/demo]: Drop message SESSION-GET-ALL inside GET_ALL_SESSIONS sync phase start date 15-1-4 下午7:55 message date 70-1-1 上午8:00</span><br></pre></td></tr></table></figure></p>\n<p>表示没有发现其他的集群中的其他节点。接受Socket bind的IP是127.0.0.1所以我们需要将他改为局域网的IP<br>将节点Receiver 属性address=”auto”改为服务器局域网IP如下；其他节点也要做相应的改动<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Receiver</span> <span class=\"attr\">className</span>=<span class=\"string\">\"org.apache.catalina.tribes.transport.nio.NioReceiver\"</span></span><br><span class=\"line\">\t\t  <span class=\"attr\">address</span>=<span class=\"string\">\"192.168.1.231\"</span></span><br><span class=\"line\">\t\t  <span class=\"attr\">port</span>=<span class=\"string\">\"4000\"</span></span><br><span class=\"line\">\t\t  <span class=\"attr\">autoBind</span>=<span class=\"string\">\"100\"</span></span><br><span class=\"line\">\t\t  <span class=\"attr\">selectorTimeout</span>=<span class=\"string\">\"5000\"</span></span><br><span class=\"line\">\t\t  <span class=\"attr\">maxThreads</span>=<span class=\"string\">\"6\"</span>/&gt;</span></span><br></pre></td></tr></table></figure></p>\n<p>再次启动服务器发现可以找到了其他的节点了</p>\n<p>然后启动nginx 访问nginx <a href=\"http://192.168.1.228/demo/分别打印\" target=\"_blank\" rel=\"external\">http://192.168.1.228/demo/分别打印</a><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Hello World DF53CB7748D8BC67E0AB8A9BBA13048F.node2</span><br><span class=\"line\">Hello World DF53CB7748D8BC67E0AB8A9BBA13048F.node1</span><br></pre></td></tr></table></figure></p>\n<p>可以看出在node2节点设置的 Hello World在node1、node2上分别获取到了表示配置tomcat的session共享已经成功，如果仅是sessionId相同并不能表示session共享成功，因为通过一个相同的IP和端口访问的服务器都会把cookie中的sessionid发送给服务器。</p>\n<p><strong><em>注意：</em></strong><br>不要单独去访问某一台服务器这样是不能验证session是否配置成功。因为访问单独的服务器在浏览器输入的ip和端口是不一样的，浏览器是不会把访问其他服务器的cookie自动带上发送给服务器。所以通过单独访问每次打印的sessionId肯定是不一样的。</p>\n","excerpt":"<h2 id=\"环境\"><a href=\"#环境\" class=\"headerlink\" title=\"环境\"></a>环境</h2><table>\n<thead>\n<tr>\n<th style=\"text-align:center\">系统</th>\n<th style=\"text-align:center\">JDK</th>\n<th style=\"text-align:center\">Tomcat</th>\n<th style=\"text-align:center\">Nginx</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">CentOS6 192.168.1.231 CentOS6 192.168.1.232</td>\n<td style=\"text-align:center\">JDK1.6</td>\n<td style=\"text-align:center\">Tomcat6</td>\n<td style=\"text-align:center\">nginx-release-centos-6-0.el6.ngx.noarch.rpm</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"安装JDK\"><a href=\"#安装JDK\" class=\"headerlink\" title=\"安装JDK\"></a>安装JDK</h2><p>第一步：检查是否已经安装了jdk 存在就卸载 rpm -e 包名<br>","more":"<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell rpm -qa | grep java*</span><br></pre></td></tr></table></figure></p>\n<p>第二步：查看yum库是否有java安装包<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell  yum -y list java*</span><br></pre></td></tr></table></figure></p>\n<p>第三步：选择一个进行安装<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell yum -y install java-1.6.0-openjdk*</span><br></pre></td></tr></table></figure></p>\n<p>第四步：确定是否安装成功<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell java -version</span><br><span class=\"line\">java version &quot;1.6.0_20&quot;</span><br><span class=\"line\">OpenJDK Runtime Environment (IcedTea6 1.9.10) (rhel-1.23.1.9.10.el5_7-i386)</span><br><span class=\"line\">OpenJDK Client VM (build 19.0-b09, mixed mode)</span><br><span class=\"line\">显示如上信息表示安装成功</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"安装Nginx\"><a href=\"#安装Nginx\" class=\"headerlink\" title=\"安装Nginx\"></a>安装Nginx</h2><p><strong><em>通过yum安装nginx 针对 CentOS系统 其他版本可能会存在差异</em></strong></p>\n<h3 id=\"下载安装包\"><a href=\"#下载安装包\" class=\"headerlink\" title=\"下载安装包\"></a>下载安装包</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell rpm -ivh http://nginx.org/packages/centos/6/noarch/RPMS/nginx-release-centos-6-0.el6.ngx.noarch.rpm</span><br></pre></td></tr></table></figure>\n<h3 id=\"查看nginx信息\"><a href=\"#查看nginx信息\" class=\"headerlink\" title=\"查看nginx信息\"></a>查看nginx信息</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell yum info nginx</span><br><span class=\"line\"></span><br><span class=\"line\">Loaded plugins: fastestmirror, refresh-packagekit, security</span><br><span class=\"line\">Loading mirror speeds from cached hostfile</span><br><span class=\"line\"> * base: mirrors.yun-idc.com</span><br><span class=\"line\"> * extras: mirrors.yun-idc.com</span><br><span class=\"line\"> * updates: mirrors.yun-idc.com</span><br><span class=\"line\">nginx                                                                    | 2.9 kB     00:00    </span><br><span class=\"line\">nginx/primary_db                                                         |  33 kB     00:00    </span><br><span class=\"line\">Available Packages</span><br><span class=\"line\">Name        : nginx</span><br><span class=\"line\">Arch        : i386</span><br><span class=\"line\">Version     : 1.6.2</span><br><span class=\"line\">Release     : 1.el6.ngx</span><br><span class=\"line\">Size        : 343 k</span><br><span class=\"line\">Repo        : nginx</span><br><span class=\"line\">Summary     : High performance web server</span><br><span class=\"line\">URL         : http://nginx.org/</span><br><span class=\"line\">License     : 2-clause BSD-like license</span><br><span class=\"line\">Description : nginx [engine x] is an HTTP and reverse proxy server, as well as</span><br><span class=\"line\">            : a mail proxy server.</span><br></pre></td></tr></table></figure>\n<h3 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell yum install nginx</span><br></pre></td></tr></table></figure>\n<h3 id=\"启动\"><a href=\"#启动\" class=\"headerlink\" title=\"启动\"></a>启动</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell service nginx start</span><br></pre></td></tr></table></figure>\n<h3 id=\"访问\"><a href=\"#访问\" class=\"headerlink\" title=\"访问\"></a>访问</h3><p><a href=\"http://ip\">http://ip</a></p>\n<p>查找nginx安装目录<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell ps -ef |grep nginx</span><br><span class=\"line\">root      2244     1  0 22:45 ?        00:00:00 nginx: master process /usr/sbin/nginx -c /etc/nginx/nginx.conf</span><br><span class=\"line\">nginx     2245  2244  0 22:45 ?        00:00:00 nginx: worker process                  </span><br><span class=\"line\">root      2268  1922  0 22:50 pts/1    00:00:00 grep nginx</span><br></pre></td></tr></table></figure></p>\n<p><strong><em>如果不能连接到nginx，原因很多，但是可以先检查 1,nginx服务是否真的起来了；2,linux服务器防火墙是否打开</em></strong></p>\n<h2 id=\"安装Tomcat\"><a href=\"#安装Tomcat\" class=\"headerlink\" title=\"安装Tomcat\"></a>安装Tomcat</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell yum install tomcat6 tomcat6-webapps tomcat6-admin-webapps</span><br></pre></td></tr></table></figure>\n<h3 id=\"启动-1\"><a href=\"#启动-1\" class=\"headerlink\" title=\"启动\"></a>启动</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell service tomcat6 start</span><br></pre></td></tr></table></figure>\n<h3 id=\"启动-2\"><a href=\"#启动-2\" class=\"headerlink\" title=\"启动\"></a>启动</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell service tomcat6 stop</span><br></pre></td></tr></table></figure>\n<h3 id=\"重启\"><a href=\"#重启\" class=\"headerlink\" title=\"重启\"></a>重启</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shell service tomcat6 restart</span><br></pre></td></tr></table></figure>\n<p>按照以上方法安装tomcat6默认目录在/usr/share/tomcat6/下<br>配置文件默认目录在/etc/tomcat6/下</p>\n<h2 id=\"集群配置\"><a href=\"#集群配置\" class=\"headerlink\" title=\"集群配置\"></a>集群配置</h2><h3 id=\"配置nginx-conf\"><a href=\"#配置nginx-conf\" class=\"headerlink\" title=\"配置nginx.conf\"></a>配置nginx.conf</h3><p><strong><em>在http{}中添加</em></strong><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">upstream cluster&#123;</span><br><span class=\"line\"> server 192.168.1.231:8080 weight=2;</span><br><span class=\"line\"> server 192.168.1.232:8080 weight=1;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>cluster这个名称可以随便起<br>weight参数表示权值，权值越高被分配到的几率越大<br>server 192.168.1.231:8080; 就是一个tomcat节点<br><strong><em>在server{}中添加如下配置 表示对于访问.jsp的页面使用代理服务器跳转到tomcat节点中</em></strong><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">location ~ \\.jsp$ &#123;</span><br><span class=\"line\">   proxy_pass   http://cluster;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>如果想对根进行设置只需要对</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">location / &#123;</span><br><span class=\"line\"> root   /usr/share/nginx/html;</span><br><span class=\"line\"> index  index.html index.html;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">修改为</span><br><span class=\"line\">location / &#123;</span><br><span class=\"line\"> proxy_set_header Host $host;</span><br><span class=\"line\"> proxy_pass  http://cluster;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">即可</span><br></pre></td></tr></table></figure>\n<p>复杂点的设置如下</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">location / &#123;</span><br><span class=\"line\"> proxy_pass  http://cluster;</span><br><span class=\"line\"> proxy_redirect          off;</span><br><span class=\"line\"> proxy_set_header        Host $host;</span><br><span class=\"line\"> proxy_set_header        X-Real-IP $remote_addr;</span><br><span class=\"line\"> proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class=\"line\"> client_max_body_size    10m;</span><br><span class=\"line\"> client_body_buffer_size 128k;</span><br><span class=\"line\"> proxy_connect_timeout   90;</span><br><span class=\"line\"> proxy_send_timeout      90;</span><br><span class=\"line\"> proxy_read_timeout      90;</span><br><span class=\"line\"> proxy_buffer_size       4k;</span><br><span class=\"line\"> proxy_buffers           4 32k;</span><br><span class=\"line\"> proxy_busy_buffers_size 64k;</span><br><span class=\"line\"> proxy_temp_file_write_size 64k;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"nginx-conf文件说明\"><a href=\"#nginx-conf文件说明\" class=\"headerlink\" title=\"nginx.conf文件说明\"></a>nginx.conf文件说明</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#nginx用户</span><br><span class=\"line\">user  nginx;</span><br><span class=\"line\">#nginx进程数字越大对于处理并发能力越强如果设置2就相当于开启了两个nginx</span><br><span class=\"line\">worker_processes  1;</span><br><span class=\"line\">#错误文件日志路径</span><br><span class=\"line\">error_log  /var/log/nginx/error.log warn;</span><br><span class=\"line\">pid        /var/run/nginx.pid;</span><br><span class=\"line\">#对应每个processes允许最大的连接数</span><br><span class=\"line\">events &#123;</span><br><span class=\"line\">    worker_connections  1024;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">http &#123;</span><br><span class=\"line\">    include       /etc/nginx/mime.types;</span><br><span class=\"line\">    default_type  application/octet-stream;</span><br><span class=\"line\">    log_format  main  &apos;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &apos;</span><br><span class=\"line\">                      &apos;$status $body_bytes_sent &quot;$http_referer&quot; &apos;</span><br><span class=\"line\">                      &apos;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&apos;;</span><br><span class=\"line\"></span><br><span class=\"line\">    access_log  /var/log/nginx/access.log  main;</span><br><span class=\"line\">    sendfile        on;</span><br><span class=\"line\">    #tcp_nopush     on;</span><br><span class=\"line\">    keepalive_timeout  65;</span><br><span class=\"line\">    #gzip  on;</span><br><span class=\"line\">\t#负载均衡控制 server 对应集群的一个个节点weight表示权重值数字越大出现的次数越多</span><br><span class=\"line\">\tupstream cluster&#123;</span><br><span class=\"line\">\t  server 192.168.1.231:8080 weight=1;</span><br><span class=\"line\">\t  server 192.168.1.240:8080 weight=2;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t#nginx服务器配置</span><br><span class=\"line\">    server &#123;</span><br><span class=\"line\">\t\t#监听端口</span><br><span class=\"line\">\t\tlisten       80;</span><br><span class=\"line\">\t\t#服务器名称</span><br><span class=\"line\">\t    server_name  localhost;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t#charset koi8-r;</span><br><span class=\"line\">\t\t#access_log  /var/log/nginx/log/host.access.log  main;</span><br><span class=\"line\">\t    #对于请求跟路径时候的处理</span><br><span class=\"line\">\t\tlocation / &#123;</span><br><span class=\"line\">\t\t   root   /usr/share/nginx/html;</span><br><span class=\"line\">\t\t   index  index.html index.htm;</span><br><span class=\"line\">\t\t   proxy_set_header Host $host;</span><br><span class=\"line\">\t\t   proxy_pass  http://cluster;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t    #error_page  404              /404.html;</span><br><span class=\"line\"></span><br><span class=\"line\">\t    # redirect server error pages to the static page /50x.html</span><br><span class=\"line\"></span><br><span class=\"line\">\t    error_page   500 502 503 504  /50x.html;</span><br><span class=\"line\">\t    location = /50x.html &#123;</span><br><span class=\"line\">\t\t\troot   /usr/share/nginx/html;</span><br><span class=\"line\">\t\t\t#proxy_pass   http://cluster;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t    #设置对于请求jsp时候的处理</span><br><span class=\"line\">\t    location ~ \\.jsp$ &#123;</span><br><span class=\"line\">\t\t\tproxy_pass   http://cluster;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t    # proxy the PHP scripts to Apache listening on 127.0.0.1:80</span><br><span class=\"line\">\t    #</span><br><span class=\"line\">\t    #location ~ \\.php$ &#123;</span><br><span class=\"line\">\t    #    proxy_pass   http://127.0.0.1;</span><br><span class=\"line\">\t    #&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t    # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span><br><span class=\"line\">\t    #</span><br><span class=\"line\">\t    #location ~ \\.php$ &#123;</span><br><span class=\"line\">\t    #    root           html;</span><br><span class=\"line\">\t    #    fastcgi_pass   127.0.0.1:9000;</span><br><span class=\"line\">\t    #    fastcgi_index  index.php;</span><br><span class=\"line\">\t    #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span><br><span class=\"line\">\t    #    include        fastcgi_params;</span><br><span class=\"line\">\t    #&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t    # deny access to .htaccess files, if Apache&apos;s document root</span><br><span class=\"line\">\t    # concurs with nginx&apos;s one</span><br><span class=\"line\">\t    #</span><br><span class=\"line\">\t    #location ~ /\\.ht &#123;</span><br><span class=\"line\">\t    #    deny  all;</span><br><span class=\"line\">\t    #&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"Tomcat配置\"><a href=\"#Tomcat配置\" class=\"headerlink\" title=\"Tomcat配置\"></a>Tomcat配置</h3><p>打开tomcat的文档查看集群说明将集群配置如下 复制到tomcat\\conf\\server.xml文件 Engine节点下添加如下配置<a href=\"https://tomcat.apache.org/tomcat-6.0-doc/cluster-howto.html\">具体说明查看官方文档</a><br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">Cluster</span> <span class=\"attr\">className</span>=<span class=\"string\">\"org.apache.catalina.ha.tcp.SimpleTcpCluster\"</span></span><br><span class=\"line\">\t\t\t <span class=\"attr\">channelSendOptions</span>=<span class=\"string\">\"8\"</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Manager</span> <span class=\"attr\">className</span>=<span class=\"string\">\"org.apache.catalina.ha.session.DeltaManager\"</span></span><br><span class=\"line\">\t\t   <span class=\"attr\">expireSessionsOnShutdown</span>=<span class=\"string\">\"false\"</span></span><br><span class=\"line\">\t\t   <span class=\"attr\">notifyListenersOnReplication</span>=<span class=\"string\">\"true\"</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Channel</span> <span class=\"attr\">className</span>=<span class=\"string\">\"org.apache.catalina.tribes.group.GroupChannel\"</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">Membership</span> <span class=\"attr\">className</span>=<span class=\"string\">\"org.apache.catalina.tribes.membership.McastService\"</span></span><br><span class=\"line\">\t\t\t\t<span class=\"attr\">address</span>=<span class=\"string\">\"228.0.0.4\"</span></span><br><span class=\"line\">\t\t\t\t<span class=\"attr\">port</span>=<span class=\"string\">\"45564\"</span></span><br><span class=\"line\">\t\t\t\t<span class=\"attr\">frequency</span>=<span class=\"string\">\"500\"</span></span><br><span class=\"line\">\t\t\t\t<span class=\"attr\">dropTime</span>=<span class=\"string\">\"3000\"</span>/&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">Receiver</span> <span class=\"attr\">className</span>=<span class=\"string\">\"org.apache.catalina.tribes.transport.nio.NioReceiver\"</span></span><br><span class=\"line\">\t\t\t  <span class=\"attr\">address</span>=<span class=\"string\">\"auto\"</span></span><br><span class=\"line\">\t\t\t  <span class=\"attr\">port</span>=<span class=\"string\">\"4000\"</span></span><br><span class=\"line\">\t\t\t  <span class=\"attr\">autoBind</span>=<span class=\"string\">\"100\"</span></span><br><span class=\"line\">\t\t\t  <span class=\"attr\">selectorTimeout</span>=<span class=\"string\">\"5000\"</span></span><br><span class=\"line\">\t\t\t  <span class=\"attr\">maxThreads</span>=<span class=\"string\">\"6\"</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">Sender</span> <span class=\"attr\">className</span>=<span class=\"string\">\"org.apache.catalina.tribes.transport.ReplicationTransmitter\"</span>&gt;</span></span><br><span class=\"line\">\t  <span class=\"tag\">&lt;<span class=\"name\">Transport</span> <span class=\"attr\">className</span>=<span class=\"string\">\"org.apache.catalina.tribes.transport.nio.PooledParallelSender\"</span>/&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">Sender</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">Interceptor</span> <span class=\"attr\">className</span>=<span class=\"string\">\"org.apache.catalina.tribes.group.interceptors.TcpFailureDetector\"</span>/&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">Interceptor</span> <span class=\"attr\">className</span>=<span class=\"string\">\"org.apache.catalina.tribes.group.interceptors.MessageDispatch15Interceptor\"</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">Channel</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Valve</span> <span class=\"attr\">className</span>=<span class=\"string\">\"org.apache.catalina.ha.tcp.ReplicationValve\"</span></span><br><span class=\"line\">\t\t <span class=\"attr\">filter</span>=<span class=\"string\">\"\"</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Valve</span> <span class=\"attr\">className</span>=<span class=\"string\">\"org.apache.catalina.ha.session.JvmRouteBinderValve\"</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">Deployer</span> <span class=\"attr\">className</span>=<span class=\"string\">\"org.apache.catalina.ha.deploy.FarmWarDeployer\"</span></span><br><span class=\"line\">\t\t\t<span class=\"attr\">tempDir</span>=<span class=\"string\">\"/tmp/war-temp/\"</span></span><br><span class=\"line\">\t\t\t<span class=\"attr\">deployDir</span>=<span class=\"string\">\"/tmp/war-deploy/\"</span></span><br><span class=\"line\">\t\t\t<span class=\"attr\">watchDir</span>=<span class=\"string\">\"/tmp/war-listen/\"</span></span><br><span class=\"line\">\t\t\t<span class=\"attr\">watchEnabled</span>=<span class=\"string\">\"false\"</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">ClusterListener</span> <span class=\"attr\">className</span>=<span class=\"string\">\"org.apache.catalina.ha.session.JvmRouteSessionIDBinderListener\"</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">ClusterListener</span> <span class=\"attr\">className</span>=<span class=\"string\">\"org.apache.catalina.ha.session.ClusterSessionListener\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">Cluster</span>&gt;</span></span><br></pre></td></tr></table></figure></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">将</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Engine</span> <span class=\"attr\">name</span>=<span class=\"string\">\"Catalina\"</span> <span class=\"attr\">defaultHost</span>=<span class=\"string\">\"localhost\"</span>&gt;</span> </span><br><span class=\"line\">添加jvmRoute属性</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Engine</span> <span class=\"attr\">name</span>=<span class=\"string\">\"Catalina\"</span> <span class=\"attr\">defaultHost</span>=<span class=\"string\">\"localhost\"</span> <span class=\"attr\">jvmRoute</span>=<span class=\"string\">\"node01\"</span> &gt;</span> </span><br><span class=\"line\">注意其他节点JvmRoute要分别不一样</span><br></pre></td></tr></table></figure>\n<p>在将应用的web.xml 文件末尾添加  distributable元素 如下表示这个应用下的session是可以共享的<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">web-app</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">distributable</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure></p>\n<p>然后启动服务器发现控制台打印<br><img src=\"003vMReezy6OUXDo7kt61&amp;690.jpg\" alt=\"控制台打印\"><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">信息: Manager [localhost#/demo]: skipping state transfer. No members active in cluster group.</span><br><span class=\"line\">一月 04, 2015 7:55:30 下午 org.apache.catalina.tribes.transport.ReceiverBase bind</span><br><span class=\"line\">信息: Receiver Server Socket bound to:/127.0.0.1:4000</span><br><span class=\"line\">一月 04, 2015 7:56:34 下午 org.apache.catalina.ha.session.DeltaManager getAllClusterSessions</span><br><span class=\"line\">警告: Manager [localhost#/demo]: Drop message SESSION-GET-ALL inside GET_ALL_SESSIONS sync phase start date 15-1-4 下午7:55 message date 70-1-1 上午8:00</span><br></pre></td></tr></table></figure></p>\n<p>表示没有发现其他的集群中的其他节点。接受Socket bind的IP是127.0.0.1所以我们需要将他改为局域网的IP<br>将节点Receiver 属性address=”auto”改为服务器局域网IP如下；其他节点也要做相应的改动<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">Receiver</span> <span class=\"attr\">className</span>=<span class=\"string\">\"org.apache.catalina.tribes.transport.nio.NioReceiver\"</span></span><br><span class=\"line\">\t\t  <span class=\"attr\">address</span>=<span class=\"string\">\"192.168.1.231\"</span></span><br><span class=\"line\">\t\t  <span class=\"attr\">port</span>=<span class=\"string\">\"4000\"</span></span><br><span class=\"line\">\t\t  <span class=\"attr\">autoBind</span>=<span class=\"string\">\"100\"</span></span><br><span class=\"line\">\t\t  <span class=\"attr\">selectorTimeout</span>=<span class=\"string\">\"5000\"</span></span><br><span class=\"line\">\t\t  <span class=\"attr\">maxThreads</span>=<span class=\"string\">\"6\"</span>/&gt;</span></span><br></pre></td></tr></table></figure></p>\n<p>再次启动服务器发现可以找到了其他的节点了</p>\n<p>然后启动nginx 访问nginx <a href=\"http://192.168.1.228/demo/分别打印\">http://192.168.1.228/demo/分别打印</a><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Hello World DF53CB7748D8BC67E0AB8A9BBA13048F.node2</span><br><span class=\"line\">Hello World DF53CB7748D8BC67E0AB8A9BBA13048F.node1</span><br></pre></td></tr></table></figure></p>\n<p>可以看出在node2节点设置的 Hello World在node1、node2上分别获取到了表示配置tomcat的session共享已经成功，如果仅是sessionId相同并不能表示session共享成功，因为通过一个相同的IP和端口访问的服务器都会把cookie中的sessionid发送给服务器。</p>\n<p><strong><em>注意：</em></strong><br>不要单独去访问某一台服务器这样是不能验证session是否配置成功。因为访问单独的服务器在浏览器输入的ip和端口是不一样的，浏览器是不会把访问其他服务器的cookie自动带上发送给服务器。所以通过单独访问每次打印的sessionId肯定是不一样的。</p>"},{"title":"浅谈BSF","date":"2013-01-30T13:28:01.000Z","comments":1,"toc":true,"_content":"\n### BSF是什么\n BSF(Bean Scripting Framework)是一个支持在java应用程序内调用脚本语言，并且支持脚本语言直接访问java对象和方法的一个开源项目，有了他，你能在你的java application中使用javascript、Python、XSLT、tcl等等。反过来也可以在script language中调用任何注册过了的javaBean、java Object 它提供了完整的API实现通过Java访问脚本语言的引擎。\n \n<!--more-->\n### 如何使用\n 在你的java 应用程序中导入bsf.jar包如果你使用的脚本是javascript那还需要导入js.jar包，其他脚本语言类似导入相对应的jar即可下面我就以javascript为列简单说明下BSF的使用将会已代码的形式展示给大家。\n \n### Java Bean中\n```java\npackage cn.com.bsf.test; \n         \npublic class BeanDemo{ \n     private String name; \n              \n     public void setName(String name){ \n         this.name=name; \n     } \n     public String getName(){ \n          return name \n     } \n} \n         \npackage cn.com.bsf.test; \nimport java.io.BufferedInputStream; \nimport java.io.BufferedReader; \nimport java.io.IOException; \nimport java.io.InputStream; \nimport java.io.InputStreamReader; \nimport java.util.HashMap; \nimport java.util.Map; \n         \nimport org.apache.bsf.BSFEngine; \nimport org.apache.bsf.BSFException; \nimport org.apache.bsf.BSFManager; \npublic class BSFExample{ \n         \n    public static void main(String[] args){ \n        BSFManager bsfManager= new BSFManager(); \n        BeanDemo demo= new BeanDemo(); \n        //在BSF中注册java bean \n        bsfManager.declareBean(\"demo\", demo, demo.getClass()); \n        bsfManager.declareBean(\"out\", System.out, System.out.getClass()); \n        //得到BSF引擎 \n        BSFEngine bsfEngine = bsfManager.loadScriptingEngine(\"javascript\"); \n        //读取js文件 \n        InputStream stream = BSFDemo.class.getResourceAsStream(\"/bsf_001.js\"); \n        InputStreamReader reader = new InputStreamReader(new BufferedInputStream(stream)); \n        BufferedReader bufR = new BufferedReader(reader); \n        StringBuffer sb = new StringBuffer(); \n        String content = bufR.readLine(); \n        while (content != null) { \n           sb.append(content); \n           content = bufR.readLine(); \n        } \n        bsfEngine.exec(\"javascript\", 0, 0, sb.toString()); \n       //执行脚本中的某个方法 \n        Object o = bsfEngine.eval(\"javascript\", 0, 0, \"test()\");  \n        Map map = (HashMap) o; \n        System.out.println(map.get(\"age\")); \n        System.out.println(demo.getName()); \n    } \n} \n```\n\n输出结果\n```\nhello world \n10\n张三\n```\n### 脚步\n*** bsf_001.js***\n```javascript\nimportPackage(java.util); \nfunction test(){ \n    reflection.setName(\"张三\"); \n    out.println(\"hello world\"); \n    var map = new HashMap(); \n    map.put(\"name\",\"张三\"); \n    map.put(\"age\",\"10\"); \n    return map; \n}\n```\n\n*** bsf_002.js***\n```javascript\nimportClass(Packages.cn.com.bsf.test.AppDemo); \nvar appDemo = new AppDemo(); \nvar str=appDemo.query(\"select * from bsf\"); \nout.println(str);\n```\nbsf_002.js与bsf_001.js的不同的是脚本代码没有包含在function中所以bsf执行稍微会有所不同\nObject o = bsfEngine.eval(\"javascript\", 0, 0, \"bsf_002.js的脚本内容\");\n\n不知道大家注意到了importClass、importPackage没有，下面我就解释下他们的用处\n\n***importClass 是在我们的脚本中引入我们的javaBean如果是jdk中自带的javaBea不需要packages关键字反之需要例如***\n***importClass(Packages.cn.com.bsf.test.BeanDemo);***\n***importClass(java.util.HashMap);***\n***importPackage是在我们的脚本中引入包 引入包后就可以使用这个包中所有javaBean其语法如下他会importClass类似自定义的java包需要加Packages为前缀。***\n***importPackage(Packages.cn.com.bsf.test）;***\n***importPackage(java.util);***\n","source":"_posts/浅谈BSF.md","raw":"---\ntitle: 浅谈BSF\ndate: 2013-01-30 21:28:01\ncomments: true\ncategories: BSF\ntoc: true \n---\n\n### BSF是什么\n BSF(Bean Scripting Framework)是一个支持在java应用程序内调用脚本语言，并且支持脚本语言直接访问java对象和方法的一个开源项目，有了他，你能在你的java application中使用javascript、Python、XSLT、tcl等等。反过来也可以在script language中调用任何注册过了的javaBean、java Object 它提供了完整的API实现通过Java访问脚本语言的引擎。\n \n<!--more-->\n### 如何使用\n 在你的java 应用程序中导入bsf.jar包如果你使用的脚本是javascript那还需要导入js.jar包，其他脚本语言类似导入相对应的jar即可下面我就以javascript为列简单说明下BSF的使用将会已代码的形式展示给大家。\n \n### Java Bean中\n```java\npackage cn.com.bsf.test; \n         \npublic class BeanDemo{ \n     private String name; \n              \n     public void setName(String name){ \n         this.name=name; \n     } \n     public String getName(){ \n          return name \n     } \n} \n         \npackage cn.com.bsf.test; \nimport java.io.BufferedInputStream; \nimport java.io.BufferedReader; \nimport java.io.IOException; \nimport java.io.InputStream; \nimport java.io.InputStreamReader; \nimport java.util.HashMap; \nimport java.util.Map; \n         \nimport org.apache.bsf.BSFEngine; \nimport org.apache.bsf.BSFException; \nimport org.apache.bsf.BSFManager; \npublic class BSFExample{ \n         \n    public static void main(String[] args){ \n        BSFManager bsfManager= new BSFManager(); \n        BeanDemo demo= new BeanDemo(); \n        //在BSF中注册java bean \n        bsfManager.declareBean(\"demo\", demo, demo.getClass()); \n        bsfManager.declareBean(\"out\", System.out, System.out.getClass()); \n        //得到BSF引擎 \n        BSFEngine bsfEngine = bsfManager.loadScriptingEngine(\"javascript\"); \n        //读取js文件 \n        InputStream stream = BSFDemo.class.getResourceAsStream(\"/bsf_001.js\"); \n        InputStreamReader reader = new InputStreamReader(new BufferedInputStream(stream)); \n        BufferedReader bufR = new BufferedReader(reader); \n        StringBuffer sb = new StringBuffer(); \n        String content = bufR.readLine(); \n        while (content != null) { \n           sb.append(content); \n           content = bufR.readLine(); \n        } \n        bsfEngine.exec(\"javascript\", 0, 0, sb.toString()); \n       //执行脚本中的某个方法 \n        Object o = bsfEngine.eval(\"javascript\", 0, 0, \"test()\");  \n        Map map = (HashMap) o; \n        System.out.println(map.get(\"age\")); \n        System.out.println(demo.getName()); \n    } \n} \n```\n\n输出结果\n```\nhello world \n10\n张三\n```\n### 脚步\n*** bsf_001.js***\n```javascript\nimportPackage(java.util); \nfunction test(){ \n    reflection.setName(\"张三\"); \n    out.println(\"hello world\"); \n    var map = new HashMap(); \n    map.put(\"name\",\"张三\"); \n    map.put(\"age\",\"10\"); \n    return map; \n}\n```\n\n*** bsf_002.js***\n```javascript\nimportClass(Packages.cn.com.bsf.test.AppDemo); \nvar appDemo = new AppDemo(); \nvar str=appDemo.query(\"select * from bsf\"); \nout.println(str);\n```\nbsf_002.js与bsf_001.js的不同的是脚本代码没有包含在function中所以bsf执行稍微会有所不同\nObject o = bsfEngine.eval(\"javascript\", 0, 0, \"bsf_002.js的脚本内容\");\n\n不知道大家注意到了importClass、importPackage没有，下面我就解释下他们的用处\n\n***importClass 是在我们的脚本中引入我们的javaBean如果是jdk中自带的javaBea不需要packages关键字反之需要例如***\n***importClass(Packages.cn.com.bsf.test.BeanDemo);***\n***importClass(java.util.HashMap);***\n***importPackage是在我们的脚本中引入包 引入包后就可以使用这个包中所有javaBean其语法如下他会importClass类似自定义的java包需要加Packages为前缀。***\n***importPackage(Packages.cn.com.bsf.test）;***\n***importPackage(java.util);***\n","slug":"浅谈BSF","published":1,"updated":"2016-05-13T14:35:46.795Z","layout":"post","photos":[],"link":"","_id":"cio5uhgn30004o0ybbrfbmeys","content":"<h3 id=\"BSF是什么\"><a href=\"#BSF是什么\" class=\"headerlink\" title=\"BSF是什么\"></a>BSF是什么</h3><p> BSF(Bean Scripting Framework)是一个支持在java应用程序内调用脚本语言，并且支持脚本语言直接访问java对象和方法的一个开源项目，有了他，你能在你的java application中使用javascript、Python、XSLT、tcl等等。反过来也可以在script language中调用任何注册过了的javaBean、java Object 它提供了完整的API实现通过Java访问脚本语言的引擎。</p>\n<a id=\"more\"></a>\n<h3 id=\"如何使用\"><a href=\"#如何使用\" class=\"headerlink\" title=\"如何使用\"></a>如何使用</h3><p> 在你的java 应用程序中导入bsf.jar包如果你使用的脚本是javascript那还需要导入js.jar包，其他脚本语言类似导入相对应的jar即可下面我就以javascript为列简单说明下BSF的使用将会已代码的形式展示给大家。</p>\n<h3 id=\"Java-Bean中\"><a href=\"#Java-Bean中\" class=\"headerlink\" title=\"Java Bean中\"></a>Java Bean中</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> cn.com.bsf.test; </span><br><span class=\"line\">         </span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BeanDemo</span></span>&#123; </span><br><span class=\"line\">     <span class=\"keyword\">private</span> String name; </span><br><span class=\"line\">              </span><br><span class=\"line\">     <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setName</span><span class=\"params\">(String name)</span></span>&#123; </span><br><span class=\"line\">         <span class=\"keyword\">this</span>.name=name; </span><br><span class=\"line\">     &#125; </span><br><span class=\"line\">     <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getName</span><span class=\"params\">()</span></span>&#123; </span><br><span class=\"line\">          <span class=\"keyword\">return</span> name </span><br><span class=\"line\">     &#125; </span><br><span class=\"line\">&#125; </span><br><span class=\"line\">         </span><br><span class=\"line\"><span class=\"keyword\">package</span> cn.com.bsf.test; </span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.BufferedInputStream; </span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.BufferedReader; </span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException; </span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.InputStream; </span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.InputStreamReader; </span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.HashMap; </span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Map; </span><br><span class=\"line\">         </span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.bsf.BSFEngine; </span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.bsf.BSFException; </span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.bsf.BSFManager; </span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BSFExample</span></span>&#123; </span><br><span class=\"line\">         </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123; </span><br><span class=\"line\">        BSFManager bsfManager= <span class=\"keyword\">new</span> BSFManager(); </span><br><span class=\"line\">        BeanDemo demo= <span class=\"keyword\">new</span> BeanDemo(); </span><br><span class=\"line\">        <span class=\"comment\">//在BSF中注册java bean </span></span><br><span class=\"line\">        bsfManager.declareBean(<span class=\"string\">\"demo\"</span>, demo, demo.getClass()); </span><br><span class=\"line\">        bsfManager.declareBean(<span class=\"string\">\"out\"</span>, System.out, System.out.getClass()); </span><br><span class=\"line\">        <span class=\"comment\">//得到BSF引擎 </span></span><br><span class=\"line\">        BSFEngine bsfEngine = bsfManager.loadScriptingEngine(<span class=\"string\">\"javascript\"</span>); </span><br><span class=\"line\">        <span class=\"comment\">//读取js文件 </span></span><br><span class=\"line\">        InputStream stream = BSFDemo.class.getResourceAsStream(<span class=\"string\">\"/bsf_001.js\"</span>); </span><br><span class=\"line\">        InputStreamReader reader = <span class=\"keyword\">new</span> InputStreamReader(<span class=\"keyword\">new</span> BufferedInputStream(stream)); </span><br><span class=\"line\">        BufferedReader bufR = <span class=\"keyword\">new</span> BufferedReader(reader); </span><br><span class=\"line\">        StringBuffer sb = <span class=\"keyword\">new</span> StringBuffer(); </span><br><span class=\"line\">        String content = bufR.readLine(); </span><br><span class=\"line\">        <span class=\"keyword\">while</span> (content != <span class=\"keyword\">null</span>) &#123; </span><br><span class=\"line\">           sb.append(content); </span><br><span class=\"line\">           content = bufR.readLine(); </span><br><span class=\"line\">        &#125; </span><br><span class=\"line\">        bsfEngine.exec(<span class=\"string\">\"javascript\"</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, sb.toString()); </span><br><span class=\"line\">       <span class=\"comment\">//执行脚本中的某个方法 </span></span><br><span class=\"line\">        Object o = bsfEngine.eval(<span class=\"string\">\"javascript\"</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"string\">\"test()\"</span>);  </span><br><span class=\"line\">        Map map = (HashMap) o; </span><br><span class=\"line\">        System.out.println(map.get(<span class=\"string\">\"age\"</span>)); </span><br><span class=\"line\">        System.out.println(demo.getName()); </span><br><span class=\"line\">    &#125; </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>输出结果<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hello world </span><br><span class=\"line\">10</span><br><span class=\"line\">张三</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"脚步\"><a href=\"#脚步\" class=\"headerlink\" title=\"脚步\"></a>脚步</h3><p><strong><em> bsf_001.js</em></strong><br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">importPackage(java.util); </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">test</span>(<span class=\"params\"></span>)</span>&#123; </span><br><span class=\"line\">    reflection.setName(<span class=\"string\">\"张三\"</span>); </span><br><span class=\"line\">    out.println(<span class=\"string\">\"hello world\"</span>); </span><br><span class=\"line\">    <span class=\"keyword\">var</span> map = <span class=\"keyword\">new</span> HashMap(); </span><br><span class=\"line\">    map.put(<span class=\"string\">\"name\"</span>,<span class=\"string\">\"张三\"</span>); </span><br><span class=\"line\">    map.put(<span class=\"string\">\"age\"</span>,<span class=\"string\">\"10\"</span>); </span><br><span class=\"line\">    <span class=\"keyword\">return</span> map; </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><strong><em> bsf_002.js</em></strong><br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">importClass(Packages.cn.com.bsf.test.AppDemo); </span><br><span class=\"line\"><span class=\"keyword\">var</span> appDemo = <span class=\"keyword\">new</span> AppDemo(); </span><br><span class=\"line\"><span class=\"keyword\">var</span> str=appDemo.query(<span class=\"string\">\"select * from bsf\"</span>); </span><br><span class=\"line\">out.println(str);</span><br></pre></td></tr></table></figure></p>\n<p>bsf_002.js与bsf_001.js的不同的是脚本代码没有包含在function中所以bsf执行稍微会有所不同<br>Object o = bsfEngine.eval(“javascript”, 0, 0, “bsf_002.js的脚本内容”);</p>\n<p>不知道大家注意到了importClass、importPackage没有，下面我就解释下他们的用处</p>\n<p><strong><em>importClass 是在我们的脚本中引入我们的javaBean如果是jdk中自带的javaBea不需要packages关键字反之需要例如</em></strong><br><strong><em>importClass(Packages.cn.com.bsf.test.BeanDemo);</em></strong><br><strong><em>importClass(java.util.HashMap);</em></strong><br><strong><em>importPackage是在我们的脚本中引入包 引入包后就可以使用这个包中所有javaBean其语法如下他会importClass类似自定义的java包需要加Packages为前缀。</em></strong><br><strong><em>importPackage(Packages.cn.com.bsf.test）;</em></strong><br><strong><em>importPackage(java.util);</em></strong></p>\n","excerpt":"<h3 id=\"BSF是什么\"><a href=\"#BSF是什么\" class=\"headerlink\" title=\"BSF是什么\"></a>BSF是什么</h3><p> BSF(Bean Scripting Framework)是一个支持在java应用程序内调用脚本语言，并且支持脚本语言直接访问java对象和方法的一个开源项目，有了他，你能在你的java application中使用javascript、Python、XSLT、tcl等等。反过来也可以在script language中调用任何注册过了的javaBean、java Object 它提供了完整的API实现通过Java访问脚本语言的引擎。</p>","more":"<h3 id=\"如何使用\"><a href=\"#如何使用\" class=\"headerlink\" title=\"如何使用\"></a>如何使用</h3><p> 在你的java 应用程序中导入bsf.jar包如果你使用的脚本是javascript那还需要导入js.jar包，其他脚本语言类似导入相对应的jar即可下面我就以javascript为列简单说明下BSF的使用将会已代码的形式展示给大家。</p>\n<h3 id=\"Java-Bean中\"><a href=\"#Java-Bean中\" class=\"headerlink\" title=\"Java Bean中\"></a>Java Bean中</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> cn.com.bsf.test; </span><br><span class=\"line\">         </span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BeanDemo</span></span>&#123; </span><br><span class=\"line\">     <span class=\"keyword\">private</span> String name; </span><br><span class=\"line\">              </span><br><span class=\"line\">     <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setName</span><span class=\"params\">(String name)</span></span>&#123; </span><br><span class=\"line\">         <span class=\"keyword\">this</span>.name=name; </span><br><span class=\"line\">     &#125; </span><br><span class=\"line\">     <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getName</span><span class=\"params\">()</span></span>&#123; </span><br><span class=\"line\">          <span class=\"keyword\">return</span> name </span><br><span class=\"line\">     &#125; </span><br><span class=\"line\">&#125; </span><br><span class=\"line\">         </span><br><span class=\"line\"><span class=\"keyword\">package</span> cn.com.bsf.test; </span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.BufferedInputStream; </span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.BufferedReader; </span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException; </span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.InputStream; </span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.InputStreamReader; </span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.HashMap; </span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Map; </span><br><span class=\"line\">         </span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.bsf.BSFEngine; </span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.bsf.BSFException; </span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.bsf.BSFManager; </span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BSFExample</span></span>&#123; </span><br><span class=\"line\">         </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123; </span><br><span class=\"line\">        BSFManager bsfManager= <span class=\"keyword\">new</span> BSFManager(); </span><br><span class=\"line\">        BeanDemo demo= <span class=\"keyword\">new</span> BeanDemo(); </span><br><span class=\"line\">        <span class=\"comment\">//在BSF中注册java bean </span></span><br><span class=\"line\">        bsfManager.declareBean(<span class=\"string\">\"demo\"</span>, demo, demo.getClass()); </span><br><span class=\"line\">        bsfManager.declareBean(<span class=\"string\">\"out\"</span>, System.out, System.out.getClass()); </span><br><span class=\"line\">        <span class=\"comment\">//得到BSF引擎 </span></span><br><span class=\"line\">        BSFEngine bsfEngine = bsfManager.loadScriptingEngine(<span class=\"string\">\"javascript\"</span>); </span><br><span class=\"line\">        <span class=\"comment\">//读取js文件 </span></span><br><span class=\"line\">        InputStream stream = BSFDemo.class.getResourceAsStream(<span class=\"string\">\"/bsf_001.js\"</span>); </span><br><span class=\"line\">        InputStreamReader reader = <span class=\"keyword\">new</span> InputStreamReader(<span class=\"keyword\">new</span> BufferedInputStream(stream)); </span><br><span class=\"line\">        BufferedReader bufR = <span class=\"keyword\">new</span> BufferedReader(reader); </span><br><span class=\"line\">        StringBuffer sb = <span class=\"keyword\">new</span> StringBuffer(); </span><br><span class=\"line\">        String content = bufR.readLine(); </span><br><span class=\"line\">        <span class=\"keyword\">while</span> (content != <span class=\"keyword\">null</span>) &#123; </span><br><span class=\"line\">           sb.append(content); </span><br><span class=\"line\">           content = bufR.readLine(); </span><br><span class=\"line\">        &#125; </span><br><span class=\"line\">        bsfEngine.exec(<span class=\"string\">\"javascript\"</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, sb.toString()); </span><br><span class=\"line\">       <span class=\"comment\">//执行脚本中的某个方法 </span></span><br><span class=\"line\">        Object o = bsfEngine.eval(<span class=\"string\">\"javascript\"</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"string\">\"test()\"</span>);  </span><br><span class=\"line\">        Map map = (HashMap) o; </span><br><span class=\"line\">        System.out.println(map.get(<span class=\"string\">\"age\"</span>)); </span><br><span class=\"line\">        System.out.println(demo.getName()); </span><br><span class=\"line\">    &#125; </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>输出结果<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hello world </span><br><span class=\"line\">10</span><br><span class=\"line\">张三</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"脚步\"><a href=\"#脚步\" class=\"headerlink\" title=\"脚步\"></a>脚步</h3><p><strong><em> bsf_001.js</em></strong><br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">importPackage(java.util); </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">test</span>(<span class=\"params\"></span>)</span>&#123; </span><br><span class=\"line\">    reflection.setName(<span class=\"string\">\"张三\"</span>); </span><br><span class=\"line\">    out.println(<span class=\"string\">\"hello world\"</span>); </span><br><span class=\"line\">    <span class=\"keyword\">var</span> map = <span class=\"keyword\">new</span> HashMap(); </span><br><span class=\"line\">    map.put(<span class=\"string\">\"name\"</span>,<span class=\"string\">\"张三\"</span>); </span><br><span class=\"line\">    map.put(<span class=\"string\">\"age\"</span>,<span class=\"string\">\"10\"</span>); </span><br><span class=\"line\">    <span class=\"keyword\">return</span> map; </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><strong><em> bsf_002.js</em></strong><br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">importClass(Packages.cn.com.bsf.test.AppDemo); </span><br><span class=\"line\"><span class=\"keyword\">var</span> appDemo = <span class=\"keyword\">new</span> AppDemo(); </span><br><span class=\"line\"><span class=\"keyword\">var</span> str=appDemo.query(<span class=\"string\">\"select * from bsf\"</span>); </span><br><span class=\"line\">out.println(str);</span><br></pre></td></tr></table></figure></p>\n<p>bsf_002.js与bsf_001.js的不同的是脚本代码没有包含在function中所以bsf执行稍微会有所不同<br>Object o = bsfEngine.eval(“javascript”, 0, 0, “bsf_002.js的脚本内容”);</p>\n<p>不知道大家注意到了importClass、importPackage没有，下面我就解释下他们的用处</p>\n<p><strong><em>importClass 是在我们的脚本中引入我们的javaBean如果是jdk中自带的javaBea不需要packages关键字反之需要例如</em></strong><br><strong><em>importClass(Packages.cn.com.bsf.test.BeanDemo);</em></strong><br><strong><em>importClass(java.util.HashMap);</em></strong><br><strong><em>importPackage是在我们的脚本中引入包 引入包后就可以使用这个包中所有javaBean其语法如下他会importClass类似自定义的java包需要加Packages为前缀。</em></strong><br><strong><em>importPackage(Packages.cn.com.bsf.test）;</em></strong><br><strong><em>importPackage(java.util);</em></strong></p>"},{"title":"北京交通运输职业学院网络财务管理系统项目技术经验总结","date":"2012-12-03T13:28:01.000Z","comments":1,"toc":true,"_content":"\n为期五个多月项目编码、测试开发到今天可以说终于告一段落了。回顾这段时间内要忠心的感谢我的领导对我的放心和支持，有了他们才使得我在这个项目中学到的更多成长的更快。 \n\n只有多总结才会成长的更快，废话少说下面还是来好好总结下这个项目中技术方面的经验心得吧。 \n\n这个项目使用的是我老大从ehr中把ehr的员工管理、用户管理、组织管理、权限管理、系统管理、角色管理、岗位管理组合成的一个平台，其实准确的讲应该还是一个SSM(struts2 spring mybatis)框架，他拥有平台的雏形，却没有平台的强大。不过他也已经为快速开发提供了很好的基础了，只有在这样的开发环境中对我来说才会学到的更多。下面就要来说说这个麻雀虽小但五脏俱全的平台了，工欲善其事必先利其器，就从开发环境说起。 \n<!--more-->\n\n## 基本开发环境\n### JDK版本\n***JDK1.5***\n***JDK1.6***\n不过JDK1.5好像不支持@Override注解和对读取硬盘容量没做提供相关的API而在这个系统中由于使用了@Override注解和对读取硬盘有相应的需求所以最好使用JDK1.6。\n\n### 中间件服务器\n***JBoss4.0.2***\n①：JBoss与Tomcat的关系：说到服务器由于以前接触Tomcat比较多对JBoss了解甚少，由于服务对程序员的要求并不高致使到现在虽然和他打了快一年的交道了但现在还是不太了解直到现在也没有拿他和Tomcat进行比较过。还好老大给我这个机会要我好好总结，由于自己没有心得只能从网上找找了，我总结了下网上的说法大概可以用这么个字概括“基于Tomcat为内核、集多功能于一身，性能卓越”。说到性能卓越对于我来说似乎是有点对牛弹琴了，在平时开发中根本感觉不到这点关注更多的还是程序本身，以及了解服务器基本功能和目录结构其每个目录下的作用。\n②：开发中可能被修改的JBoss配置文件\n***控制台打印sql(服务器目录下server/default/conf/log4j.xml) ***\n```xml\n<appender name=\"IBatis\" class=\"org.apache.log4j.ConsoleAppender\"> <layout class=\"org.apache.log4j.PatternLayout\">  \n     <param name=\"ConversionPattern\" value=\"%-4r [%t] %-5p %c %x - %m%n\" />  \n   </layout> \n    <filter class=\"org.apache.log4j.varia.LevelRangeFilter\">  \n         <param name=\"LevelMin\" value=\"DEBUG\" />  \n        <param name=\"LevelMax\" value=\"DEBUG\" /> \n     </filter> \n </appender>  \n<logger name=\"java.sql\" additivity=\"true\"> \n  <level value=\"DEBUG\" />  \n  <appender-ref ref=\"IBatis\" /> \n</logger>\n```\n***日志记录同上配置文件配置 ***\n```xml\n<appender name=\"BMS\" class=\"org.jboss.logging.appender.RollingFileAppender\"> class值据我了解有四种\"RollingFileAppender\"是超出指定文件大小就重新生成一个新的log文件 其余四种网上都有详细说明我就不一一总结了 \n    <errorHandler class=\"org.jboss.logging.util.OnlyOnceErrorHandler\"/> \n     <param name=\"File\" value=\"${jboss.server.home.dir}/log/bms/bms.log\"/> 这是日志文件保存的路径以及文件名 <param name=\"Append\" value=\"true\"/> 是否追加  \n    <param name=\"MaxFileSize\" value=\"500kB\"/> 指定log文件大小  \n    <param name=\"MaxBackupIndex\" value=\"10\"/> 最大备份数量超过就覆盖原来的 \n    <layout class=\"org.apache.log4j.PatternLayout\"> 输出格式 表达式搞不懂  \n       <!-- The default pattern: Date Priority [Category] Message\\n --> \n         <param name=\"ConversionPattern\" value=\"%d{ABSOLUTE} %-5p [%c{1}] %m%n\"/> </layout>  \n   </appender>  \n<category name=\"com.bopasoft\">  \n    <appender-ref ref=\"BMS\"/> </category> \n <root>  \n  <appender-ref ref=\"CONSOLE\"/> \n   <appender-ref ref=\"FILE\"/>  \n    <appender-ref ref=\"BMS\"/> \n </root>\n```\n最后一个关注的比较多的是URL的编码这个是在服务器目录下的server/default/deploy/jbossweb-tomcat55.sar/server.xml中修改\n③：数据库\n***oracle10g ***\n④：IDE工具\nEclipse 用Eclipse开发最纠结的问题就是调试，但学会了配置调试就不是问题了在这就不详细些了\n⑤：ANT\n构建项目部署 过去对ANT了解也很少现在也只能看懂每条命令的含义要自己写还是不太会终于把开发环境说完了，其实重点还是功能的实现，采用什么技术实现。\n\n## 前台\n\n### 修饰框架sitemesh\n\n他是一个网页布局和修饰的框架，利用它可以将网页的内容和页面结构分离，以达到页面结构共享的目的。它能帮助我们再由大量页面工程的项目中创建一致的页面布局和外观，如导航条。它不仅能处理动态(Jsp、Asp)的内容还能处理静态(Html)的内容。他就像include那样将一个文件嵌入到另一个文件中。sitemesh有两个标签库分别为sitemesh-decorator.tld、sitemesh-page.tld \n\n&lt;decorator:head /&gt;插 入原始页面(被包装页面)的head标签中的内容(不包括head标签本身)。\n&lt;decorator:body /&gt;插入原始页面(被包装页面)的body标签中的内容。  \n&lt;decorator:title default=\"...\" /&gt;在标签处插入原始页面(被包装页面)的原有的标签的属性中的内容，还可以添加一个缺省值。 \n\n只需要将被修饰的页面路径添加到decorators.xml中就会别相应的模板修饰。而谁来读decorators.xml他呢什么时候读？根据他的作用不难知道肯定是一个过滤器不错他就是一个过滤器是过滤器就得在web.xml中配置了。注意的是要将decorators.xml放在WEB-INF目录下。sitemesh固然是好但还是不够太灵活，但只能修饰有想同和相似的页面细节，而且请求每个页面都需要进行重新生成后果就是牺牲性能了。\n\n### 标签\n在前台页面还有要我耳目一新的是自定义的各种标签，过去对标签的定义使用定义一直是一知半解，觉得他是一个很神奇的技术。通过了这次开发大量标签的使用，并且亲自实现了二个标签。感觉其实原理也不过如此，不过对他的定义还没到信手拈来，出神入化的境界每次定义都需要参考文档。 \n\n### JS\n说到js可以说是有了一定的提高，以前总是说js是基于对象的脚本语言，也感受到了对象的体现。通过这次要我更加深刻到的体会到了他面向对象的思想，可谓是有所小突破哈哈。js面向对象编程在复杂的逻辑也游刃而解。还有它也能实现公用属性私用属性静态方法，非静态方法。不禁要我感叹它不是基于对象完全是面向对象啊！有了上面的基础定义各种选择组件也不成问题了。 \n\n## 后台\n### 持久层框架mybatis\n第一次使用mybatis感觉更多的是还是数mybatis.xml文件的编写，普通的还是很好写的就是那种一对一、一对多、一对一一对多多条件的，记得当时第一次写还是花了我不少时间主要是对标签中的各种属性不了就。现在回过头在看其实他们的标签那样定义还是很有道理的，写起来也没那么吃力了。 \n### BSF\nBSF也是第一使用，不过我在这个项目中用到他的地方也很少，只要在那个活动模板中公式验证的时候用到。它的功能确实很强大能在后台执行javascript、vbscript等代码。对各种验证、条件判断做了很好的支持。可惜的是我并不太了解它。 \n\n后台用到的新技术应该只有这么多了，最后应该就是编码规范和设计思想了。其实好的设计思想是来自于技术，只有懂的技术多了才会有好的设计，谈设计思想似乎还有一段的距离。还有的就是体会更深的是文件名、包名、类名、变量名、方法名的命的规范重要性，好了总结就写到这了。","source":"_posts/财务管理系统项目技术经验总结.md","raw":"---\ntitle: 北京交通运输职业学院网络财务管理系统项目技术经验总结\ndate: 2012-12-03 21:28:01\ncomments: true\ncategories: 心得体会\ntoc: true \n---\n\n为期五个多月项目编码、测试开发到今天可以说终于告一段落了。回顾这段时间内要忠心的感谢我的领导对我的放心和支持，有了他们才使得我在这个项目中学到的更多成长的更快。 \n\n只有多总结才会成长的更快，废话少说下面还是来好好总结下这个项目中技术方面的经验心得吧。 \n\n这个项目使用的是我老大从ehr中把ehr的员工管理、用户管理、组织管理、权限管理、系统管理、角色管理、岗位管理组合成的一个平台，其实准确的讲应该还是一个SSM(struts2 spring mybatis)框架，他拥有平台的雏形，却没有平台的强大。不过他也已经为快速开发提供了很好的基础了，只有在这样的开发环境中对我来说才会学到的更多。下面就要来说说这个麻雀虽小但五脏俱全的平台了，工欲善其事必先利其器，就从开发环境说起。 \n<!--more-->\n\n## 基本开发环境\n### JDK版本\n***JDK1.5***\n***JDK1.6***\n不过JDK1.5好像不支持@Override注解和对读取硬盘容量没做提供相关的API而在这个系统中由于使用了@Override注解和对读取硬盘有相应的需求所以最好使用JDK1.6。\n\n### 中间件服务器\n***JBoss4.0.2***\n①：JBoss与Tomcat的关系：说到服务器由于以前接触Tomcat比较多对JBoss了解甚少，由于服务对程序员的要求并不高致使到现在虽然和他打了快一年的交道了但现在还是不太了解直到现在也没有拿他和Tomcat进行比较过。还好老大给我这个机会要我好好总结，由于自己没有心得只能从网上找找了，我总结了下网上的说法大概可以用这么个字概括“基于Tomcat为内核、集多功能于一身，性能卓越”。说到性能卓越对于我来说似乎是有点对牛弹琴了，在平时开发中根本感觉不到这点关注更多的还是程序本身，以及了解服务器基本功能和目录结构其每个目录下的作用。\n②：开发中可能被修改的JBoss配置文件\n***控制台打印sql(服务器目录下server/default/conf/log4j.xml) ***\n```xml\n<appender name=\"IBatis\" class=\"org.apache.log4j.ConsoleAppender\"> <layout class=\"org.apache.log4j.PatternLayout\">  \n     <param name=\"ConversionPattern\" value=\"%-4r [%t] %-5p %c %x - %m%n\" />  \n   </layout> \n    <filter class=\"org.apache.log4j.varia.LevelRangeFilter\">  \n         <param name=\"LevelMin\" value=\"DEBUG\" />  \n        <param name=\"LevelMax\" value=\"DEBUG\" /> \n     </filter> \n </appender>  \n<logger name=\"java.sql\" additivity=\"true\"> \n  <level value=\"DEBUG\" />  \n  <appender-ref ref=\"IBatis\" /> \n</logger>\n```\n***日志记录同上配置文件配置 ***\n```xml\n<appender name=\"BMS\" class=\"org.jboss.logging.appender.RollingFileAppender\"> class值据我了解有四种\"RollingFileAppender\"是超出指定文件大小就重新生成一个新的log文件 其余四种网上都有详细说明我就不一一总结了 \n    <errorHandler class=\"org.jboss.logging.util.OnlyOnceErrorHandler\"/> \n     <param name=\"File\" value=\"${jboss.server.home.dir}/log/bms/bms.log\"/> 这是日志文件保存的路径以及文件名 <param name=\"Append\" value=\"true\"/> 是否追加  \n    <param name=\"MaxFileSize\" value=\"500kB\"/> 指定log文件大小  \n    <param name=\"MaxBackupIndex\" value=\"10\"/> 最大备份数量超过就覆盖原来的 \n    <layout class=\"org.apache.log4j.PatternLayout\"> 输出格式 表达式搞不懂  \n       <!-- The default pattern: Date Priority [Category] Message\\n --> \n         <param name=\"ConversionPattern\" value=\"%d{ABSOLUTE} %-5p [%c{1}] %m%n\"/> </layout>  \n   </appender>  \n<category name=\"com.bopasoft\">  \n    <appender-ref ref=\"BMS\"/> </category> \n <root>  \n  <appender-ref ref=\"CONSOLE\"/> \n   <appender-ref ref=\"FILE\"/>  \n    <appender-ref ref=\"BMS\"/> \n </root>\n```\n最后一个关注的比较多的是URL的编码这个是在服务器目录下的server/default/deploy/jbossweb-tomcat55.sar/server.xml中修改\n③：数据库\n***oracle10g ***\n④：IDE工具\nEclipse 用Eclipse开发最纠结的问题就是调试，但学会了配置调试就不是问题了在这就不详细些了\n⑤：ANT\n构建项目部署 过去对ANT了解也很少现在也只能看懂每条命令的含义要自己写还是不太会终于把开发环境说完了，其实重点还是功能的实现，采用什么技术实现。\n\n## 前台\n\n### 修饰框架sitemesh\n\n他是一个网页布局和修饰的框架，利用它可以将网页的内容和页面结构分离，以达到页面结构共享的目的。它能帮助我们再由大量页面工程的项目中创建一致的页面布局和外观，如导航条。它不仅能处理动态(Jsp、Asp)的内容还能处理静态(Html)的内容。他就像include那样将一个文件嵌入到另一个文件中。sitemesh有两个标签库分别为sitemesh-decorator.tld、sitemesh-page.tld \n\n&lt;decorator:head /&gt;插 入原始页面(被包装页面)的head标签中的内容(不包括head标签本身)。\n&lt;decorator:body /&gt;插入原始页面(被包装页面)的body标签中的内容。  \n&lt;decorator:title default=\"...\" /&gt;在标签处插入原始页面(被包装页面)的原有的标签的属性中的内容，还可以添加一个缺省值。 \n\n只需要将被修饰的页面路径添加到decorators.xml中就会别相应的模板修饰。而谁来读decorators.xml他呢什么时候读？根据他的作用不难知道肯定是一个过滤器不错他就是一个过滤器是过滤器就得在web.xml中配置了。注意的是要将decorators.xml放在WEB-INF目录下。sitemesh固然是好但还是不够太灵活，但只能修饰有想同和相似的页面细节，而且请求每个页面都需要进行重新生成后果就是牺牲性能了。\n\n### 标签\n在前台页面还有要我耳目一新的是自定义的各种标签，过去对标签的定义使用定义一直是一知半解，觉得他是一个很神奇的技术。通过了这次开发大量标签的使用，并且亲自实现了二个标签。感觉其实原理也不过如此，不过对他的定义还没到信手拈来，出神入化的境界每次定义都需要参考文档。 \n\n### JS\n说到js可以说是有了一定的提高，以前总是说js是基于对象的脚本语言，也感受到了对象的体现。通过这次要我更加深刻到的体会到了他面向对象的思想，可谓是有所小突破哈哈。js面向对象编程在复杂的逻辑也游刃而解。还有它也能实现公用属性私用属性静态方法，非静态方法。不禁要我感叹它不是基于对象完全是面向对象啊！有了上面的基础定义各种选择组件也不成问题了。 \n\n## 后台\n### 持久层框架mybatis\n第一次使用mybatis感觉更多的是还是数mybatis.xml文件的编写，普通的还是很好写的就是那种一对一、一对多、一对一一对多多条件的，记得当时第一次写还是花了我不少时间主要是对标签中的各种属性不了就。现在回过头在看其实他们的标签那样定义还是很有道理的，写起来也没那么吃力了。 \n### BSF\nBSF也是第一使用，不过我在这个项目中用到他的地方也很少，只要在那个活动模板中公式验证的时候用到。它的功能确实很强大能在后台执行javascript、vbscript等代码。对各种验证、条件判断做了很好的支持。可惜的是我并不太了解它。 \n\n后台用到的新技术应该只有这么多了，最后应该就是编码规范和设计思想了。其实好的设计思想是来自于技术，只有懂的技术多了才会有好的设计，谈设计思想似乎还有一段的距离。还有的就是体会更深的是文件名、包名、类名、变量名、方法名的命的规范重要性，好了总结就写到这了。","slug":"财务管理系统项目技术经验总结","published":1,"updated":"2016-05-13T14:26:54.420Z","layout":"post","photos":[],"link":"","_id":"cio5uhgn30005o0ybgzqolwrk","content":"<p>为期五个多月项目编码、测试开发到今天可以说终于告一段落了。回顾这段时间内要忠心的感谢我的领导对我的放心和支持，有了他们才使得我在这个项目中学到的更多成长的更快。 </p>\n<p>只有多总结才会成长的更快，废话少说下面还是来好好总结下这个项目中技术方面的经验心得吧。 </p>\n<p>这个项目使用的是我老大从ehr中把ehr的员工管理、用户管理、组织管理、权限管理、系统管理、角色管理、岗位管理组合成的一个平台，其实准确的讲应该还是一个SSM(struts2 spring mybatis)框架，他拥有平台的雏形，却没有平台的强大。不过他也已经为快速开发提供了很好的基础了，只有在这样的开发环境中对我来说才会学到的更多。下面就要来说说这个麻雀虽小但五脏俱全的平台了，工欲善其事必先利其器，就从开发环境说起。<br><a id=\"more\"></a></p>\n<h2 id=\"基本开发环境\"><a href=\"#基本开发环境\" class=\"headerlink\" title=\"基本开发环境\"></a>基本开发环境</h2><h3 id=\"JDK版本\"><a href=\"#JDK版本\" class=\"headerlink\" title=\"JDK版本\"></a>JDK版本</h3><p><strong><em>JDK1.5</em></strong><br><strong><em>JDK1.6</em></strong><br>不过JDK1.5好像不支持@Override注解和对读取硬盘容量没做提供相关的API而在这个系统中由于使用了@Override注解和对读取硬盘有相应的需求所以最好使用JDK1.6。</p>\n<h3 id=\"中间件服务器\"><a href=\"#中间件服务器\" class=\"headerlink\" title=\"中间件服务器\"></a>中间件服务器</h3><p><strong><em>JBoss4.0.2</em></strong><br>①：JBoss与Tomcat的关系：说到服务器由于以前接触Tomcat比较多对JBoss了解甚少，由于服务对程序员的要求并不高致使到现在虽然和他打了快一年的交道了但现在还是不太了解直到现在也没有拿他和Tomcat进行比较过。还好老大给我这个机会要我好好总结，由于自己没有心得只能从网上找找了，我总结了下网上的说法大概可以用这么个字概括“基于Tomcat为内核、集多功能于一身，性能卓越”。说到性能卓越对于我来说似乎是有点对牛弹琴了，在平时开发中根本感觉不到这点关注更多的还是程序本身，以及了解服务器基本功能和目录结构其每个目录下的作用。<br>②：开发中可能被修改的JBoss配置文件<br><strong><em>控制台打印sql(服务器目录下server/default/conf/log4j.xml) </em></strong><br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">appender</span> <span class=\"attr\">name</span>=<span class=\"string\">\"IBatis\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"org.apache.log4j.ConsoleAppender\"</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">layout</span> <span class=\"attr\">class</span>=<span class=\"string\">\"org.apache.log4j.PatternLayout\"</span>&gt;</span>  </span><br><span class=\"line\">     <span class=\"tag\">&lt;<span class=\"name\">param</span> <span class=\"attr\">name</span>=<span class=\"string\">\"ConversionPattern\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"%-4r [%t] %-5p %c %x - %m%n\"</span> /&gt;</span>  </span><br><span class=\"line\">   <span class=\"tag\">&lt;/<span class=\"name\">layout</span>&gt;</span> </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">filter</span> <span class=\"attr\">class</span>=<span class=\"string\">\"org.apache.log4j.varia.LevelRangeFilter\"</span>&gt;</span>  </span><br><span class=\"line\">         <span class=\"tag\">&lt;<span class=\"name\">param</span> <span class=\"attr\">name</span>=<span class=\"string\">\"LevelMin\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"DEBUG\"</span> /&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">param</span> <span class=\"attr\">name</span>=<span class=\"string\">\"LevelMax\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"DEBUG\"</span> /&gt;</span> </span><br><span class=\"line\">     <span class=\"tag\">&lt;/<span class=\"name\">filter</span>&gt;</span> </span><br><span class=\"line\"> <span class=\"tag\">&lt;/<span class=\"name\">appender</span>&gt;</span>  </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">logger</span> <span class=\"attr\">name</span>=<span class=\"string\">\"java.sql\"</span> <span class=\"attr\">additivity</span>=<span class=\"string\">\"true\"</span>&gt;</span> </span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">level</span> <span class=\"attr\">value</span>=<span class=\"string\">\"DEBUG\"</span> /&gt;</span>  </span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">appender-ref</span> <span class=\"attr\">ref</span>=<span class=\"string\">\"IBatis\"</span> /&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">logger</span>&gt;</span></span><br></pre></td></tr></table></figure></p>\n<p><strong><em>日志记录同上配置文件配置 </em></strong><br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">appender</span> <span class=\"attr\">name</span>=<span class=\"string\">\"BMS\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"org.jboss.logging.appender.RollingFileAppender\"</span>&gt;</span> class值据我了解有四种\"RollingFileAppender\"是超出指定文件大小就重新生成一个新的log文件 其余四种网上都有详细说明我就不一一总结了 </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">errorHandler</span> <span class=\"attr\">class</span>=<span class=\"string\">\"org.jboss.logging.util.OnlyOnceErrorHandler\"</span>/&gt;</span> </span><br><span class=\"line\">     <span class=\"tag\">&lt;<span class=\"name\">param</span> <span class=\"attr\">name</span>=<span class=\"string\">\"File\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"$&#123;jboss.server.home.dir&#125;/log/bms/bms.log\"</span>/&gt;</span> 这是日志文件保存的路径以及文件名 <span class=\"tag\">&lt;<span class=\"name\">param</span> <span class=\"attr\">name</span>=<span class=\"string\">\"Append\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"true\"</span>/&gt;</span> 是否追加  </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">param</span> <span class=\"attr\">name</span>=<span class=\"string\">\"MaxFileSize\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"500kB\"</span>/&gt;</span> 指定log文件大小  </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">param</span> <span class=\"attr\">name</span>=<span class=\"string\">\"MaxBackupIndex\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"10\"</span>/&gt;</span> 最大备份数量超过就覆盖原来的 </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">layout</span> <span class=\"attr\">class</span>=<span class=\"string\">\"org.apache.log4j.PatternLayout\"</span>&gt;</span> 输出格式 表达式搞不懂  </span><br><span class=\"line\">       <span class=\"comment\">&lt;!-- The default pattern: Date Priority [Category] Message\\n --&gt;</span> </span><br><span class=\"line\">         <span class=\"tag\">&lt;<span class=\"name\">param</span> <span class=\"attr\">name</span>=<span class=\"string\">\"ConversionPattern\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"%d&#123;ABSOLUTE&#125; %-5p [%c&#123;1&#125;] %m%n\"</span>/&gt;</span> <span class=\"tag\">&lt;/<span class=\"name\">layout</span>&gt;</span>  </span><br><span class=\"line\">   <span class=\"tag\">&lt;/<span class=\"name\">appender</span>&gt;</span>  </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">category</span> <span class=\"attr\">name</span>=<span class=\"string\">\"com.bopasoft\"</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">appender-ref</span> <span class=\"attr\">ref</span>=<span class=\"string\">\"BMS\"</span>/&gt;</span> <span class=\"tag\">&lt;/<span class=\"name\">category</span>&gt;</span> </span><br><span class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">root</span>&gt;</span>  </span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">appender-ref</span> <span class=\"attr\">ref</span>=<span class=\"string\">\"CONSOLE\"</span>/&gt;</span> </span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">appender-ref</span> <span class=\"attr\">ref</span>=<span class=\"string\">\"FILE\"</span>/&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">appender-ref</span> <span class=\"attr\">ref</span>=<span class=\"string\">\"BMS\"</span>/&gt;</span> </span><br><span class=\"line\"> <span class=\"tag\">&lt;/<span class=\"name\">root</span>&gt;</span></span><br></pre></td></tr></table></figure></p>\n<p>最后一个关注的比较多的是URL的编码这个是在服务器目录下的server/default/deploy/jbossweb-tomcat55.sar/server.xml中修改<br>③：数据库<br><strong><em>oracle10g </em></strong><br>④：IDE工具<br>Eclipse 用Eclipse开发最纠结的问题就是调试，但学会了配置调试就不是问题了在这就不详细些了<br>⑤：ANT<br>构建项目部署 过去对ANT了解也很少现在也只能看懂每条命令的含义要自己写还是不太会终于把开发环境说完了，其实重点还是功能的实现，采用什么技术实现。</p>\n<h2 id=\"前台\"><a href=\"#前台\" class=\"headerlink\" title=\"前台\"></a>前台</h2><h3 id=\"修饰框架sitemesh\"><a href=\"#修饰框架sitemesh\" class=\"headerlink\" title=\"修饰框架sitemesh\"></a>修饰框架sitemesh</h3><p>他是一个网页布局和修饰的框架，利用它可以将网页的内容和页面结构分离，以达到页面结构共享的目的。它能帮助我们再由大量页面工程的项目中创建一致的页面布局和外观，如导航条。它不仅能处理动态(Jsp、Asp)的内容还能处理静态(Html)的内容。他就像include那样将一个文件嵌入到另一个文件中。sitemesh有两个标签库分别为sitemesh-decorator.tld、sitemesh-page.tld </p>\n<p>&lt;decorator:head /&gt;插 入原始页面(被包装页面)的head标签中的内容(不包括head标签本身)。<br>&lt;decorator:body /&gt;插入原始页面(被包装页面)的body标签中的内容。<br>&lt;decorator:title default=”…” /&gt;在标签处插入原始页面(被包装页面)的原有的标签的属性中的内容，还可以添加一个缺省值。 </p>\n<p>只需要将被修饰的页面路径添加到decorators.xml中就会别相应的模板修饰。而谁来读decorators.xml他呢什么时候读？根据他的作用不难知道肯定是一个过滤器不错他就是一个过滤器是过滤器就得在web.xml中配置了。注意的是要将decorators.xml放在WEB-INF目录下。sitemesh固然是好但还是不够太灵活，但只能修饰有想同和相似的页面细节，而且请求每个页面都需要进行重新生成后果就是牺牲性能了。</p>\n<h3 id=\"标签\"><a href=\"#标签\" class=\"headerlink\" title=\"标签\"></a>标签</h3><p>在前台页面还有要我耳目一新的是自定义的各种标签，过去对标签的定义使用定义一直是一知半解，觉得他是一个很神奇的技术。通过了这次开发大量标签的使用，并且亲自实现了二个标签。感觉其实原理也不过如此，不过对他的定义还没到信手拈来，出神入化的境界每次定义都需要参考文档。 </p>\n<h3 id=\"JS\"><a href=\"#JS\" class=\"headerlink\" title=\"JS\"></a>JS</h3><p>说到js可以说是有了一定的提高，以前总是说js是基于对象的脚本语言，也感受到了对象的体现。通过这次要我更加深刻到的体会到了他面向对象的思想，可谓是有所小突破哈哈。js面向对象编程在复杂的逻辑也游刃而解。还有它也能实现公用属性私用属性静态方法，非静态方法。不禁要我感叹它不是基于对象完全是面向对象啊！有了上面的基础定义各种选择组件也不成问题了。 </p>\n<h2 id=\"后台\"><a href=\"#后台\" class=\"headerlink\" title=\"后台\"></a>后台</h2><h3 id=\"持久层框架mybatis\"><a href=\"#持久层框架mybatis\" class=\"headerlink\" title=\"持久层框架mybatis\"></a>持久层框架mybatis</h3><p>第一次使用mybatis感觉更多的是还是数mybatis.xml文件的编写，普通的还是很好写的就是那种一对一、一对多、一对一一对多多条件的，记得当时第一次写还是花了我不少时间主要是对标签中的各种属性不了就。现在回过头在看其实他们的标签那样定义还是很有道理的，写起来也没那么吃力了。 </p>\n<h3 id=\"BSF\"><a href=\"#BSF\" class=\"headerlink\" title=\"BSF\"></a>BSF</h3><p>BSF也是第一使用，不过我在这个项目中用到他的地方也很少，只要在那个活动模板中公式验证的时候用到。它的功能确实很强大能在后台执行javascript、vbscript等代码。对各种验证、条件判断做了很好的支持。可惜的是我并不太了解它。 </p>\n<p>后台用到的新技术应该只有这么多了，最后应该就是编码规范和设计思想了。其实好的设计思想是来自于技术，只有懂的技术多了才会有好的设计，谈设计思想似乎还有一段的距离。还有的就是体会更深的是文件名、包名、类名、变量名、方法名的命的规范重要性，好了总结就写到这了。</p>\n","excerpt":"<p>为期五个多月项目编码、测试开发到今天可以说终于告一段落了。回顾这段时间内要忠心的感谢我的领导对我的放心和支持，有了他们才使得我在这个项目中学到的更多成长的更快。 </p>\n<p>只有多总结才会成长的更快，废话少说下面还是来好好总结下这个项目中技术方面的经验心得吧。 </p>\n<p>这个项目使用的是我老大从ehr中把ehr的员工管理、用户管理、组织管理、权限管理、系统管理、角色管理、岗位管理组合成的一个平台，其实准确的讲应该还是一个SSM(struts2 spring mybatis)框架，他拥有平台的雏形，却没有平台的强大。不过他也已经为快速开发提供了很好的基础了，只有在这样的开发环境中对我来说才会学到的更多。下面就要来说说这个麻雀虽小但五脏俱全的平台了，工欲善其事必先利其器，就从开发环境说起。<br>","more":"</p>\n<h2 id=\"基本开发环境\"><a href=\"#基本开发环境\" class=\"headerlink\" title=\"基本开发环境\"></a>基本开发环境</h2><h3 id=\"JDK版本\"><a href=\"#JDK版本\" class=\"headerlink\" title=\"JDK版本\"></a>JDK版本</h3><p><strong><em>JDK1.5</em></strong><br><strong><em>JDK1.6</em></strong><br>不过JDK1.5好像不支持@Override注解和对读取硬盘容量没做提供相关的API而在这个系统中由于使用了@Override注解和对读取硬盘有相应的需求所以最好使用JDK1.6。</p>\n<h3 id=\"中间件服务器\"><a href=\"#中间件服务器\" class=\"headerlink\" title=\"中间件服务器\"></a>中间件服务器</h3><p><strong><em>JBoss4.0.2</em></strong><br>①：JBoss与Tomcat的关系：说到服务器由于以前接触Tomcat比较多对JBoss了解甚少，由于服务对程序员的要求并不高致使到现在虽然和他打了快一年的交道了但现在还是不太了解直到现在也没有拿他和Tomcat进行比较过。还好老大给我这个机会要我好好总结，由于自己没有心得只能从网上找找了，我总结了下网上的说法大概可以用这么个字概括“基于Tomcat为内核、集多功能于一身，性能卓越”。说到性能卓越对于我来说似乎是有点对牛弹琴了，在平时开发中根本感觉不到这点关注更多的还是程序本身，以及了解服务器基本功能和目录结构其每个目录下的作用。<br>②：开发中可能被修改的JBoss配置文件<br><strong><em>控制台打印sql(服务器目录下server/default/conf/log4j.xml) </em></strong><br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">appender</span> <span class=\"attr\">name</span>=<span class=\"string\">\"IBatis\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"org.apache.log4j.ConsoleAppender\"</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">layout</span> <span class=\"attr\">class</span>=<span class=\"string\">\"org.apache.log4j.PatternLayout\"</span>&gt;</span>  </span><br><span class=\"line\">     <span class=\"tag\">&lt;<span class=\"name\">param</span> <span class=\"attr\">name</span>=<span class=\"string\">\"ConversionPattern\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"%-4r [%t] %-5p %c %x - %m%n\"</span> /&gt;</span>  </span><br><span class=\"line\">   <span class=\"tag\">&lt;/<span class=\"name\">layout</span>&gt;</span> </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">filter</span> <span class=\"attr\">class</span>=<span class=\"string\">\"org.apache.log4j.varia.LevelRangeFilter\"</span>&gt;</span>  </span><br><span class=\"line\">         <span class=\"tag\">&lt;<span class=\"name\">param</span> <span class=\"attr\">name</span>=<span class=\"string\">\"LevelMin\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"DEBUG\"</span> /&gt;</span>  </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">param</span> <span class=\"attr\">name</span>=<span class=\"string\">\"LevelMax\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"DEBUG\"</span> /&gt;</span> </span><br><span class=\"line\">     <span class=\"tag\">&lt;/<span class=\"name\">filter</span>&gt;</span> </span><br><span class=\"line\"> <span class=\"tag\">&lt;/<span class=\"name\">appender</span>&gt;</span>  </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">logger</span> <span class=\"attr\">name</span>=<span class=\"string\">\"java.sql\"</span> <span class=\"attr\">additivity</span>=<span class=\"string\">\"true\"</span>&gt;</span> </span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">level</span> <span class=\"attr\">value</span>=<span class=\"string\">\"DEBUG\"</span> /&gt;</span>  </span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">appender-ref</span> <span class=\"attr\">ref</span>=<span class=\"string\">\"IBatis\"</span> /&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">logger</span>&gt;</span></span><br></pre></td></tr></table></figure></p>\n<p><strong><em>日志记录同上配置文件配置 </em></strong><br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">appender</span> <span class=\"attr\">name</span>=<span class=\"string\">\"BMS\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"org.jboss.logging.appender.RollingFileAppender\"</span>&gt;</span> class值据我了解有四种\"RollingFileAppender\"是超出指定文件大小就重新生成一个新的log文件 其余四种网上都有详细说明我就不一一总结了 </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">errorHandler</span> <span class=\"attr\">class</span>=<span class=\"string\">\"org.jboss.logging.util.OnlyOnceErrorHandler\"</span>/&gt;</span> </span><br><span class=\"line\">     <span class=\"tag\">&lt;<span class=\"name\">param</span> <span class=\"attr\">name</span>=<span class=\"string\">\"File\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"$&#123;jboss.server.home.dir&#125;/log/bms/bms.log\"</span>/&gt;</span> 这是日志文件保存的路径以及文件名 <span class=\"tag\">&lt;<span class=\"name\">param</span> <span class=\"attr\">name</span>=<span class=\"string\">\"Append\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"true\"</span>/&gt;</span> 是否追加  </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">param</span> <span class=\"attr\">name</span>=<span class=\"string\">\"MaxFileSize\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"500kB\"</span>/&gt;</span> 指定log文件大小  </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">param</span> <span class=\"attr\">name</span>=<span class=\"string\">\"MaxBackupIndex\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"10\"</span>/&gt;</span> 最大备份数量超过就覆盖原来的 </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">layout</span> <span class=\"attr\">class</span>=<span class=\"string\">\"org.apache.log4j.PatternLayout\"</span>&gt;</span> 输出格式 表达式搞不懂  </span><br><span class=\"line\">       <span class=\"comment\">&lt;!-- The default pattern: Date Priority [Category] Message\\n --&gt;</span> </span><br><span class=\"line\">         <span class=\"tag\">&lt;<span class=\"name\">param</span> <span class=\"attr\">name</span>=<span class=\"string\">\"ConversionPattern\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"%d&#123;ABSOLUTE&#125; %-5p [%c&#123;1&#125;] %m%n\"</span>/&gt;</span> <span class=\"tag\">&lt;/<span class=\"name\">layout</span>&gt;</span>  </span><br><span class=\"line\">   <span class=\"tag\">&lt;/<span class=\"name\">appender</span>&gt;</span>  </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">category</span> <span class=\"attr\">name</span>=<span class=\"string\">\"com.bopasoft\"</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">appender-ref</span> <span class=\"attr\">ref</span>=<span class=\"string\">\"BMS\"</span>/&gt;</span> <span class=\"tag\">&lt;/<span class=\"name\">category</span>&gt;</span> </span><br><span class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">root</span>&gt;</span>  </span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">appender-ref</span> <span class=\"attr\">ref</span>=<span class=\"string\">\"CONSOLE\"</span>/&gt;</span> </span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">appender-ref</span> <span class=\"attr\">ref</span>=<span class=\"string\">\"FILE\"</span>/&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">appender-ref</span> <span class=\"attr\">ref</span>=<span class=\"string\">\"BMS\"</span>/&gt;</span> </span><br><span class=\"line\"> <span class=\"tag\">&lt;/<span class=\"name\">root</span>&gt;</span></span><br></pre></td></tr></table></figure></p>\n<p>最后一个关注的比较多的是URL的编码这个是在服务器目录下的server/default/deploy/jbossweb-tomcat55.sar/server.xml中修改<br>③：数据库<br><strong><em>oracle10g </em></strong><br>④：IDE工具<br>Eclipse 用Eclipse开发最纠结的问题就是调试，但学会了配置调试就不是问题了在这就不详细些了<br>⑤：ANT<br>构建项目部署 过去对ANT了解也很少现在也只能看懂每条命令的含义要自己写还是不太会终于把开发环境说完了，其实重点还是功能的实现，采用什么技术实现。</p>\n<h2 id=\"前台\"><a href=\"#前台\" class=\"headerlink\" title=\"前台\"></a>前台</h2><h3 id=\"修饰框架sitemesh\"><a href=\"#修饰框架sitemesh\" class=\"headerlink\" title=\"修饰框架sitemesh\"></a>修饰框架sitemesh</h3><p>他是一个网页布局和修饰的框架，利用它可以将网页的内容和页面结构分离，以达到页面结构共享的目的。它能帮助我们再由大量页面工程的项目中创建一致的页面布局和外观，如导航条。它不仅能处理动态(Jsp、Asp)的内容还能处理静态(Html)的内容。他就像include那样将一个文件嵌入到另一个文件中。sitemesh有两个标签库分别为sitemesh-decorator.tld、sitemesh-page.tld </p>\n<p>&lt;decorator:head /&gt;插 入原始页面(被包装页面)的head标签中的内容(不包括head标签本身)。<br>&lt;decorator:body /&gt;插入原始页面(被包装页面)的body标签中的内容。<br>&lt;decorator:title default=”…” /&gt;在标签处插入原始页面(被包装页面)的原有的标签的属性中的内容，还可以添加一个缺省值。 </p>\n<p>只需要将被修饰的页面路径添加到decorators.xml中就会别相应的模板修饰。而谁来读decorators.xml他呢什么时候读？根据他的作用不难知道肯定是一个过滤器不错他就是一个过滤器是过滤器就得在web.xml中配置了。注意的是要将decorators.xml放在WEB-INF目录下。sitemesh固然是好但还是不够太灵活，但只能修饰有想同和相似的页面细节，而且请求每个页面都需要进行重新生成后果就是牺牲性能了。</p>\n<h3 id=\"标签\"><a href=\"#标签\" class=\"headerlink\" title=\"标签\"></a>标签</h3><p>在前台页面还有要我耳目一新的是自定义的各种标签，过去对标签的定义使用定义一直是一知半解，觉得他是一个很神奇的技术。通过了这次开发大量标签的使用，并且亲自实现了二个标签。感觉其实原理也不过如此，不过对他的定义还没到信手拈来，出神入化的境界每次定义都需要参考文档。 </p>\n<h3 id=\"JS\"><a href=\"#JS\" class=\"headerlink\" title=\"JS\"></a>JS</h3><p>说到js可以说是有了一定的提高，以前总是说js是基于对象的脚本语言，也感受到了对象的体现。通过这次要我更加深刻到的体会到了他面向对象的思想，可谓是有所小突破哈哈。js面向对象编程在复杂的逻辑也游刃而解。还有它也能实现公用属性私用属性静态方法，非静态方法。不禁要我感叹它不是基于对象完全是面向对象啊！有了上面的基础定义各种选择组件也不成问题了。 </p>\n<h2 id=\"后台\"><a href=\"#后台\" class=\"headerlink\" title=\"后台\"></a>后台</h2><h3 id=\"持久层框架mybatis\"><a href=\"#持久层框架mybatis\" class=\"headerlink\" title=\"持久层框架mybatis\"></a>持久层框架mybatis</h3><p>第一次使用mybatis感觉更多的是还是数mybatis.xml文件的编写，普通的还是很好写的就是那种一对一、一对多、一对一一对多多条件的，记得当时第一次写还是花了我不少时间主要是对标签中的各种属性不了就。现在回过头在看其实他们的标签那样定义还是很有道理的，写起来也没那么吃力了。 </p>\n<h3 id=\"BSF\"><a href=\"#BSF\" class=\"headerlink\" title=\"BSF\"></a>BSF</h3><p>BSF也是第一使用，不过我在这个项目中用到他的地方也很少，只要在那个活动模板中公式验证的时候用到。它的功能确实很强大能在后台执行javascript、vbscript等代码。对各种验证、条件判断做了很好的支持。可惜的是我并不太了解它。 </p>\n<p>后台用到的新技术应该只有这么多了，最后应该就是编码规范和设计思想了。其实好的设计思想是来自于技术，只有懂的技术多了才会有好的设计，谈设计思想似乎还有一段的距离。还有的就是体会更深的是文件名、包名、类名、变量名、方法名的命的规范重要性，好了总结就写到这了。</p>"},{"title":"解决问题心得","date":"2015-01-26T13:28:01.000Z","comments":1,"_content":"\n 自从接手公司平台到现在已有一年半年之久，在期间一直以解决客户、平台问题为主，也是我成长最快的一年，经统计大概解决的问题不下五百，其中问题种类多，有难有易。在解决问题上不谦虚的说自有一番心得，特此总结，一来梳理回顾过去是如何发现问题，解决问题的思路，二来以备忘记。\n <!--more-->\n在这一年半主要解决问题大概分为如下几大类，中间件、浏览器兼容、操作系统、java虚拟机、jdk、数据库、IDE、webservice。各个问题各自关联各自影响。其中中间件兼容常见问题一般是包冲突，请求乱码，数据源操作数据库引发数据库死锁（这个问题主要是在使用金蝶中间件过程中遇到的，现象是使用jdbc 直连接正常在这里为什么要使用jdbc直连测试，是为了排除jdbc驱动包的原因。使用数据源对数据库进行操作不提交不释放锁，不过大家可以放心，使用标准的数据源工具是不会有这个问题的，据了解金蝶有对数据源进行了重写）。在中间件中还有就是集群session共享、jsp编译、不能远程访问等等问题。而浏览器兼容问题一般情况都会与javascript相关。能写出更好兼容的javascript代码需要有一定功底。但我们解决问题就不需要了，只需要能有这方面的意识即可。常见与操作系统有关的问题那就是环境变量设置有关了。其他不至于人品那么差了。java虚拟机一般就是内存溢出，线程溢出这个问题一般好解决就是针对不同的异常来进行设置，解决这个问题一般设置完加大参数即可但前提要求主机配置性能得到达一定要求，jdk的话一般也包含了jvm的问题这个一般有版本不同、供应商不同而引发的问题。还有就是版本不同所提供到的支持也不一样。例如在jdk1.5中是对内存有最大的限制，数据库的话那一般就是死锁、连接失败、连接会话不够，大小写、字符编码、用户权限等等问题。\n\n很难说有固定的模式固定的方法能解决平时开发中遇到的所有问题，但思路是不变的，一般思路是，分析问题（一般可以通过看日志调试代码）、采用对比排除法缩小产生问题的原因的范围，找到问题的本质、在解决问题。现象一样但引发问题的原因可能并不一样，问题原因是因环境改变而不同，解决问题的大忌就是慌张，心态很重要。每个问题都有其根本的原因，只有抓住了问题的根本原因才能解决问题。如果硬是解决不了可以通过其他的手段绕过其问题寻求其他方法实现现在的功能。\n\n有些问题看上去很难其实反而很简单，经常有人跟我反映，系统运行一段时间久卡在了很久没有反映只有重启中间件才能正常操作，而且这个问题也不是每次都出现。碰到这样的问题，应该第一反应就是看日志，二看数据库，看看是不是数据库因死锁了导致系统线程停止。根据日志提供的信息分析问题是如何产生的。然后就是不断缩小引起问题的范围最后落实到一段代码一个配置一个参数上面。例如这几天有个同事向我反映在IE6下使用软航在线编辑器修改流程正文（word）在节点1出修改后提交到节点2在节点2中可以看到修改的内容但在节点1出还显示的没有修改之前的。通过我同事对问题的反映我肯定的是这个问题跟软航无关因为如果软航有问题的话那在节点2应该看到的也是没有修改之前的。然后我也让我同事帮我确定了下在节点1上修改保存不提交关闭在打开看看能不能看到修改之后的反映是可以的。结合系统本身那就可以通过查看代码在分析锁定代码，很快就把这个问题解决了。\n","source":"_posts/解决问题心得.md","raw":"---\ntitle: 解决问题心得\ndate: 2015-01-26 21:28:01\ncomments: true\ncategories: 心得体会\n---\n\n 自从接手公司平台到现在已有一年半年之久，在期间一直以解决客户、平台问题为主，也是我成长最快的一年，经统计大概解决的问题不下五百，其中问题种类多，有难有易。在解决问题上不谦虚的说自有一番心得，特此总结，一来梳理回顾过去是如何发现问题，解决问题的思路，二来以备忘记。\n <!--more-->\n在这一年半主要解决问题大概分为如下几大类，中间件、浏览器兼容、操作系统、java虚拟机、jdk、数据库、IDE、webservice。各个问题各自关联各自影响。其中中间件兼容常见问题一般是包冲突，请求乱码，数据源操作数据库引发数据库死锁（这个问题主要是在使用金蝶中间件过程中遇到的，现象是使用jdbc 直连接正常在这里为什么要使用jdbc直连测试，是为了排除jdbc驱动包的原因。使用数据源对数据库进行操作不提交不释放锁，不过大家可以放心，使用标准的数据源工具是不会有这个问题的，据了解金蝶有对数据源进行了重写）。在中间件中还有就是集群session共享、jsp编译、不能远程访问等等问题。而浏览器兼容问题一般情况都会与javascript相关。能写出更好兼容的javascript代码需要有一定功底。但我们解决问题就不需要了，只需要能有这方面的意识即可。常见与操作系统有关的问题那就是环境变量设置有关了。其他不至于人品那么差了。java虚拟机一般就是内存溢出，线程溢出这个问题一般好解决就是针对不同的异常来进行设置，解决这个问题一般设置完加大参数即可但前提要求主机配置性能得到达一定要求，jdk的话一般也包含了jvm的问题这个一般有版本不同、供应商不同而引发的问题。还有就是版本不同所提供到的支持也不一样。例如在jdk1.5中是对内存有最大的限制，数据库的话那一般就是死锁、连接失败、连接会话不够，大小写、字符编码、用户权限等等问题。\n\n很难说有固定的模式固定的方法能解决平时开发中遇到的所有问题，但思路是不变的，一般思路是，分析问题（一般可以通过看日志调试代码）、采用对比排除法缩小产生问题的原因的范围，找到问题的本质、在解决问题。现象一样但引发问题的原因可能并不一样，问题原因是因环境改变而不同，解决问题的大忌就是慌张，心态很重要。每个问题都有其根本的原因，只有抓住了问题的根本原因才能解决问题。如果硬是解决不了可以通过其他的手段绕过其问题寻求其他方法实现现在的功能。\n\n有些问题看上去很难其实反而很简单，经常有人跟我反映，系统运行一段时间久卡在了很久没有反映只有重启中间件才能正常操作，而且这个问题也不是每次都出现。碰到这样的问题，应该第一反应就是看日志，二看数据库，看看是不是数据库因死锁了导致系统线程停止。根据日志提供的信息分析问题是如何产生的。然后就是不断缩小引起问题的范围最后落实到一段代码一个配置一个参数上面。例如这几天有个同事向我反映在IE6下使用软航在线编辑器修改流程正文（word）在节点1出修改后提交到节点2在节点2中可以看到修改的内容但在节点1出还显示的没有修改之前的。通过我同事对问题的反映我肯定的是这个问题跟软航无关因为如果软航有问题的话那在节点2应该看到的也是没有修改之前的。然后我也让我同事帮我确定了下在节点1上修改保存不提交关闭在打开看看能不能看到修改之后的反映是可以的。结合系统本身那就可以通过查看代码在分析锁定代码，很快就把这个问题解决了。\n","slug":"解决问题心得","published":1,"updated":"2016-05-13T14:09:35.520Z","layout":"post","photos":[],"link":"","_id":"cio5uhgn30007o0ybg6dj3y0u","content":"<p> 自从接手公司平台到现在已有一年半年之久，在期间一直以解决客户、平台问题为主，也是我成长最快的一年，经统计大概解决的问题不下五百，其中问题种类多，有难有易。在解决问题上不谦虚的说自有一番心得，特此总结，一来梳理回顾过去是如何发现问题，解决问题的思路，二来以备忘记。<br> <a id=\"more\"></a><br>在这一年半主要解决问题大概分为如下几大类，中间件、浏览器兼容、操作系统、java虚拟机、jdk、数据库、IDE、webservice。各个问题各自关联各自影响。其中中间件兼容常见问题一般是包冲突，请求乱码，数据源操作数据库引发数据库死锁（这个问题主要是在使用金蝶中间件过程中遇到的，现象是使用jdbc 直连接正常在这里为什么要使用jdbc直连测试，是为了排除jdbc驱动包的原因。使用数据源对数据库进行操作不提交不释放锁，不过大家可以放心，使用标准的数据源工具是不会有这个问题的，据了解金蝶有对数据源进行了重写）。在中间件中还有就是集群session共享、jsp编译、不能远程访问等等问题。而浏览器兼容问题一般情况都会与javascript相关。能写出更好兼容的javascript代码需要有一定功底。但我们解决问题就不需要了，只需要能有这方面的意识即可。常见与操作系统有关的问题那就是环境变量设置有关了。其他不至于人品那么差了。java虚拟机一般就是内存溢出，线程溢出这个问题一般好解决就是针对不同的异常来进行设置，解决这个问题一般设置完加大参数即可但前提要求主机配置性能得到达一定要求，jdk的话一般也包含了jvm的问题这个一般有版本不同、供应商不同而引发的问题。还有就是版本不同所提供到的支持也不一样。例如在jdk1.5中是对内存有最大的限制，数据库的话那一般就是死锁、连接失败、连接会话不够，大小写、字符编码、用户权限等等问题。</p>\n<p>很难说有固定的模式固定的方法能解决平时开发中遇到的所有问题，但思路是不变的，一般思路是，分析问题（一般可以通过看日志调试代码）、采用对比排除法缩小产生问题的原因的范围，找到问题的本质、在解决问题。现象一样但引发问题的原因可能并不一样，问题原因是因环境改变而不同，解决问题的大忌就是慌张，心态很重要。每个问题都有其根本的原因，只有抓住了问题的根本原因才能解决问题。如果硬是解决不了可以通过其他的手段绕过其问题寻求其他方法实现现在的功能。</p>\n<p>有些问题看上去很难其实反而很简单，经常有人跟我反映，系统运行一段时间久卡在了很久没有反映只有重启中间件才能正常操作，而且这个问题也不是每次都出现。碰到这样的问题，应该第一反应就是看日志，二看数据库，看看是不是数据库因死锁了导致系统线程停止。根据日志提供的信息分析问题是如何产生的。然后就是不断缩小引起问题的范围最后落实到一段代码一个配置一个参数上面。例如这几天有个同事向我反映在IE6下使用软航在线编辑器修改流程正文（word）在节点1出修改后提交到节点2在节点2中可以看到修改的内容但在节点1出还显示的没有修改之前的。通过我同事对问题的反映我肯定的是这个问题跟软航无关因为如果软航有问题的话那在节点2应该看到的也是没有修改之前的。然后我也让我同事帮我确定了下在节点1上修改保存不提交关闭在打开看看能不能看到修改之后的反映是可以的。结合系统本身那就可以通过查看代码在分析锁定代码，很快就把这个问题解决了。</p>\n","excerpt":"<p> 自从接手公司平台到现在已有一年半年之久，在期间一直以解决客户、平台问题为主，也是我成长最快的一年，经统计大概解决的问题不下五百，其中问题种类多，有难有易。在解决问题上不谦虚的说自有一番心得，特此总结，一来梳理回顾过去是如何发现问题，解决问题的思路，二来以备忘记。<br>","more":"<br>在这一年半主要解决问题大概分为如下几大类，中间件、浏览器兼容、操作系统、java虚拟机、jdk、数据库、IDE、webservice。各个问题各自关联各自影响。其中中间件兼容常见问题一般是包冲突，请求乱码，数据源操作数据库引发数据库死锁（这个问题主要是在使用金蝶中间件过程中遇到的，现象是使用jdbc 直连接正常在这里为什么要使用jdbc直连测试，是为了排除jdbc驱动包的原因。使用数据源对数据库进行操作不提交不释放锁，不过大家可以放心，使用标准的数据源工具是不会有这个问题的，据了解金蝶有对数据源进行了重写）。在中间件中还有就是集群session共享、jsp编译、不能远程访问等等问题。而浏览器兼容问题一般情况都会与javascript相关。能写出更好兼容的javascript代码需要有一定功底。但我们解决问题就不需要了，只需要能有这方面的意识即可。常见与操作系统有关的问题那就是环境变量设置有关了。其他不至于人品那么差了。java虚拟机一般就是内存溢出，线程溢出这个问题一般好解决就是针对不同的异常来进行设置，解决这个问题一般设置完加大参数即可但前提要求主机配置性能得到达一定要求，jdk的话一般也包含了jvm的问题这个一般有版本不同、供应商不同而引发的问题。还有就是版本不同所提供到的支持也不一样。例如在jdk1.5中是对内存有最大的限制，数据库的话那一般就是死锁、连接失败、连接会话不够，大小写、字符编码、用户权限等等问题。</p>\n<p>很难说有固定的模式固定的方法能解决平时开发中遇到的所有问题，但思路是不变的，一般思路是，分析问题（一般可以通过看日志调试代码）、采用对比排除法缩小产生问题的原因的范围，找到问题的本质、在解决问题。现象一样但引发问题的原因可能并不一样，问题原因是因环境改变而不同，解决问题的大忌就是慌张，心态很重要。每个问题都有其根本的原因，只有抓住了问题的根本原因才能解决问题。如果硬是解决不了可以通过其他的手段绕过其问题寻求其他方法实现现在的功能。</p>\n<p>有些问题看上去很难其实反而很简单，经常有人跟我反映，系统运行一段时间久卡在了很久没有反映只有重启中间件才能正常操作，而且这个问题也不是每次都出现。碰到这样的问题，应该第一反应就是看日志，二看数据库，看看是不是数据库因死锁了导致系统线程停止。根据日志提供的信息分析问题是如何产生的。然后就是不断缩小引起问题的范围最后落实到一段代码一个配置一个参数上面。例如这几天有个同事向我反映在IE6下使用软航在线编辑器修改流程正文（word）在节点1出修改后提交到节点2在节点2中可以看到修改的内容但在节点1出还显示的没有修改之前的。通过我同事对问题的反映我肯定的是这个问题跟软航无关因为如果软航有问题的话那在节点2应该看到的也是没有修改之前的。然后我也让我同事帮我确定了下在节点1上修改保存不提交关闭在打开看看能不能看到修改之后的反映是可以的。结合系统本身那就可以通过查看代码在分析锁定代码，很快就把这个问题解决了。</p>"}],"PostAsset":[{"_id":"source/_posts/Java设计模式之观察者模式/003vMReezy6OWsC8Oogc8&690.jpg","slug":"003vMReezy6OWsC8Oogc8&690.jpg","post":"cio5q2liv00047oybaem3lmaf","modified":0,"renderable":0},{"_id":"source/_posts/Java设计模式之观察者模式/003vMReezy6OWsKgs3pa3&690.jpg","slug":"003vMReezy6OWsKgs3pa3&690.jpg","post":"cio5q2liv00047oybaem3lmaf","modified":0,"renderable":0},{"_id":"source/_posts/Java设计模式之观察者模式/class.jpg","slug":"class.jpg","post":"cio5q2liv00047oybaem3lmaf","modified":0,"renderable":0},{"_id":"source/_posts/Hadoop集群完全分布式部署/003vMReezy6P1KHLwtFe7&690.png","slug":"003vMReezy6P1KHLwtFe7&690.png","post":"cio5q2lig00017oyb696tvb8p","modified":0,"renderable":0},{"_id":"source/_posts/Hadoop集群完全分布式部署/003vMReezy6P1KnAQkx19&690.png","slug":"003vMReezy6P1KnAQkx19&690.png","post":"cio5q2lig00017oyb696tvb8p","modified":0,"renderable":0},{"_id":"source/_posts/Hadoop集群完全分布式部署/003vMReezy6P1LyH3gqae&690.jpg","slug":"003vMReezy6P1LyH3gqae&690.jpg","post":"cio5q2lig00017oyb696tvb8p","modified":0,"renderable":0},{"_id":"source/_posts/Hadoop集群完全分布式部署/003vMReezy6P1MG9JTO50&690.png","slug":"003vMReezy6P1MG9JTO50&690.png","post":"cio5q2lig00017oyb696tvb8p","modified":0,"renderable":0},{"_id":"source/_posts/Hadoop集群完全分布式部署/003vMReezy6P1MlAy3H5d&690.jpg","slug":"003vMReezy6P1MlAy3H5d&690.jpg","post":"cio5q2lig00017oyb696tvb8p","modified":0,"renderable":0},{"_id":"source/_posts/Hadoop集群完全分布式部署/003vMReezy6P1Mzjamje7&690.jpg","slug":"003vMReezy6P1Mzjamje7&690.jpg","post":"cio5q2lig00017oyb696tvb8p","modified":0,"renderable":0},{"_id":"source/_posts/Hadoop集群完全分布式部署/003vMReezy6P1O1zJBg32&690.jpg","slug":"003vMReezy6P1O1zJBg32&690.jpg","post":"cio5q2lig00017oyb696tvb8p","modified":0,"renderable":0},{"_id":"source/_posts/Nginx+Tomcat集群/003vMReezy6OUXDo7kt61&690.jpg","post":"cio5uhgmn0003o0ybkqnkf09x","slug":"003vMReezy6OUXDo7kt61&690.jpg","modified":1,"renderable":1}],"PostCategory":[{"post_id":"cio5q2lig00007oybozbqg9eo","category_id":"cio5q2lig00027oyb7hqytk4c","_id":"cio5q2liv00087oybo4jo8zoi"},{"post_id":"cio5q2lig00017oyb696tvb8p","category_id":"cio5q2liv00067oyboky4b2rk","_id":"cio5q2liv000a7oyb6czqpe40"},{"post_id":"cio5q2liv00037oyb1pgvab2o","category_id":"cio5q2liv00097oyb09lmhzyj","_id":"cio5q2liv000c7oybsm63piui"},{"post_id":"cio5q2liv00047oybaem3lmaf","category_id":"cio5q2liv000b7oyb0bqqc5t2","_id":"cio5q2ljb000e7oyb8kj18wjc"},{"post_id":"cio5q2liv00057oybjke4iqzy","category_id":"cio5q2liv000b7oyb0bqqc5t2","_id":"cio5q2ljb000f7oyb5814vcdf"},{"post_id":"cio5uhgm80000o0yb6mmgogp0","category_id":"cio5uhgmn0002o0yba26ei45b","_id":"cio5uhgn30008o0ybqbvovzpe"},{"post_id":"cio5uhgmn0001o0yb2cdt3uen","category_id":"cio5uhgn30006o0ybel9wspvp","_id":"cio5uhgn3000ao0yb4qe3jg1f"},{"post_id":"cio5uhgmn0003o0ybkqnkf09x","category_id":"cio5uhgmn0002o0yba26ei45b","_id":"cio5uhgnj000co0ybu076o25j"},{"post_id":"cio5uhgn30004o0ybbrfbmeys","category_id":"cio5uhgn3000bo0ybv6oy15t6","_id":"cio5uhgnj000eo0yb2mj2817l"},{"post_id":"cio5uhgn30005o0ybgzqolwrk","category_id":"cio5uhgnj000do0yb17ghm3b0","_id":"cio5uhgnj000go0ybib1prbkt"},{"post_id":"cio5uhgn30007o0ybg6dj3y0u","category_id":"cio5uhgnj000do0yb17ghm3b0","_id":"cio5uhgnj000ho0ybkz8ivyai"}],"PostTag":[],"Tag":[]}}